function convertDateIntoYYMMDD(t){var e=t.getMonth()+1,n=t.getDate();10>e&&(e="0"+e),10>n&&(n="0"+n);var r=t.getFullYear()+"-"+e+"-"+n;return r}function getMinRange(t){return Math.min(Math.min(getMinFromArray(t,"Trend"),getMinFromArray(t,"LowBand")),getMinFromArray(t,"Low"),getMinFromArray(t,"Close"))}function getMaxRange(t){return Math.max(Math.max(getMaxFromArray(t,"Trend"),getMaxFromArray(t,"HighBand")),getMaxFromArray(t,"High"),getMaxFromArray(t,"Close"))}function getMinFromArray(t,e){var n=Number.MAX_VALUE;return angular.forEach(t,function(t){t[e]<n&&0!=t[e]&&(n=t[e])}),n}function getMaxFromArray(t,e){var n=-Number.MAX_VALUE;return angular.forEach(t,function(t){t[e]>n&&0!=t[e]&&(n=t[e])}),n==Number.MIN_VALUE?void 0:n}!function(){function t(t,e){return e>t?-1:t>e?1:t>=e?0:0/0}function e(t){return null===t?0/0:+t}function n(t){return!isNaN(t)}function r(t){return{left:function(e,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=e.length);a>r;){var i=r+a>>>1;t(e[i],n)<0?r=i+1:a=i}return r},right:function(e,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=e.length);a>r;){var i=r+a>>>1;t(e[i],n)>0?a=i:r=i+1}return r}}}function a(t){return t.length}function i(t){for(var e=1;t*e%1;)e*=10;return e}function o(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function l(){this._=Object.create(null)}function s(t){return(t+="")===cl||t[0]===dl?dl+t:t}function u(t){return(t+="")[0]===dl?t.slice(1):t}function c(t){return s(t)in this._}function d(t){return(t=s(t))in this._&&delete this._[t]}function f(){var t=[];for(var e in this._)t.push(u(e));return t}function h(){var t=0;for(var e in this._)++t;return t}function p(){for(var t in this._)return!1;return!0}function g(){this._=Object.create(null)}function v(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function y(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,r=fl.length;r>n;++n){var a=fl[n]+e;if(a in t)return a}}function m(){}function x(){}function b(t){function e(){for(var e,r=n,a=-1,i=r.length;++a<i;)(e=r[a].on)&&e.apply(this,arguments);return t}var n=[],r=new l;return e.on=function(e,a){var i,o=r.get(e);return arguments.length<2?o&&o.on:(o&&(o.on=null,n=n.slice(0,i=n.indexOf(o)).concat(n.slice(i+1)),r.remove(e)),a&&n.push(r.set(e,{on:a})),t)},e}function A(){$o.event.preventDefault()}function M(){for(var t,e=$o.event;t=e.sourceEvent;)e=t;return e}function k(t){for(var e=new x,n=0,r=arguments.length;++n<r;)e[arguments[n]]=b(e);return e.of=function(n,r){return function(a){try{var i=a.sourceEvent=$o.event;a.target=t,$o.event=a,e[a.type].apply(n,r)}finally{$o.event=i}}},e}function w(t){return pl(t,xl),t}function C(t){return"function"==typeof t?t:function(){return gl(t,this)}}function T(t){return"function"==typeof t?t:function(){return vl(t,this)}}function S(t,e){function n(){this.removeAttribute(t)}function r(){this.removeAttributeNS(t.space,t.local)}function a(){this.setAttribute(t,e)}function i(){this.setAttributeNS(t.space,t.local,e)}function o(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function l(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=$o.ns.qualify(t),null==e?t.local?r:n:"function"==typeof e?t.local?l:o:t.local?i:a}function L(t){return t.trim().replace(/\s+/g," ")}function D(t){return new RegExp("(?:^|\\s+)"+$o.requote(t)+"(?:\\s+|$)","g")}function N(t){return(t+"").trim().split(/^|\s+/)}function _(t,e){function n(){for(var n=-1;++n<a;)t[n](this,e)}function r(){for(var n=-1,r=e.apply(this,arguments);++n<a;)t[n](this,r)}t=N(t).map(P);var a=t.length;return"function"==typeof e?r:n}function P(t){var e=D(t);return function(n,r){if(a=n.classList)return r?a.add(t):a.remove(t);var a=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(a)||n.setAttribute("class",L(a+" "+t))):n.setAttribute("class",L(a.replace(e," ")))}}function I(t,e,n){function r(){this.style.removeProperty(t)}function a(){this.style.setProperty(t,e,n)}function i(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}return null==e?r:"function"==typeof e?i:a}function V(t,e){function n(){delete this[t]}function r(){this[t]=e}function a(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?a:r}function F(t){return"function"==typeof t?t:(t=$o.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function z(t){return{__data__:t}}function E(t){return function(){return ml(this,t)}}function G(e){return arguments.length||(e=t),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function Y(t,e){for(var n=0,r=t.length;r>n;n++)for(var a,i=t[n],o=0,l=i.length;l>o;o++)(a=i[o])&&e(a,o,n);return t}function R(t){return pl(t,Al),t}function O(t){var e,n;return function(r,a,i){var o,l=t[i].update,s=l.length;for(i!=n&&(n=i,e=0),a>=e&&(e=a+1);!(o=l[e])&&++e<s;);return o}}function B(){var t=this.__transition__;t&&++t.active}function X(t,e,n){function r(){var e=this[o];e&&(this.removeEventListener(t,e,e.$),delete this[o])}function a(){var a=s(e,Zo(arguments));r.call(this),this.addEventListener(t,this[o]=a,a.$=n),a._=e}function i(){var e,n=new RegExp("^__on([^.]+)"+$o.requote(t)+"$");for(var r in this)if(e=r.match(n)){var a=this[r];this.removeEventListener(e[1],a,a.$),delete this[r]}}var o="__on"+t,l=t.indexOf("."),s=q;l>0&&(t=t.slice(0,l));var u=kl.get(t);return u&&(t=u,s=U),l?e?a:r:e?m:i}function q(t,e){return function(n){var r=$o.event;$o.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{$o.event=r}}}function U(t,e){var n=q(t,e);return function(t){var e=this,r=t.relatedTarget;r&&(r===e||8&r.compareDocumentPosition(e))||n.call(e,t)}}function j(){var t=".dragsuppress-"+ ++Cl,e="click"+t,n=$o.select(tl).on("touchmove"+t,A).on("dragstart"+t,A).on("selectstart"+t,A);if(wl){var r=Qo.style,a=r[wl];r[wl]="none"}return function(i){function o(){n.on(e,null)}n.on(t,null),wl&&(r[wl]=a),i&&(n.on(e,function(){A(),o()},!0),setTimeout(o,0))}}function H(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();if(0>Tl&&(tl.scrollX||tl.scrollY)){n=$o.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=n[0][0].getScreenCTM();Tl=!(a.f||a.e),n.remove()}return Tl?(r.x=e.pageX,r.y=e.pageY):(r.x=e.clientX,r.y=e.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function W(){return $o.event.changedTouches[0].identifier}function $(){return $o.event.target}function J(){return tl}function Z(t){return t>0?1:0>t?-1:0}function K(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Q(t){return t>1?0:-1>t?Sl:Math.acos(t)}function te(t){return t>1?Dl:-1>t?-Dl:Math.asin(t)}function ee(t){return((t=Math.exp(t))-1/t)/2}function ne(t){return((t=Math.exp(t))+1/t)/2}function re(t){return((t=Math.exp(2*t))-1)/(t+1)}function ae(t){return(t=Math.sin(t/2))*t}function ie(){}function oe(t,e,n){return this instanceof oe?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof oe?new oe(t.h,t.s,t.l):be(""+t,Ae,oe):new oe(t,e,n)}function le(t,e,n){function r(t){return t>360?t-=360:0>t&&(t+=360),60>t?i+(o-i)*t/60:180>t?o:240>t?i+(o-i)*(240-t)/60:i}function a(t){return Math.round(255*r(t))}var i,o;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,o=.5>=n?n*(1+e):n+e-n*e,i=2*n-o,new ve(a(t+120),a(t),a(t-120))}function se(t,e,n){return this instanceof se?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof se?new se(t.h,t.c,t.l):t instanceof ce?fe(t.l,t.a,t.b):fe((t=Me((t=$o.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new se(t,e,n)}function ue(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ce(n,Math.cos(t*=Pl)*e,Math.sin(t)*e)}function ce(t,e,n){return this instanceof ce?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof ce?new ce(t.l,t.a,t.b):t instanceof se?ue(t.h,t.c,t.l):Me((t=ve(t)).r,t.g,t.b):new ce(t,e,n)}function de(t,e,n){var r=(t+16)/116,a=r+e/500,i=r-n/200;return a=he(a)*Xl,r=he(r)*ql,i=he(i)*Ul,new ve(ge(3.2404542*a-1.5371385*r-.4985314*i),ge(-.969266*a+1.8760108*r+.041556*i),ge(.0556434*a-.2040259*r+1.0572252*i))}function fe(t,e,n){return t>0?new se(Math.atan2(n,e)*Il,Math.sqrt(e*e+n*n),t):new se(0/0,0/0,t)}function he(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function pe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ge(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ve(t,e,n){return this instanceof ve?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof ve?new ve(t.r,t.g,t.b):be(""+t,ve,le):new ve(t,e,n)}function ye(t){return new ve(t>>16,255&t>>8,255&t)}function me(t){return ye(t)+""}function xe(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function be(t,e,n){var r,a,i,o=0,l=0,s=0;if(r=/([a-z]+)\((.*)\)/i.exec(t))switch(a=r[2].split(","),r[1]){case"hsl":return n(parseFloat(a[0]),parseFloat(a[1])/100,parseFloat(a[2])/100);case"rgb":return e(we(a[0]),we(a[1]),we(a[2]))}return(i=Wl.get(t))?e(i.r,i.g,i.b):(null==t||"#"!==t.charAt(0)||isNaN(i=parseInt(t.slice(1),16))||(4===t.length?(o=(3840&i)>>4,o=o>>4|o,l=240&i,l=l>>4|l,s=15&i,s=s<<4|s):7===t.length&&(o=(16711680&i)>>16,l=(65280&i)>>8,s=255&i)),e(o,l,s))}function Ae(t,e,n){var r,a,i=Math.min(t/=255,e/=255,n/=255),o=Math.max(t,e,n),l=o-i,s=(o+i)/2;return l?(a=.5>s?l/(o+i):l/(2-o-i),r=t==o?(e-n)/l+(n>e?6:0):e==o?(n-t)/l+2:(t-e)/l+4,r*=60):(r=0/0,a=s>0&&1>s?0:r),new oe(r,a,s)}function Me(t,e,n){t=ke(t),e=ke(e),n=ke(n);var r=pe((.4124564*t+.3575761*e+.1804375*n)/Xl),a=pe((.2126729*t+.7151522*e+.072175*n)/ql),i=pe((.0193339*t+.119192*e+.9503041*n)/Ul);return ce(116*a-16,500*(r-a),200*(a-i))}function ke(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function we(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Ce(t){return"function"==typeof t?t:function(){return t}}function Te(t){return t}function Se(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),Le(e,n,t,r)}}function Le(t,e,n,r){function a(){var t,e=s.status;if(!e&&Ne(s)||e>=200&&300>e||304===e){try{t=n.call(i,s)}catch(r){return void o.error.call(i,r)}o.load.call(i,t)}else o.error.call(i,s)}var i={},o=$o.dispatch("beforesend","progress","load","error"),l={},s=new XMLHttpRequest,u=null;return!tl.XDomainRequest||"withCredentials"in s||!/^(http(s)?:)?\/\//.test(t)||(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=a:s.onreadystatechange=function(){s.readyState>3&&a()},s.onprogress=function(t){var e=$o.event;$o.event=t;try{o.progress.call(i,s)}finally{$o.event=e}},i.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",i)},i.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",i):e},i.responseType=function(t){return arguments.length?(u=t,i):u},i.response=function(t){return n=t,i},["get","post"].forEach(function(t){i[t]=function(){return i.send.apply(i,[t].concat(Zo(arguments)))}}),i.send=function(n,r,a){if(2===arguments.length&&"function"==typeof r&&(a=r,r=null),s.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),s.setRequestHeader)for(var c in l)s.setRequestHeader(c,l[c]);return null!=e&&s.overrideMimeType&&s.overrideMimeType(e),null!=u&&(s.responseType=u),null!=a&&i.on("error",a).on("load",function(t){a(null,t)}),o.beforesend.call(i,s),s.send(null==r?null:r),i},i.abort=function(){return s.abort(),i},$o.rebind(i,o,"on"),null==r?i:i.get(De(r))}function De(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function Ne(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function _e(){var t=Pe(),e=Ie()-t;e>24?(isFinite(e)&&(clearTimeout(Kl),Kl=setTimeout(_e,e)),Zl=0):(Zl=1,ts(_e))}function Pe(){var t=Date.now();for(Ql=$l;Ql;)t>=Ql.t&&(Ql.f=Ql.c(t-Ql.t)),Ql=Ql.n;return t}function Ie(){for(var t,e=$l,n=1/0;e;)e.f?e=t?t.n=e.n:$l=e.n:(e.t<n&&(n=e.t),e=(t=e).n);return Jl=t,n}function Ve(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Fe(t,e){var n=Math.pow(10,3*ul(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function ze(t){var e=t.decimal,n=t.thousands,r=t.grouping,a=t.currency,i=r&&n?function(t,e){for(var a=t.length,i=[],o=0,l=r[0],s=0;a>0&&l>0&&(s+l+1>e&&(l=Math.max(1,e-s)),i.push(t.substring(a-=l,a+l)),!((s+=l+1)>e));)l=r[o=(o+1)%r.length];return i.reverse().join(n)}:Te;return function(t){var n=ns.exec(t),r=n[1]||" ",o=n[2]||">",l=n[3]||"-",s=n[4]||"",u=n[5],c=+n[6],d=n[7],f=n[8],h=n[9],p=1,g="",v="",y=!1,m=!0;switch(f&&(f=+f.substring(1)),(u||"0"===r&&"="===o)&&(u=r="0",o="="),h){case"n":d=!0,h="g";break;case"%":p=100,v="%",h="f";break;case"p":p=100,v="%",h="r";break;case"b":case"o":case"x":case"X":"#"===s&&(g="0"+h.toLowerCase());case"c":m=!1;case"d":y=!0,f=0;break;case"s":p=-1,h="r"}"$"===s&&(g=a[0],v=a[1]),"r"!=h||f||(h="g"),null!=f&&("g"==h?f=Math.max(1,Math.min(21,f)):("e"==h||"f"==h)&&(f=Math.max(0,Math.min(20,f)))),h=rs.get(h)||Ee;var x=u&&d;return function(t){var n=v;if(y&&t%1)return"";var a=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===l?"":l;if(0>p){var s=$o.formatPrefix(t,f);t=s.scale(t),n=s.symbol+v}else t*=p;t=h(t,f);var b,A,M=t.lastIndexOf(".");if(0>M){var k=m?t.lastIndexOf("e"):-1;0>k?(b=t,A=""):(b=t.substring(0,k),A=t.substring(k))}else b=t.substring(0,M),A=e+t.substring(M+1);!u&&d&&(b=i(b,1/0));var w=g.length+b.length+A.length+(x?0:a.length),C=c>w?new Array(w=c-w+1).join(r):"";return x&&(b=i(C+b,C.length?c-A.length:1/0)),a+=g,t=b+A,("<"===o?a+t+C:">"===o?C+a+t:"^"===o?C.substring(0,w>>=1)+a+t+C.substring(w):a+(x?t:C+t))+n}}}function Ee(t){return t+""}function Ge(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ye(t,e,n){function r(e){var n=t(e),r=i(n,1);return r-e>e-n?n:r}function a(n){return e(n=t(new is(n-1)),1),n}function i(t,n){return e(t=new is(+t),n),t}function o(t,r,i){var o=a(t),l=[];if(i>1)for(;r>o;)n(o)%i||l.push(new Date(+o)),e(o,1);else for(;r>o;)l.push(new Date(+o)),e(o,1);return l}function l(t,e,n){try{is=Ge;var r=new Ge;return r._=t,o(r,e,n)}finally{is=Date}}t.floor=t,t.round=r,t.ceil=a,t.offset=i,t.range=o;var s=t.utc=Re(t);return s.floor=s,s.round=Re(r),s.ceil=Re(a),s.offset=Re(i),s.range=l,t}function Re(t){return function(e,n){try{is=Ge;var r=new Ge;return r._=e,t(r,n)._}finally{is=Date}}}function Oe(t){function e(t){function e(e){for(var n,a,i,o=[],l=-1,s=0;++l<r;)37===t.charCodeAt(l)&&(o.push(t.slice(s,l)),null!=(a=ls[n=t.charAt(++l)])&&(n=t.charAt(++l)),(i=L[n])&&(n=i(e,null==a?"e"===n?" ":"0":a)),o.push(n),s=l+1);return o.push(t.slice(s,l)),o.join("")}var r=t.length;return e.parse=function(e){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},a=n(r,t,e,0);if(a!=e.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&is!==Ge,o=new(i?Ge:is);return"j"in r?o.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+(0|r.Z/100),r.M+r.Z%100,r.S,r.L),i?o._:o},e.toString=function(){return t},e}function n(t,e,n,r){for(var a,i,o,l=0,s=e.length,u=n.length;s>l;){if(r>=u)return-1;if(a=e.charCodeAt(l++),37===a){if(o=e.charAt(l++),i=D[o in ls?e.charAt(l++):o],!i||(r=i(t,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}function r(t,e,n){M.lastIndex=0;var r=M.exec(e.slice(n));return r?(t.w=k.get(r[0].toLowerCase()),n+r[0].length):-1}function a(t,e,n){b.lastIndex=0;var r=b.exec(e.slice(n));return r?(t.w=A.get(r[0].toLowerCase()),n+r[0].length):-1}function i(t,e,n){T.lastIndex=0;var r=T.exec(e.slice(n));return r?(t.m=S.get(r[0].toLowerCase()),n+r[0].length):-1}function o(t,e,n){w.lastIndex=0;var r=w.exec(e.slice(n));return r?(t.m=C.get(r[0].toLowerCase()),n+r[0].length):-1}function l(t,e,r){return n(t,L.c.toString(),e,r)}function s(t,e,r){return n(t,L.x.toString(),e,r)}function u(t,e,r){return n(t,L.X.toString(),e,r)}function c(t,e,n){var r=x.get(e.slice(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)}var d=t.dateTime,f=t.date,h=t.time,p=t.periods,g=t.days,v=t.shortDays,y=t.months,m=t.shortMonths;e.utc=function(t){function n(t){try{is=Ge;var e=new is;return e._=t,r(e)}finally{is=Date}}var r=e(t);return n.parse=function(t){try{is=Ge;var e=r.parse(t);return e&&e._}finally{is=Date}},n.toString=r.toString,n},e.multi=e.utc.multi=sn;var x=$o.map(),b=Xe(g),A=qe(g),M=Xe(v),k=qe(v),w=Xe(y),C=qe(y),T=Xe(m),S=qe(m);p.forEach(function(t,e){x.set(t.toLowerCase(),e)});var L={a:function(t){return v[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return m[t.getMonth()]},B:function(t){return y[t.getMonth()]},c:e(d),d:function(t,e){return Be(t.getDate(),e,2)},e:function(t,e){return Be(t.getDate(),e,2)},H:function(t,e){return Be(t.getHours(),e,2)},I:function(t,e){return Be(t.getHours()%12||12,e,2)},j:function(t,e){return Be(1+as.dayOfYear(t),e,3)},L:function(t,e){return Be(t.getMilliseconds(),e,3)},m:function(t,e){return Be(t.getMonth()+1,e,2)},M:function(t,e){return Be(t.getMinutes(),e,2)},p:function(t){return p[+(t.getHours()>=12)]},S:function(t,e){return Be(t.getSeconds(),e,2)},U:function(t,e){return Be(as.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Be(as.mondayOfYear(t),e,2)},x:e(f),X:e(h),y:function(t,e){return Be(t.getFullYear()%100,e,2)},Y:function(t,e){return Be(t.getFullYear()%1e4,e,4)},Z:on,"%":function(){return"%"}},D={a:r,A:a,b:i,B:o,c:l,d:Qe,e:Qe,H:en,I:en,j:tn,L:an,m:Ke,M:nn,p:c,S:rn,U:je,w:Ue,W:He,x:s,X:u,y:$e,Y:We,Z:Je,"%":ln};return e}function Be(t,e,n){var r=0>t?"-":"",a=(r?-t:t)+"",i=a.length;return r+(n>i?new Array(n-i+1).join(e)+a:a)}function Xe(t){return new RegExp("^(?:"+t.map($o.requote).join("|")+")","i")}function qe(t){for(var e=new l,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function Ue(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function je(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function He(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function We(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function $e(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.y=Ze(+r[0]),n+r[0].length):-1}function Je(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function Ze(t){return t+(t>68?1900:2e3)}function Ke(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Qe(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function tn(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+3));return r?(t.j=+r[0],n+r[0].length):-1}function en(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function nn(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function rn(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function an(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function on(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",r=0|ul(e)/60,a=ul(e)%60;return n+Be(r,"0",2)+Be(a,"0",2)}function ln(t,e,n){us.lastIndex=0;var r=us.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function sn(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,r=t[n];!r[1](e);)r=t[++n];return r[0](e)}}function un(){}function cn(t,e,n){var r=n.s=t+e,a=r-t,i=r-a;n.t=t-i+(e-a)}function dn(t,e){t&&hs.hasOwnProperty(t.type)&&hs[t.type](t,e)}function fn(t,e,n){var r,a=-1,i=t.length-n;for(e.lineStart();++a<i;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function hn(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)fn(t[n],e,1);e.polygonEnd()}function pn(){function t(t,e){t*=Pl,e=e*Pl/2+Sl/4;var n=t-r,o=n>=0?1:-1,l=o*n,s=Math.cos(e),u=Math.sin(e),c=i*u,d=a*s+c*Math.cos(l),f=c*o*Math.sin(l);gs.add(Math.atan2(f,d)),r=t,a=s,i=u}var e,n,r,a,i;vs.point=function(o,l){vs.point=t,r=(e=o)*Pl,a=Math.cos(l=(n=l)*Pl/2+Sl/4),i=Math.sin(l)},vs.lineEnd=function(){t(e,n)}}function gn(t){var e=t[0],n=t[1],r=Math.cos(n);return[r*Math.cos(e),r*Math.sin(e),Math.sin(n)]}function vn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function yn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function mn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function xn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function bn(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function An(t){return[Math.atan2(t[1],t[0]),te(t[2])]}function Mn(t,e){return ul(t[0]-e[0])<Nl&&ul(t[1]-e[1])<Nl}function kn(t,e){t*=Pl;var n=Math.cos(e*=Pl);wn(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function wn(t,e,n){++ys,xs+=(t-xs)/ys,bs+=(e-bs)/ys,As+=(n-As)/ys}function Cn(){function t(t,a){t*=Pl;var i=Math.cos(a*=Pl),o=i*Math.cos(t),l=i*Math.sin(t),s=Math.sin(a),u=Math.atan2(Math.sqrt((u=n*s-r*l)*u+(u=r*o-e*s)*u+(u=e*l-n*o)*u),e*o+n*l+r*s);ms+=u,Ms+=u*(e+(e=o)),ks+=u*(n+(n=l)),ws+=u*(r+(r=s)),wn(e,n,r)}var e,n,r;Ls.point=function(a,i){a*=Pl;var o=Math.cos(i*=Pl);e=o*Math.cos(a),n=o*Math.sin(a),r=Math.sin(i),Ls.point=t,wn(e,n,r)}}function Tn(){Ls.point=kn}function Sn(){function t(t,e){t*=Pl;var n=Math.cos(e*=Pl),o=n*Math.cos(t),l=n*Math.sin(t),s=Math.sin(e),u=a*s-i*l,c=i*o-r*s,d=r*l-a*o,f=Math.sqrt(u*u+c*c+d*d),h=r*o+a*l+i*s,p=f&&-Q(h)/f,g=Math.atan2(f,h);Cs+=p*u,Ts+=p*c,Ss+=p*d,ms+=g,Ms+=g*(r+(r=o)),ks+=g*(a+(a=l)),ws+=g*(i+(i=s)),wn(r,a,i)}var e,n,r,a,i;Ls.point=function(o,l){e=o,n=l,Ls.point=t,o*=Pl;var s=Math.cos(l*=Pl);r=s*Math.cos(o),a=s*Math.sin(o),i=Math.sin(l),wn(r,a,i)},Ls.lineEnd=function(){t(e,n),Ls.lineEnd=Tn,Ls.point=kn}}function Ln(){return!0}function Dn(t,e,n,r,a){var i=[],o=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],r=t[e];if(Mn(n,r)){a.lineStart();for(var l=0;e>l;++l)a.point((n=t[l])[0],n[1]);return void a.lineEnd()}var s=new _n(n,t,null,!0),u=new _n(n,null,s,!1);s.o=u,i.push(s),o.push(u),s=new _n(r,t,null,!1),u=new _n(r,null,s,!0),s.o=u,i.push(s),o.push(u)}}),o.sort(e),Nn(i),Nn(o),i.length){for(var l=0,s=n,u=o.length;u>l;++l)o[l].e=s=!s;for(var c,d,f=i[0];;){for(var h=f,p=!0;h.v;)if((h=h.n)===f)return;c=h.z,a.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(var l=0,u=c.length;u>l;++l)a.point((d=c[l])[0],d[1]);else r(h.x,h.n.x,1,a);h=h.n}else{if(p){c=h.p.z;for(var l=c.length-1;l>=0;--l)a.point((d=c[l])[0],d[1])}else r(h.x,h.p.x,-1,a);h=h.p}h=h.o,c=h.z,p=!p}while(!h.v);a.lineEnd()}}}function Nn(t){if(e=t.length){for(var e,n,r=0,a=t[0];++r<e;)a.n=n=t[r],n.p=a,a=n;a.n=n=t[0],n.p=a}}function _n(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Pn(t,e,n,r){return function(a,i){function o(e,n){var r=a(e,n);t(e=r[0],n=r[1])&&i.point(e,n)}function l(t,e){var n=a(t,e);v.point(n[0],n[1])}function s(){m.point=l,v.lineStart()}function u(){m.point=o,v.lineEnd()}function c(t,e){g.push([t,e]);var n=a(t,e);b.point(n[0],n[1])}function d(){b.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),b.lineEnd();var t,e=b.clean(),n=x.buffer(),r=n.length;if(g.pop(),p.push(g),g=null,r)if(1&e){t=n[0];var a,r=t.length-1,o=-1;if(r>0){for(A||(i.polygonStart(),A=!0),i.lineStart();++o<r;)i.point((a=t[o])[0],a[1]);i.lineEnd()}}else r>1&&2&e&&n.push(n.pop().concat(n.shift())),h.push(n.filter(In))}var h,p,g,v=e(i),y=a.invert(r[0],r[1]),m={point:o,lineStart:s,lineEnd:u,polygonStart:function(){m.point=c,m.lineStart=d,m.lineEnd=f,h=[],p=[]},polygonEnd:function(){m.point=o,m.lineStart=s,m.lineEnd=u,h=$o.merge(h);var t=Yn(y,p);h.length?(A||(i.polygonStart(),A=!0),Dn(h,Fn,t,n,i)):t&&(A||(i.polygonStart(),A=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),A&&(i.polygonEnd(),A=!1),h=p=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}},x=Vn(),b=e(x),A=!1;return m}}function In(t){return t.length>1}function Vn(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:m,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Fn(t,e){return((t=t.x)[0]<0?t[1]-Dl-Nl:Dl-t[1])-((e=e.x)[0]<0?e[1]-Dl-Nl:Dl-e[1])}function zn(t){var e,n=0/0,r=0/0,a=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(i,o){var l=i>0?Sl:-Sl,s=ul(i-n);ul(s-Sl)<Nl?(t.point(n,r=(r+o)/2>0?Dl:-Dl),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(i,r),e=0):a!==l&&s>=Sl&&(ul(n-a)<Nl&&(n-=a*Nl),ul(i-l)<Nl&&(i-=l*Nl),r=En(n,r,i,o),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(l,r),e=0),t.point(n=i,r=o),a=l},lineEnd:function(){t.lineEnd(),n=r=0/0},clean:function(){return 2-e}}}function En(t,e,n,r){var a,i,o=Math.sin(t-n);return ul(o)>Nl?Math.atan((Math.sin(e)*(i=Math.cos(r))*Math.sin(n)-Math.sin(r)*(a=Math.cos(e))*Math.sin(t))/(a*i*o)):(e+r)/2}function Gn(t,e,n,r){var a;if(null==t)a=n*Dl,r.point(-Sl,a),r.point(0,a),r.point(Sl,a),r.point(Sl,0),r.point(Sl,-a),r.point(0,-a),r.point(-Sl,-a),r.point(-Sl,0),r.point(-Sl,a);else if(ul(t[0]-e[0])>Nl){var i=t[0]<e[0]?Sl:-Sl;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(e[0],e[1])}function Yn(t,e){var n=t[0],r=t[1],a=[Math.sin(n),-Math.cos(n),0],i=0,o=0;gs.reset();for(var l=0,s=e.length;s>l;++l){var u=e[l],c=u.length;if(c)for(var d=u[0],f=d[0],h=d[1]/2+Sl/4,p=Math.sin(h),g=Math.cos(h),v=1;;){v===c&&(v=0),t=u[v];var y=t[0],m=t[1]/2+Sl/4,x=Math.sin(m),b=Math.cos(m),A=y-f,M=A>=0?1:-1,k=M*A,w=k>Sl,C=p*x;if(gs.add(Math.atan2(C*M*Math.sin(k),g*b+C*Math.cos(k))),i+=w?A+M*Ll:A,w^f>=n^y>=n){var T=yn(gn(d),gn(t));bn(T);var S=yn(a,T);bn(S);var L=(w^A>=0?-1:1)*te(S[2]);(r>L||r===L&&(T[0]||T[1]))&&(o+=w^A>=0?1:-1)}if(!v++)break;f=y,p=x,g=b,d=t}}return(-Nl>i||Nl>i&&0>gs)^1&o}function Rn(t){function e(t,e){return Math.cos(t)*Math.cos(e)>i}function n(t){var n,i,s,u,c;return{lineStart:function(){u=s=!1,c=1},point:function(d,f){var h,p=[d,f],g=e(d,f),v=o?g?0:a(d,f):g?a(d+(0>d?Sl:-Sl),f):0;if(!n&&(u=s=g)&&t.lineStart(),g!==s&&(h=r(n,p),(Mn(n,h)||Mn(p,h))&&(p[0]+=Nl,p[1]+=Nl,g=e(p[0],p[1]))),g!==s)c=0,g?(t.lineStart(),h=r(p,n),t.point(h[0],h[1])):(h=r(n,p),t.point(h[0],h[1]),t.lineEnd()),n=h;else if(l&&n&&o^g){var y;v&i||!(y=r(p,n,!0))||(c=0,o?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!g||n&&Mn(n,p)||t.point(p[0],p[1]),n=p,s=g,i=v},lineEnd:function(){s&&t.lineEnd(),n=null},clean:function(){return c|(u&&s)<<1}}}function r(t,e,n){var r=gn(t),a=gn(e),o=[1,0,0],l=yn(r,a),s=vn(l,l),u=l[0],c=s-u*u;if(!c)return!n&&t;var d=i*s/c,f=-i*u/c,h=yn(o,l),p=xn(o,d),g=xn(l,f);mn(p,g);var v=h,y=vn(p,v),m=vn(v,v),x=y*y-m*(vn(p,p)-1);if(!(0>x)){var b=Math.sqrt(x),A=xn(v,(-y-b)/m);if(mn(A,p),A=An(A),!n)return A;var M,k=t[0],w=e[0],C=t[1],T=e[1];k>w&&(M=k,k=w,w=M);var S=w-k,L=ul(S-Sl)<Nl,D=L||Nl>S;if(!L&&C>T&&(M=C,C=T,T=M),D?L?C+T>0^A[1]<(ul(A[0]-k)<Nl?C:T):C<=A[1]&&A[1]<=T:S>Sl^(k<=A[0]&&A[0]<=w)){var N=xn(v,(-y+b)/m);return mn(N,p),[A,An(N)]}}}function a(e,n){var r=o?t:Sl-t,a=0;return-r>e?a|=1:e>r&&(a|=2),-r>n?a|=4:n>r&&(a|=8),a}var i=Math.cos(t),o=i>0,l=ul(i)>Nl,s=pr(t,6*Pl);return Pn(e,n,s,o?[0,-t]:[-Sl,t-Sl])}function On(t,e,n,r){return function(a){var i,o=a.a,l=a.b,s=o.x,u=o.y,c=l.x,d=l.y,f=0,h=1,p=c-s,g=d-u;if(i=t-s,p||!(i>0)){if(i/=p,0>p){if(f>i)return;h>i&&(h=i)}else if(p>0){if(i>h)return;i>f&&(f=i)}if(i=n-s,p||!(0>i)){if(i/=p,0>p){if(i>h)return;i>f&&(f=i)}else if(p>0){if(f>i)return;h>i&&(h=i)}if(i=e-u,g||!(i>0)){if(i/=g,0>g){if(f>i)return;h>i&&(h=i)}else if(g>0){if(i>h)return;i>f&&(f=i)}if(i=r-u,g||!(0>i)){if(i/=g,0>g){if(i>h)return;i>f&&(f=i)}else if(g>0){if(f>i)return;h>i&&(h=i)}return f>0&&(a.a={x:s+f*p,y:u+f*g}),1>h&&(a.b={x:s+h*p,y:u+h*g}),a}}}}}}function Bn(t,e,n,r){function a(r,a){return ul(r[0]-t)<Nl?a>0?0:3:ul(r[0]-n)<Nl?a>0?2:1:ul(r[1]-e)<Nl?a>0?1:0:a>0?3:2}function i(t,e){return o(t.x,e.x)}function o(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(l){function s(t){for(var e=0,n=v.length,r=t[1],a=0;n>a;++a)for(var i,o=1,l=v[a],s=l.length,u=l[0];s>o;++o)i=l[o],u[1]<=r?i[1]>r&&K(u,i,t)>0&&++e:i[1]<=r&&K(u,i,t)<0&&--e,u=i;return 0!==e}function u(i,l,s,u){var c=0,d=0;if(null==i||(c=a(i,s))!==(d=a(l,s))||o(i,l)<0^s>0){do u.point(0===c||3===c?t:n,c>1?r:e);while((c=(c+s+4)%4)!==d)}else u.point(l[0],l[1])}function c(a,i){return a>=t&&n>=a&&i>=e&&r>=i}function d(t,e){c(t,e)&&l.point(t,e)}function f(){D.point=p,v&&v.push(y=[]),w=!0,k=!1,A=M=0/0}function h(){g&&(p(m,x),b&&k&&S.rejoin(),g.push(S.buffer())),D.point=d,k&&l.lineEnd()}function p(t,e){t=Math.max(-Ns,Math.min(Ns,t)),e=Math.max(-Ns,Math.min(Ns,e));var n=c(t,e);if(v&&y.push([t,e]),w)m=t,x=e,b=n,w=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&k)l.point(t,e);else{var r={a:{x:A,y:M},b:{x:t,y:e}};L(r)?(k||(l.lineStart(),l.point(r.a.x,r.a.y)),l.point(r.b.x,r.b.y),n||l.lineEnd(),C=!1):n&&(l.lineStart(),l.point(t,e),C=!1)}A=t,M=e,k=n}var g,v,y,m,x,b,A,M,k,w,C,T=l,S=Vn(),L=On(t,e,n,r),D={point:d,lineStart:f,lineEnd:h,polygonStart:function(){l=S,g=[],v=[],C=!0},polygonEnd:function(){l=T,g=$o.merge(g);var e=s([t,r]),n=C&&e,a=g.length;(n||a)&&(l.polygonStart(),n&&(l.lineStart(),u(null,null,1,l),l.lineEnd()),a&&Dn(g,i,e,u,l),l.polygonEnd()),g=v=y=null}};return D}}function Xn(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return n=e.invert(n,r),n&&t.invert(n[0],n[1])}),n}function qn(t){var e=0,n=Sl/3,r=or(t),a=r(e,n);return a.parallels=function(t){return arguments.length?r(e=t[0]*Sl/180,n=t[1]*Sl/180):[180*(e/Sl),180*(n/Sl)]},a}function Un(t,e){function n(t,e){var n=Math.sqrt(i-2*a*Math.sin(e))/a;return[n*Math.sin(t*=a),o-n*Math.cos(t)]}var r=Math.sin(t),a=(r+Math.sin(e))/2,i=1+r*(2*a-r),o=Math.sqrt(i)/a;return n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/a,te((i-(t*t+n*n)*a*a)/(2*a))]},n}function jn(){function t(t,e){Ps+=a*t-r*e,r=t,a=e}var e,n,r,a;Es.point=function(i,o){Es.point=t,e=r=i,n=a=o},Es.lineEnd=function(){t(e,n)}}function Hn(t,e){Is>t&&(Is=t),t>Fs&&(Fs=t),Vs>e&&(Vs=e),e>zs&&(zs=e)}function Wn(){function t(t,e){o.push("M",t,",",e,i)}function e(t,e){o.push("M",t,",",e),l.point=n}function n(t,e){o.push("L",t,",",e)}function r(){l.point=t}function a(){o.push("Z")}var i=$n(4.5),o=[],l={point:t,lineStart:function(){l.point=e},lineEnd:r,polygonStart:function(){l.lineEnd=a},polygonEnd:function(){l.lineEnd=r,l.point=t},pointRadius:function(t){return i=$n(t),l},result:function(){if(o.length){var t=o.join("");return o=[],t}}};return l}function $n(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Jn(t,e){xs+=t,bs+=e,++As}function Zn(){function t(t,r){var a=t-e,i=r-n,o=Math.sqrt(a*a+i*i);Ms+=o*(e+t)/2,ks+=o*(n+r)/2,ws+=o,Jn(e=t,n=r)}var e,n;Ys.point=function(r,a){Ys.point=t,Jn(e=r,n=a)}}function Kn(){Ys.point=Jn}function Qn(){function t(t,e){var n=t-r,i=e-a,o=Math.sqrt(n*n+i*i);Ms+=o*(r+t)/2,ks+=o*(a+e)/2,ws+=o,o=a*t-r*e,Cs+=o*(r+t),Ts+=o*(a+e),Ss+=3*o,Jn(r=t,a=e)}var e,n,r,a;Ys.point=function(i,o){Ys.point=t,Jn(e=r=i,n=a=o)},Ys.lineEnd=function(){t(e,n)}}function tr(t){function e(e,n){t.moveTo(e,n),t.arc(e,n,o,0,Ll)}function n(e,n){t.moveTo(e,n),l.point=r}function r(e,n){t.lineTo(e,n)}function a(){l.point=e}function i(){t.closePath()}var o=4.5,l={point:e,lineStart:function(){l.point=n},lineEnd:a,polygonStart:function(){l.lineEnd=i},polygonEnd:function(){l.lineEnd=a,l.point=e},pointRadius:function(t){return o=t,l},result:m};return l}function er(t){function e(t){return(l?r:n)(t)}function n(e){return ar(e,function(n,r){n=t(n,r),e.point(n[0],n[1])})}function r(e){function n(n,r){n=t(n,r),e.point(n[0],n[1])
}function r(){x=0/0,w.point=i,e.lineStart()}function i(n,r){var i=gn([n,r]),o=t(n,r);a(x,b,m,A,M,k,x=o[0],b=o[1],m=n,A=i[0],M=i[1],k=i[2],l,e),e.point(x,b)}function o(){w.point=n,e.lineEnd()}function s(){r(),w.point=u,w.lineEnd=c}function u(t,e){i(d=t,f=e),h=x,p=b,g=A,v=M,y=k,w.point=i}function c(){a(x,b,m,A,M,k,h,p,d,g,v,y,l,e),w.lineEnd=o,o()}var d,f,h,p,g,v,y,m,x,b,A,M,k,w={point:n,lineStart:r,lineEnd:o,polygonStart:function(){e.polygonStart(),w.lineStart=s},polygonEnd:function(){e.polygonEnd(),w.lineStart=r}};return w}function a(e,n,r,l,s,u,c,d,f,h,p,g,v,y){var m=c-e,x=d-n,b=m*m+x*x;if(b>4*i&&v--){var A=l+h,M=s+p,k=u+g,w=Math.sqrt(A*A+M*M+k*k),C=Math.asin(k/=w),T=ul(ul(k)-1)<Nl||ul(r-f)<Nl?(r+f)/2:Math.atan2(M,A),S=t(T,C),L=S[0],D=S[1],N=L-e,_=D-n,P=x*N-m*_;(P*P/b>i||ul((m*N+x*_)/b-.5)>.3||o>l*h+s*p+u*g)&&(a(e,n,r,l,s,u,L,D,T,A/=w,M/=w,k,v,y),y.point(L,D),a(L,D,T,A,M,k,c,d,f,h,p,g,v,y))}}var i=.5,o=Math.cos(30*Pl),l=16;return e.precision=function(t){return arguments.length?(l=(i=t*t)>0&&16,e):Math.sqrt(i)},e}function nr(t){var e=er(function(e,n){return t([e*Il,n*Il])});return function(t){return lr(e(t))}}function rr(t){this.stream=t}function ar(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function ir(t){return or(function(){return t})()}function or(t){function e(t){return t=l(t[0]*Pl,t[1]*Pl),[t[0]*f+s,u-t[1]*f]}function n(t){return t=l.invert((t[0]-s)/f,(u-t[1])/f),t&&[t[0]*Il,t[1]*Il]}function r(){l=Xn(o=cr(y,m,x),i);var t=i(g,v);return s=h-t[0]*f,u=p+t[1]*f,a()}function a(){return c&&(c.valid=!1,c=null),e}var i,o,l,s,u,c,d=er(function(t,e){return t=i(t,e),[t[0]*f+s,u-t[1]*f]}),f=150,h=480,p=250,g=0,v=0,y=0,m=0,x=0,b=Ds,A=Te,M=null,k=null;return e.stream=function(t){return c&&(c.valid=!1),c=lr(b(o,d(A(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(b=null==t?(M=t,Ds):Rn((M=+t)*Pl),a()):M},e.clipExtent=function(t){return arguments.length?(k=t,A=t?Bn(t[0][0],t[0][1],t[1][0],t[1][1]):Te,a()):k},e.scale=function(t){return arguments.length?(f=+t,r()):f},e.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],r()):[h,p]},e.center=function(t){return arguments.length?(g=t[0]%360*Pl,v=t[1]%360*Pl,r()):[g*Il,v*Il]},e.rotate=function(t){return arguments.length?(y=t[0]%360*Pl,m=t[1]%360*Pl,x=t.length>2?t[2]%360*Pl:0,r()):[y*Il,m*Il,x*Il]},$o.rebind(e,d,"precision"),function(){return i=t.apply(this,arguments),e.invert=i.invert&&n,r()}}function lr(t){return ar(t,function(e,n){t.point(e*Pl,n*Pl)})}function sr(t,e){return[t,e]}function ur(t,e){return[t>Sl?t-Ll:-Sl>t?t+Ll:t,e]}function cr(t,e,n){return t?e||n?Xn(fr(t),hr(e,n)):fr(t):e||n?hr(e,n):ur}function dr(t){return function(e,n){return e+=t,[e>Sl?e-Ll:-Sl>e?e+Ll:e,n]}}function fr(t){var e=dr(t);return e.invert=dr(-t),e}function hr(t,e){function n(t,e){var n=Math.cos(e),l=Math.cos(t)*n,s=Math.sin(t)*n,u=Math.sin(e),c=u*r+l*a;return[Math.atan2(s*i-c*o,l*r-u*a),te(c*i+s*o)]}var r=Math.cos(t),a=Math.sin(t),i=Math.cos(e),o=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),l=Math.cos(t)*n,s=Math.sin(t)*n,u=Math.sin(e),c=u*i-s*o;return[Math.atan2(s*i+u*o,l*r+c*a),te(c*r-l*a)]},n}function pr(t,e){var n=Math.cos(t),r=Math.sin(t);return function(a,i,o,l){var s=o*e;null!=a?(a=gr(n,a),i=gr(n,i),(o>0?i>a:a>i)&&(a+=o*Ll)):(a=t+o*Ll,i=t-.5*s);for(var u,c=a;o>0?c>i:i>c;c-=s)l.point((u=An([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],u[1])}}function gr(t,e){var n=gn(e);n[0]-=t,bn(n);var r=Q(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-Nl)%(2*Math.PI)}function vr(t,e,n){var r=$o.range(t,e-Nl,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function yr(t,e,n){var r=$o.range(t,e-Nl,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function mr(t){return t.source}function xr(t){return t.target}function br(t,e,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(r),l=Math.sin(r),s=a*Math.cos(t),u=a*Math.sin(t),c=o*Math.cos(n),d=o*Math.sin(n),f=2*Math.asin(Math.sqrt(ae(r-e)+a*o*ae(n-t))),h=1/Math.sin(f),p=f?function(t){var e=Math.sin(t*=f)*h,n=Math.sin(f-t)*h,r=n*s+e*c,a=n*u+e*d,o=n*i+e*l;return[Math.atan2(a,r)*Il,Math.atan2(o,Math.sqrt(r*r+a*a))*Il]}:function(){return[t*Il,e*Il]};return p.distance=f,p}function Ar(){function t(t,a){var i=Math.sin(a*=Pl),o=Math.cos(a),l=ul((t*=Pl)-e),s=Math.cos(l);Rs+=Math.atan2(Math.sqrt((l=o*Math.sin(l))*l+(l=r*i-n*o*s)*l),n*i+r*o*s),e=t,n=i,r=o}var e,n,r;Os.point=function(a,i){e=a*Pl,n=Math.sin(i*=Pl),r=Math.cos(i),Os.point=t},Os.lineEnd=function(){Os.point=Os.lineEnd=m}}function Mr(t,e){function n(e,n){var r=Math.cos(e),a=Math.cos(n),i=t(r*a);return[i*a*Math.sin(e),i*Math.sin(n)]}return n.invert=function(t,n){var r=Math.sqrt(t*t+n*n),a=e(r),i=Math.sin(a),o=Math.cos(a);return[Math.atan2(t*i,r*o),Math.asin(r&&n*i/r)]},n}function kr(t,e){function n(t,e){o>0?-Dl+Nl>e&&(e=-Dl+Nl):e>Dl-Nl&&(e=Dl-Nl);var n=o/Math.pow(a(e),i);return[n*Math.sin(i*t),o-n*Math.cos(i*t)]}var r=Math.cos(t),a=function(t){return Math.tan(Sl/4+t/2)},i=t===e?Math.sin(t):Math.log(r/Math.cos(e))/Math.log(a(e)/a(t)),o=r*Math.pow(a(t),i)/i;return i?(n.invert=function(t,e){var n=o-e,r=Z(i)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/i,2*Math.atan(Math.pow(o/r,1/i))-Dl]},n):Cr}function wr(t,e){function n(t,e){var n=i-e;return[n*Math.sin(a*t),i-n*Math.cos(a*t)]}var r=Math.cos(t),a=t===e?Math.sin(t):(r-Math.cos(e))/(e-t),i=r/a+t;return ul(a)<Nl?sr:(n.invert=function(t,e){var n=i-e;return[Math.atan2(t,n)/a,i-Z(a)*Math.sqrt(t*t+n*n)]},n)}function Cr(t,e){return[t,Math.log(Math.tan(Sl/4+e/2))]}function Tr(t){var e,n=ir(t),r=n.scale,a=n.translate,i=n.clipExtent;return n.scale=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=a.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var o=i.apply(n,arguments);if(o===n){if(e=null==t){var l=Sl*r(),s=a();i([[s[0]-l,s[1]-l],[s[0]+l,s[1]+l]])}}else e&&(o=null);return o},n.clipExtent(null)}function Sr(t,e){return[Math.log(Math.tan(Sl/4+e/2)),-t]}function Lr(t){return t[0]}function Dr(t){return t[1]}function Nr(t){for(var e=t.length,n=[0,1],r=2,a=2;e>a;a++){for(;r>1&&K(t[n[r-2]],t[n[r-1]],t[a])<=0;)--r;n[r++]=a}return n.slice(0,r)}function _r(t,e){return t[0]-e[0]||t[1]-e[1]}function Pr(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Ir(t,e,n,r){var a=t[0],i=n[0],o=e[0]-a,l=r[0]-i,s=t[1],u=n[1],c=e[1]-s,d=r[1]-u,f=(l*(s-u)-d*(a-i))/(d*o-l*c);return[a+f*o,s+f*c]}function Vr(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function Fr(){na(this),this.edge=this.site=this.circle=null}function zr(t){var e=Qs.pop()||new Fr;return e.site=t,e}function Er(t){Hr(t),Js.remove(t),Qs.push(t),na(t)}function Gr(t){var e=t.circle,n=e.x,r=e.cy,a={x:n,y:r},i=t.P,o=t.N,l=[t];Er(t);for(var s=i;s.circle&&ul(n-s.circle.x)<Nl&&ul(r-s.circle.cy)<Nl;)i=s.P,l.unshift(s),Er(s),s=i;l.unshift(s),Hr(s);for(var u=o;u.circle&&ul(n-u.circle.x)<Nl&&ul(r-u.circle.cy)<Nl;)o=u.N,l.push(u),Er(u),u=o;l.push(u),Hr(u);var c,d=l.length;for(c=1;d>c;++c)u=l[c],s=l[c-1],Qr(u.edge,s.site,u.site,a);s=l[0],u=l[d-1],u.edge=Zr(s.site,u.site,null,a),jr(s),jr(u)}function Yr(t){for(var e,n,r,a,i=t.x,o=t.y,l=Js._;l;)if(r=Rr(l,o)-i,r>Nl)l=l.L;else{if(a=i-Or(l,o),!(a>Nl)){r>-Nl?(e=l.P,n=l):a>-Nl?(e=l,n=l.N):e=n=l;break}if(!l.R){e=l;break}l=l.R}var s=zr(t);if(Js.insert(e,s),e||n){if(e===n)return Hr(e),n=zr(e.site),Js.insert(s,n),s.edge=n.edge=Zr(e.site,s.site),jr(e),void jr(n);if(!n)return void(s.edge=Zr(e.site,s.site));Hr(e),Hr(n);var u=e.site,c=u.x,d=u.y,f=t.x-c,h=t.y-d,p=n.site,g=p.x-c,v=p.y-d,y=2*(f*v-h*g),m=f*f+h*h,x=g*g+v*v,b={x:(v*m-h*x)/y+c,y:(f*x-g*m)/y+d};Qr(n.edge,u,p,b),s.edge=Zr(u,t,null,b),n.edge=Zr(t,p,null,b),jr(e),jr(n)}}function Rr(t,e){var n=t.site,r=n.x,a=n.y,i=a-e;if(!i)return r;var o=t.P;if(!o)return-1/0;n=o.site;var l=n.x,s=n.y,u=s-e;if(!u)return l;var c=l-r,d=1/i-1/u,f=c/u;return d?(-f+Math.sqrt(f*f-2*d*(c*c/(-2*u)-s+u/2+a-i/2)))/d+r:(r+l)/2}function Or(t,e){var n=t.N;if(n)return Rr(n,e);var r=t.site;return r.y===e?r.x:1/0}function Br(t){this.site=t,this.edges=[]}function Xr(t){for(var e,n,r,a,i,o,l,s,u,c,d=t[0][0],f=t[1][0],h=t[0][1],p=t[1][1],g=$s,v=g.length;v--;)if(i=g[v],i&&i.prepare())for(l=i.edges,s=l.length,o=0;s>o;)c=l[o].end(),r=c.x,a=c.y,u=l[++o%s].start(),e=u.x,n=u.y,(ul(r-e)>Nl||ul(a-n)>Nl)&&(l.splice(o,0,new ta(Kr(i.site,c,ul(r-d)<Nl&&p-a>Nl?{x:d,y:ul(e-d)<Nl?n:p}:ul(a-p)<Nl&&f-r>Nl?{x:ul(n-p)<Nl?e:f,y:p}:ul(r-f)<Nl&&a-h>Nl?{x:f,y:ul(e-f)<Nl?n:h}:ul(a-h)<Nl&&r-d>Nl?{x:ul(n-h)<Nl?e:d,y:h}:null),i.site,null)),++s)}function qr(t,e){return e.angle-t.angle}function Ur(){na(this),this.x=this.y=this.arc=this.site=this.cy=null}function jr(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,a=t.site,i=n.site;if(r!==i){var o=a.x,l=a.y,s=r.x-o,u=r.y-l,c=i.x-o,d=i.y-l,f=2*(s*d-u*c);if(!(f>=-_l)){var h=s*s+u*u,p=c*c+d*d,g=(d*h-u*p)/f,v=(s*p-c*h)/f,d=v+l,y=tu.pop()||new Ur;y.arc=t,y.site=a,y.x=g+o,y.y=d+Math.sqrt(g*g+v*v),y.cy=d,t.circle=y;for(var m=null,x=Ks._;x;)if(y.y<x.y||y.y===x.y&&y.x<=x.x){if(!x.L){m=x.P;break}x=x.L}else{if(!x.R){m=x;break}x=x.R}Ks.insert(m,y),m||(Zs=y)}}}}function Hr(t){var e=t.circle;e&&(e.P||(Zs=e.N),Ks.remove(e),tu.push(e),na(e),t.circle=null)}function Wr(t){for(var e,n=Ws,r=On(t[0][0],t[0][1],t[1][0],t[1][1]),a=n.length;a--;)e=n[a],(!$r(e,t)||!r(e)||ul(e.a.x-e.b.x)<Nl&&ul(e.a.y-e.b.y)<Nl)&&(e.a=e.b=null,n.splice(a,1))}function $r(t,e){var n=t.b;if(n)return!0;var r,a,i=t.a,o=e[0][0],l=e[1][0],s=e[0][1],u=e[1][1],c=t.l,d=t.r,f=c.x,h=c.y,p=d.x,g=d.y,v=(f+p)/2,y=(h+g)/2;if(g===h){if(o>v||v>=l)return;if(f>p){if(i){if(i.y>=u)return}else i={x:v,y:s};n={x:v,y:u}}else{if(i){if(i.y<s)return}else i={x:v,y:u};n={x:v,y:s}}}else if(r=(f-p)/(g-h),a=y-r*v,-1>r||r>1)if(f>p){if(i){if(i.y>=u)return}else i={x:(s-a)/r,y:s};n={x:(u-a)/r,y:u}}else{if(i){if(i.y<s)return}else i={x:(u-a)/r,y:u};n={x:(s-a)/r,y:s}}else if(g>h){if(i){if(i.x>=l)return}else i={x:o,y:r*o+a};n={x:l,y:r*l+a}}else{if(i){if(i.x<o)return}else i={x:l,y:r*l+a};n={x:o,y:r*o+a}}return t.a=i,t.b=n,!0}function Jr(t,e){this.l=t,this.r=e,this.a=this.b=null}function Zr(t,e,n,r){var a=new Jr(t,e);return Ws.push(a),n&&Qr(a,t,e,n),r&&Qr(a,e,t,r),$s[t.i].edges.push(new ta(a,t,e)),$s[e.i].edges.push(new ta(a,e,t)),a}function Kr(t,e,n){var r=new Jr(t,null);return r.a=e,r.b=n,Ws.push(r),r}function Qr(t,e,n,r){t.a||t.b?t.l===n?t.b=r:t.a=r:(t.a=r,t.l=e,t.r=n)}function ta(t,e,n){var r=t.a,a=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(a.x-r.x,r.y-a.y):Math.atan2(r.x-a.x,a.y-r.y)}function ea(){this._=null}function na(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ra(t,e){var n=e,r=e.R,a=n.U;a?a.L===n?a.L=r:a.R=r:t._=r,r.U=a,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function aa(t,e){var n=e,r=e.L,a=n.U;a?a.L===n?a.L=r:a.R=r:t._=r,r.U=a,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function ia(t){for(;t.L;)t=t.L;return t}function oa(t,e){var n,r,a,i=t.sort(la).pop();for(Ws=[],$s=new Array(t.length),Js=new ea,Ks=new ea;;)if(a=Zs,i&&(!a||i.y<a.y||i.y===a.y&&i.x<a.x))(i.x!==n||i.y!==r)&&($s[i.i]=new Br(i),Yr(i),n=i.x,r=i.y),i=t.pop();else{if(!a)break;Gr(a.arc)}e&&(Wr(e),Xr(e));var o={cells:$s,edges:Ws};return Js=Ks=Ws=$s=null,o}function la(t,e){return e.y-t.y||e.x-t.x}function sa(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function ua(t){return t.x}function ca(t){return t.y}function da(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fa(t,e,n,r,a,i){if(!t(e,n,r,a,i)){var o=.5*(n+a),l=.5*(r+i),s=e.nodes;s[0]&&fa(t,s[0],n,r,o,l),s[1]&&fa(t,s[1],o,r,a,l),s[2]&&fa(t,s[2],n,l,o,i),s[3]&&fa(t,s[3],o,l,a,i)}}function ha(t,e){t=$o.rgb(t),e=$o.rgb(e);var n=t.r,r=t.g,a=t.b,i=e.r-n,o=e.g-r,l=e.b-a;return function(t){return"#"+xe(Math.round(n+i*t))+xe(Math.round(r+o*t))+xe(Math.round(a+l*t))}}function pa(t,e){var n,r={},a={};for(n in t)n in e?r[n]=ya(t[n],e[n]):a[n]=t[n];for(n in e)n in t||(a[n]=e[n]);return function(t){for(n in r)a[n]=r[n](t);return a}}function ga(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function va(t,e){var n,r,a,i=nu.lastIndex=ru.lastIndex=0,o=-1,l=[],s=[];for(t+="",e+="";(n=nu.exec(t))&&(r=ru.exec(e));)(a=r.index)>i&&(a=e.slice(i,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,s.push({i:o,x:ga(n,r)})),i=ru.lastIndex;return i<e.length&&(a=e.slice(i),l[o]?l[o]+=a:l[++o]=a),l.length<2?s[0]?(e=s[0].x,function(t){return e(t)+""}):function(){return e}:(e=s.length,function(t){for(var n,r=0;e>r;++r)l[(n=s[r]).i]=n.x(t);return l.join("")})}function ya(t,e){for(var n,r=$o.interpolators.length;--r>=0&&!(n=$o.interpolators[r](t,e)););return n}function ma(t,e){var n,r=[],a=[],i=t.length,o=e.length,l=Math.min(t.length,e.length);for(n=0;l>n;++n)r.push(ya(t[n],e[n]));for(;i>n;++n)a[n]=t[n];for(;o>n;++n)a[n]=e[n];return function(t){for(n=0;l>n;++n)a[n]=r[n](t);return a}}function xa(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function ba(t){return function(e){return 1-t(1-e)}}function Aa(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Ma(t){return t*t}function ka(t){return t*t*t}function wa(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Ca(t){return function(e){return Math.pow(e,t)}}function Ta(t){return 1-Math.cos(t*Dl)}function Sa(t){return Math.pow(2,10*(t-1))}function La(t){return 1-Math.sqrt(1-t*t)}function Da(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Ll*Math.asin(1/t):(t=1,n=e/4),function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-n)*Ll/e)}}function Na(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function _a(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Pa(t,e){t=$o.hcl(t),e=$o.hcl(e);var n=t.h,r=t.c,a=t.l,i=e.h-n,o=e.c-r,l=e.l-a;return isNaN(o)&&(o=0,r=isNaN(r)?e.c:r),isNaN(i)?(i=0,n=isNaN(n)?e.h:n):i>180?i-=360:-180>i&&(i+=360),function(t){return ue(n+i*t,r+o*t,a+l*t)+""}}function Ia(t,e){t=$o.hsl(t),e=$o.hsl(e);var n=t.h,r=t.s,a=t.l,i=e.h-n,o=e.s-r,l=e.l-a;return isNaN(o)&&(o=0,r=isNaN(r)?e.s:r),isNaN(i)?(i=0,n=isNaN(n)?e.h:n):i>180?i-=360:-180>i&&(i+=360),function(t){return le(n+i*t,r+o*t,a+l*t)+""}}function Va(t,e){t=$o.lab(t),e=$o.lab(e);var n=t.l,r=t.a,a=t.b,i=e.l-n,o=e.a-r,l=e.b-a;return function(t){return de(n+i*t,r+o*t,a+l*t)+""}}function Fa(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function za(t){var e=[t.a,t.b],n=[t.c,t.d],r=Ga(e),a=Ea(e,n),i=Ga(Ya(n,e,-a))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,r*=-1,a*=-1),this.rotate=(r?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Il,this.translate=[t.e,t.f],this.scale=[r,i],this.skew=i?Math.atan2(a,i)*Il:0}function Ea(t,e){return t[0]*e[0]+t[1]*e[1]}function Ga(t){var e=Math.sqrt(Ea(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Ya(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Ra(t,e){var n,r=[],a=[],i=$o.transform(t),o=$o.transform(e),l=i.translate,s=o.translate,u=i.rotate,c=o.rotate,d=i.skew,f=o.skew,h=i.scale,p=o.scale;return l[0]!=s[0]||l[1]!=s[1]?(r.push("translate(",null,",",null,")"),a.push({i:1,x:ga(l[0],s[0])},{i:3,x:ga(l[1],s[1])})):r.push(s[0]||s[1]?"translate("+s+")":""),u!=c?(u-c>180?c+=360:c-u>180&&(u+=360),a.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:ga(u,c)})):c&&r.push(r.pop()+"rotate("+c+")"),d!=f?a.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:ga(d,f)}):f&&r.push(r.pop()+"skewX("+f+")"),h[0]!=p[0]||h[1]!=p[1]?(n=r.push(r.pop()+"scale(",null,",",null,")"),a.push({i:n-4,x:ga(h[0],p[0])},{i:n-2,x:ga(h[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),n=a.length,function(t){for(var e,i=-1;++i<n;)r[(e=a[i]).i]=e.x(t);return r.join("")}}function Oa(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Ba(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Xa(t){for(var e=t.source,n=t.target,r=Ua(e,n),a=[e];e!==r;)e=e.parent,a.push(e);for(var i=a.length;n!==r;)a.splice(i,0,n),n=n.parent;return a}function qa(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Ua(t,e){if(t===e)return t;for(var n=qa(t),r=qa(e),a=n.pop(),i=r.pop(),o=null;a===i;)o=a,a=n.pop(),i=r.pop();return o}function ja(t){t.fixed|=2}function Ha(t){t.fixed&=-7}function Wa(t){t.fixed|=4,t.px=t.x,t.py=t.y}function $a(t){t.fixed&=-5}function Ja(t,e,n){var r=0,a=0;if(t.charge=0,!t.leaf)for(var i,o=t.nodes,l=o.length,s=-1;++s<l;)i=o[s],null!=i&&(Ja(i,e,n),t.charge+=i.charge,r+=i.charge*i.cx,a+=i.charge*i.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*n[t.point.index];t.charge+=t.pointCharge=u,r+=u*t.point.x,a+=u*t.point.y}t.cx=r/t.charge,t.cy=a/t.charge}function Za(t,e){return $o.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=ri,t}function Ka(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(a=t.children)&&(r=a.length))for(var r,a;--r>=0;)n.push(a[r])}function Qa(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(i=t.children)&&(a=i.length))for(var a,i,o=-1;++o<a;)n.push(i[o]);for(;null!=(t=r.pop());)e(t)}function ti(t){return t.children}function ei(t){return t.value}function ni(t,e){return e.value-t.value}function ri(t){return $o.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function ai(t){return t.x}function ii(t){return t.y}function oi(t,e,n){t.y0=e,t.y=n}function li(t){return $o.range(t.length)}function si(t){for(var e=-1,n=t[0].length,r=[];++e<n;)r[e]=0;return r}function ui(t){for(var e,n=1,r=0,a=t[0][1],i=t.length;i>n;++n)(e=t[n][1])>a&&(r=n,a=e);return r}function ci(t){return t.reduce(di,0)}function di(t,e){return t+e[1]}function fi(t,e){return hi(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function hi(t,e){for(var n=-1,r=+t[0],a=(t[1]-r)/e,i=[];++n<=e;)i[n]=a*n+r;return i}function pi(t){return[$o.min(t),$o.max(t)]}function gi(t,e){return t.value-e.value}function vi(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function yi(t,e){t._pack_next=e,e._pack_prev=t}function mi(t,e){var n=e.x-t.x,r=e.y-t.y,a=t.r+e.r;return.999*a*a>n*n+r*r}function xi(t){function e(t){c=Math.min(t.x-t.r,c),d=Math.max(t.x+t.r,d),f=Math.min(t.y-t.r,f),h=Math.max(t.y+t.r,h)}if((n=t.children)&&(u=n.length)){var n,r,a,i,o,l,s,u,c=1/0,d=-1/0,f=1/0,h=-1/0;if(n.forEach(bi),r=n[0],r.x=-r.r,r.y=0,e(r),u>1&&(a=n[1],a.x=a.r,a.y=0,e(a),u>2))for(i=n[2],ki(r,a,i),e(i),vi(r,i),r._pack_prev=i,vi(i,a),a=r._pack_next,o=3;u>o;o++){ki(r,a,i=n[o]);var p=0,g=1,v=1;for(l=a._pack_next;l!==a;l=l._pack_next,g++)if(mi(l,i)){p=1;break}if(1==p)for(s=r._pack_prev;s!==l._pack_prev&&!mi(s,i);s=s._pack_prev,v++);p?(v>g||g==v&&a.r<r.r?yi(r,a=l):yi(r=s,a),o--):(vi(r,i),a=i,e(i))}var y=(c+d)/2,m=(f+h)/2,x=0;for(o=0;u>o;o++)i=n[o],i.x-=y,i.y-=m,x=Math.max(x,i.r+Math.sqrt(i.x*i.x+i.y*i.y));t.r=x,n.forEach(Ai)}}function bi(t){t._pack_next=t._pack_prev=t}function Ai(t){delete t._pack_next,delete t._pack_prev}function Mi(t,e,n,r){var a=t.children;if(t.x=e+=r*t.x,t.y=n+=r*t.y,t.r*=r,a)for(var i=-1,o=a.length;++i<o;)Mi(a[i],e,n,r)}function ki(t,e,n){var r=t.r+n.r,a=e.x-t.x,i=e.y-t.y;if(r&&(a||i)){var o=e.r+n.r,l=a*a+i*i;o*=o,r*=r;var s=.5+(r-o)/(2*l),u=Math.sqrt(Math.max(0,2*o*(r+l)-(r-=l)*r-o*o))/(2*l);n.x=t.x+s*a+u*i,n.y=t.y+s*i-u*a}else n.x=t.x+r,n.y=t.y}function wi(t,e){return t.parent==e.parent?1:2}function Ci(t){var e=t.children;return e.length?e[0]:t.t}function Ti(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function Si(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Li(t){for(var e,n=0,r=0,a=t.children,i=a.length;--i>=0;)e=a[i],e.z+=n,e.m+=n,n+=e.s+(r+=e.c)}function Di(t,e,n){return t.a.parent===e.parent?t.a:n}function Ni(t){return 1+$o.max(t,function(t){return t.y})}function _i(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Pi(t){var e=t.children;return e&&e.length?Pi(e[0]):t}function Ii(t){var e,n=t.children;return n&&(e=n.length)?Ii(n[e-1]):t}function Vi(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Fi(t,e){var n=t.x+e[3],r=t.y+e[0],a=t.dx-e[1]-e[3],i=t.dy-e[0]-e[2];return 0>a&&(n+=a/2,a=0),0>i&&(r+=i/2,i=0),{x:n,y:r,dx:a,dy:i}}function zi(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Ei(t){return t.rangeExtent?t.rangeExtent():zi(t.range())}function Gi(t,e,n,r){var a=n(t[0],t[1]),i=r(e[0],e[1]);return function(t){return i(a(t))}}function Yi(t,e){var n,r=0,a=t.length-1,i=t[r],o=t[a];return i>o&&(n=r,r=a,a=n,n=i,i=o,o=n),t[r]=e.floor(i),t[a]=e.ceil(o),t}function Ri(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:pu}function Oi(t,e,n,r){var a=[],i=[],o=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<=l;)a.push(n(t[o-1],t[o])),i.push(r(e[o-1],e[o]));return function(e){var n=$o.bisect(t,e,1,l)-1;return i[n](a[n](e))}}function Bi(t,e,n,r){function a(){var a=Math.min(t.length,e.length)>2?Oi:Gi,s=r?Ba:Oa;return o=a(t,e,s,n),l=a(e,t,s,ya),i}function i(t){return o(t)}var o,l;return i.invert=function(t){return l(t)},i.domain=function(e){return arguments.length?(t=e.map(Number),a()):t},i.range=function(t){return arguments.length?(e=t,a()):e},i.rangeRound=function(t){return i.range(t).interpolate(Fa)},i.clamp=function(t){return arguments.length?(r=t,a()):r},i.interpolate=function(t){return arguments.length?(n=t,a()):n},i.ticks=function(e){return ji(t,e)},i.tickFormat=function(e,n){return Hi(t,e,n)},i.nice=function(e){return qi(t,e),a()},i.copy=function(){return Bi(t,e,n,r)},a()}function Xi(t,e){return $o.rebind(t,e,"range","rangeRound","interpolate","clamp")}function qi(t,e){return Yi(t,Ri(Ui(t,e)[2]))}function Ui(t,e){null==e&&(e=10);var n=zi(t),r=n[1]-n[0],a=Math.pow(10,Math.floor(Math.log(r/e)/Math.LN10)),i=e/r*a;return.15>=i?a*=10:.35>=i?a*=5:.75>=i&&(a*=2),n[0]=Math.ceil(n[0]/a)*a,n[1]=Math.floor(n[1]/a)*a+.5*a,n[2]=a,n}function ji(t,e){return $o.range.apply($o,Ui(t,e))}function Hi(t,e,n){var r=Ui(t,e);if(n){var a=ns.exec(n);if(a.shift(),"s"===a[8]){var i=$o.formatPrefix(Math.max(ul(r[0]),ul(r[1])));return a[7]||(a[7]="."+Wi(i.scale(r[2]))),a[8]="f",n=$o.format(a.join("")),function(t){return n(i.scale(t))+i.symbol}}a[7]||(a[7]="."+$i(a[8],r)),n=a.join("")}else n=",."+Wi(r[2])+"f";return $o.format(n)}function Wi(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function $i(t,e){var n=Wi(e[2]);return t in gu?Math.abs(n-Wi(Math.max(ul(e[0]),ul(e[1]))))+ +("e"!==t):n-2*("%"===t)}function Ji(t,e,n,r){function a(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function i(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function o(e){return t(a(e))}return o.invert=function(e){return i(t.invert(e))},o.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((r=e.map(Number)).map(a)),o):r},o.base=function(n){return arguments.length?(e=+n,t.domain(r.map(a)),o):e},o.nice=function(){var e=Yi(r.map(a),n?Math:yu);return t.domain(e),r=e.map(i),o},o.ticks=function(){var t=zi(r),o=[],l=t[0],s=t[1],u=Math.floor(a(l)),c=Math.ceil(a(s)),d=e%1?2:e;if(isFinite(c-u)){if(n){for(;c>u;u++)for(var f=1;d>f;f++)o.push(i(u)*f);o.push(i(u))}else for(o.push(i(u));u++<c;)for(var f=d-1;f>0;f--)o.push(i(u)*f);for(u=0;o[u]<l;u++);for(c=o.length;o[c-1]>s;c--);o=o.slice(u,c)}return o},o.tickFormat=function(t,e){if(!arguments.length)return vu;arguments.length<2?e=vu:"function"!=typeof e&&(e=$o.format(e));var r,l=Math.max(.1,t/o.ticks().length),s=n?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(t){return t/i(s(a(t)+r))<=l?e(t):""}},o.copy=function(){return Ji(t.copy(),e,n,r)},Xi(o,t)}function Zi(t,e,n){function r(e){return t(a(e))}var a=Ki(e),i=Ki(1/e);return r.invert=function(e){return i(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(a)),r):n},r.ticks=function(t){return ji(n,t)},r.tickFormat=function(t,e){return Hi(n,t,e)},r.nice=function(t){return r.domain(qi(n,t))},r.exponent=function(o){return arguments.length?(a=Ki(e=o),i=Ki(1/e),t.domain(n.map(a)),r):e},r.copy=function(){return Zi(t.copy(),e,n)},Xi(r,t)}function Ki(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function Qi(t,e){function n(n){return i[((a.get(n)||("range"===e.t?a.set(n,t.push(n)):0/0))-1)%i.length]}function r(e,n){return $o.range(t.length).map(function(t){return e+n*t})}var a,i,o;return n.domain=function(r){if(!arguments.length)return t;t=[],a=new l;for(var i,o=-1,s=r.length;++o<s;)a.has(i=r[o])||a.set(i,t.push(i));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(i=t,o=0,e={t:"range",a:arguments},n):i},n.rangePoints=function(a,l){arguments.length<2&&(l=0);var s=a[0],u=a[1],c=(u-s)/(Math.max(1,t.length-1)+l);return i=r(t.length<2?(s+u)/2:s+c*l/2,c),o=0,e={t:"rangePoints",a:arguments},n},n.rangeBands=function(a,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=a[1]<a[0],c=a[u-0],d=a[1-u],f=(d-c)/(t.length-l+2*s);return i=r(c+f*s,f),u&&i.reverse(),o=f*(1-l),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(a,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=a[1]<a[0],c=a[u-0],d=a[1-u],f=Math.floor((d-c)/(t.length-l+2*s)),h=d-c-(t.length-l)*f;return i=r(c+Math.round(h/2),f),u&&i.reverse(),o=Math.round(f*(1-l)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return o},n.rangeExtent=function(){return zi(e.a[0])},n.copy=function(){return Qi(t,e)},n.domain(t)}function to(r,a){function i(){var t=0,e=a.length;for(l=[];++t<e;)l[t-1]=$o.quantile(r,t/e);return o}function o(t){return isNaN(t=+t)?void 0:a[$o.bisect(l,t)]}var l;return o.domain=function(a){return arguments.length?(r=a.map(e).filter(n).sort(t),i()):r},o.range=function(t){return arguments.length?(a=t,i()):a},o.quantiles=function(){return l},o.invertExtent=function(t){return t=a.indexOf(t),0>t?[0/0,0/0]:[t>0?l[t-1]:r[0],t<l.length?l[t]:r[r.length-1]]},o.copy=function(){return to(r,a)},i()}function eo(t,e,n){function r(e){return n[Math.max(0,Math.min(o,Math.floor(i*(e-t))))]}function a(){return i=n.length/(e-t),o=n.length-1,r}var i,o;return r.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],a()):[t,e]},r.range=function(t){return arguments.length?(n=t,a()):n},r.invertExtent=function(e){return e=n.indexOf(e),e=0>e?0/0:e/i+t,[e,e+1/i]},r.copy=function(){return eo(t,e,n)},a()}function no(t,e){function n(n){return n>=n?e[$o.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return no(t,e)},n}function ro(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return ji(t,e)},e.tickFormat=function(e,n){return Hi(t,e,n)},e.copy=function(){return ro(t)},e}function ao(t){return t.innerRadius}function io(t){return t.outerRadius}function oo(t){return t.startAngle}function lo(t){return t.endAngle}function so(t){function e(e){function o(){u.push("M",i(t(c),l))}for(var s,u=[],c=[],d=-1,f=e.length,h=Ce(n),p=Ce(r);++d<f;)a.call(this,s=e[d],d)?c.push([+h.call(this,s,d),+p.call(this,s,d)]):c.length&&(o(),c=[]);return c.length&&o(),u.length?u.join(""):null}var n=Lr,r=Dr,a=Ln,i=uo,o=i.key,l=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(o="function"==typeof t?i=t:(i=wu.get(t)||uo).key,e):o},e.tension=function(t){return arguments.length?(l=t,e):l},e}function uo(t){return t.join("L")}function co(t){return uo(t)+"Z"}function fo(t){for(var e=0,n=t.length,r=t[0],a=[r[0],",",r[1]];++e<n;)a.push("H",(r[0]+(r=t[e])[0])/2,"V",r[1]);return n>1&&a.push("H",r[0]),a.join("")}function ho(t){for(var e=0,n=t.length,r=t[0],a=[r[0],",",r[1]];++e<n;)a.push("V",(r=t[e])[1],"H",r[0]);return a.join("")}function po(t){for(var e=0,n=t.length,r=t[0],a=[r[0],",",r[1]];++e<n;)a.push("H",(r=t[e])[0],"V",r[1]);return a.join("")}function go(t,e){return t.length<4?uo(t):t[1]+mo(t.slice(1,t.length-1),xo(t,e))}function vo(t,e){return t.length<3?uo(t):t[0]+mo((t.push(t[0]),t),xo([t[t.length-2]].concat(t,[t[1]]),e))}function yo(t,e){return t.length<3?uo(t):t[0]+mo(t,xo(t,e))}function mo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return uo(t);var n=t.length!=e.length,r="",a=t[0],i=t[1],o=e[0],l=o,s=1;if(n&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],a=t[1],s=2),e.length>1){l=e[1],i=t[s],s++,r+="C"+(a[0]+o[0])+","+(a[1]+o[1])+","+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1];for(var u=2;u<e.length;u++,s++)i=t[s],l=e[u],r+="S"+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1]}if(n){var c=t[s];r+="Q"+(i[0]+2*l[0]/3)+","+(i[1]+2*l[1]/3)+","+c[0]+","+c[1]}return r}function xo(t,e){for(var n,r=[],a=(1-e)/2,i=t[0],o=t[1],l=1,s=t.length;++l<s;)n=i,i=o,o=t[l],r.push([a*(o[0]-n[0]),a*(o[1]-n[1])]);return r}function bo(t){if(t.length<3)return uo(t);var e=1,n=t.length,r=t[0],a=r[0],i=r[1],o=[a,a,a,(r=t[1])[0]],l=[i,i,i,r[1]],s=[a,",",i,"L",wo(Su,o),",",wo(Su,l)];for(t.push(t[n-1]);++e<=n;)r=t[e],o.shift(),o.push(r[0]),l.shift(),l.push(r[1]),Co(s,o,l);return t.pop(),s.push("L",r),s.join("")}function Ao(t){if(t.length<4)return uo(t);for(var e,n=[],r=-1,a=t.length,i=[0],o=[0];++r<3;)e=t[r],i.push(e[0]),o.push(e[1]);for(n.push(wo(Su,i)+","+wo(Su,o)),--r;++r<a;)e=t[r],i.shift(),i.push(e[0]),o.shift(),o.push(e[1]),Co(n,i,o);return n.join("")}function Mo(t){for(var e,n,r=-1,a=t.length,i=a+4,o=[],l=[];++r<4;)n=t[r%a],o.push(n[0]),l.push(n[1]);for(e=[wo(Su,o),",",wo(Su,l)],--r;++r<i;)n=t[r%a],o.shift(),o.push(n[0]),l.shift(),l.push(n[1]),Co(e,o,l);return e.join("")}function ko(t,e){var n=t.length-1;if(n)for(var r,a,i=t[0][0],o=t[0][1],l=t[n][0]-i,s=t[n][1]-o,u=-1;++u<=n;)r=t[u],a=u/n,r[0]=e*r[0]+(1-e)*(i+a*l),r[1]=e*r[1]+(1-e)*(o+a*s);return bo(t)}function wo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Co(t,e,n){t.push("C",wo(Cu,e),",",wo(Cu,n),",",wo(Tu,e),",",wo(Tu,n),",",wo(Su,e),",",wo(Su,n))}function To(t,e){return(e[1]-t[1])/(e[0]-t[0])}function So(t){for(var e=0,n=t.length-1,r=[],a=t[0],i=t[1],o=r[0]=To(a,i);++e<n;)r[e]=(o+(o=To(a=i,i=t[e+1])))/2;return r[e]=o,r}function Lo(t){for(var e,n,r,a,i=[],o=So(t),l=-1,s=t.length-1;++l<s;)e=To(t[l],t[l+1]),ul(e)<Nl?o[l]=o[l+1]=0:(n=o[l]/e,r=o[l+1]/e,a=n*n+r*r,a>9&&(a=3*e/Math.sqrt(a),o[l]=a*n,o[l+1]=a*r));for(l=-1;++l<=s;)a=(t[Math.min(s,l+1)][0]-t[Math.max(0,l-1)][0])/(6*(1+o[l]*o[l])),i.push([a||0,o[l]*a||0]);return i}function Do(t){return t.length<3?uo(t):t[0]+mo(t,Lo(t))}function No(t){for(var e,n,r,a=-1,i=t.length;++a<i;)e=t[a],n=e[0],r=e[1]+Mu,e[0]=n*Math.cos(r),e[1]=n*Math.sin(r);return t}function _o(t){function e(e){function s(){g.push("M",l(t(y),d),c,u(t(v.reverse()),d),"Z")}for(var f,h,p,g=[],v=[],y=[],m=-1,x=e.length,b=Ce(n),A=Ce(a),M=n===r?function(){return h}:Ce(r),k=a===i?function(){return p}:Ce(i);++m<x;)o.call(this,f=e[m],m)?(v.push([h=+b.call(this,f,m),p=+A.call(this,f,m)]),y.push([+M.call(this,f,m),+k.call(this,f,m)])):v.length&&(s(),v=[],y=[]);return v.length&&s(),g.length?g.join(""):null}var n=Lr,r=Lr,a=0,i=Dr,o=Ln,l=uo,s=l.key,u=l,c="L",d=.7;return e.x=function(t){return arguments.length?(n=r=t,e):r},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(a=i=t,e):i},e.y0=function(t){return arguments.length?(a=t,e):a},e.y1=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(o=t,e):o},e.interpolate=function(t){return arguments.length?(s="function"==typeof t?l=t:(l=wu.get(t)||uo).key,u=l.reverse||l,c=l.closed?"M":"L",e):s},e.tension=function(t){return arguments.length?(d=t,e):d},e}function Po(t){return t.radius}function Io(t){return[t.x,t.y]}function Vo(t){return function(){var e=t.apply(this,arguments),n=e[0],r=e[1]+Mu;return[n*Math.cos(r),n*Math.sin(r)]}}function Fo(){return 64
}function zo(){return"circle"}function Eo(t){var e=Math.sqrt(t/Sl);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Go(t,e){return pl(t,Iu),t.id=e,t}function Yo(t,e,n,r){var a=t.id;return Y(t,"function"==typeof n?function(t,i,o){t.__transition__[a].tween.set(e,r(n.call(t,t.__data__,i,o)))}:(n=r(n),function(t){t.__transition__[a].tween.set(e,n)}))}function Ro(t){return null==t&&(t=""),function(){this.textContent=t}}function Oo(t,e,n,r){var a=t.__transition__||(t.__transition__={active:0,count:0}),i=a[n];if(!i){var o=r.time;i=a[n]={tween:new l,time:o,ease:r.ease,delay:r.delay,duration:r.duration},++a.count,$o.timer(function(r){function l(r){return a.active>n?u():(a.active=n,i.event&&i.event.start.call(t,c,e),i.tween.forEach(function(n,r){(r=r.call(t,c,e))&&g.push(r)}),void $o.timer(function(){return p.c=s(r||1)?Ln:s,1},0,o))}function s(r){if(a.active!==n)return u();for(var o=r/h,l=d(o),s=g.length;s>0;)g[--s].call(t,l);return o>=1?(i.event&&i.event.end.call(t,c,e),u()):void 0}function u(){return--a.count?delete a[n]:delete t.__transition__,1}var c=t.__data__,d=i.ease,f=i.delay,h=i.duration,p=Ql,g=[];return p.t=f+o,r>=f?l(r-f):void(p.c=l)},0,o)}}function Bo(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate("+(isFinite(r)?r:n(t))+",0)"})}function Xo(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate(0,"+(isFinite(r)?r:n(t))+")"})}function qo(t){return t.toISOString()}function Uo(t,e,n){function r(e){return t(e)}function a(t,n){var r=t[1]-t[0],a=r/n,i=$o.bisect(Bu,a);return i==Bu.length?[e.year,Ui(t.map(function(t){return t/31536e6}),n)[2]]:i?e[a/Bu[i-1]<Bu[i]/a?i-1:i]:[Uu,Ui(t,n)[2]]}return r.invert=function(e){return jo(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e),r):t.domain().map(jo)},r.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,jo(+n+1),e).length}var i=r.domain(),o=zi(i),l=null==t?a(o,10):"number"==typeof t&&a(o,t);return l&&(t=l[0],e=l[1]),r.domain(Yi(i,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=jo(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=jo(+e+1);return e}}:t))},r.ticks=function(t,e){var n=zi(r.domain()),i=null==t?a(n,10):"number"==typeof t?a(n,t):!t.range&&[{range:t},e];return i&&(t=i[0],e=i[1]),t.range(n[0],jo(+n[1]+1),1>e?1:e)},r.tickFormat=function(){return n},r.copy=function(){return Uo(t.copy(),e,n)},Xi(r,t)}function jo(t){return new Date(t)}function Ho(t){return JSON.parse(t.responseText)}function Wo(t){var e=Ko.createRange();return e.selectNode(Ko.body),e.createContextualFragment(t.responseText)}var $o={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var Jo=[].slice,Zo=function(t){return Jo.call(t)},Ko=document,Qo=Ko.documentElement,tl=window;try{Zo(Qo.childNodes)[0].nodeType}catch(el){Zo=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}try{Ko.createElement("div").style.setProperty("opacity",0,"")}catch(nl){var rl=tl.Element.prototype,al=rl.setAttribute,il=rl.setAttributeNS,ol=tl.CSSStyleDeclaration.prototype,ll=ol.setProperty;rl.setAttribute=function(t,e){al.call(this,t,e+"")},rl.setAttributeNS=function(t,e,n){il.call(this,t,e,n+"")},ol.setProperty=function(t,e,n){ll.call(this,t,e+"",n)}}$o.ascending=t,$o.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},$o.min=function(t,e){var n,r,a=-1,i=t.length;if(1===arguments.length){for(;++a<i&&!(null!=(n=t[a])&&n>=n);)n=void 0;for(;++a<i;)null!=(r=t[a])&&n>r&&(n=r)}else{for(;++a<i&&!(null!=(n=e.call(t,t[a],a))&&n>=n);)n=void 0;for(;++a<i;)null!=(r=e.call(t,t[a],a))&&n>r&&(n=r)}return n},$o.max=function(t,e){var n,r,a=-1,i=t.length;if(1===arguments.length){for(;++a<i&&!(null!=(n=t[a])&&n>=n);)n=void 0;for(;++a<i;)null!=(r=t[a])&&r>n&&(n=r)}else{for(;++a<i&&!(null!=(n=e.call(t,t[a],a))&&n>=n);)n=void 0;for(;++a<i;)null!=(r=e.call(t,t[a],a))&&r>n&&(n=r)}return n},$o.extent=function(t,e){var n,r,a,i=-1,o=t.length;if(1===arguments.length){for(;++i<o&&!(null!=(n=a=t[i])&&n>=n);)n=a=void 0;for(;++i<o;)null!=(r=t[i])&&(n>r&&(n=r),r>a&&(a=r))}else{for(;++i<o&&!(null!=(n=a=e.call(t,t[i],i))&&n>=n);)n=void 0;for(;++i<o;)null!=(r=e.call(t,t[i],i))&&(n>r&&(n=r),r>a&&(a=r))}return[n,a]},$o.sum=function(t,e){var r,a=0,i=t.length,o=-1;if(1===arguments.length)for(;++o<i;)n(r=+t[o])&&(a+=r);else for(;++o<i;)n(r=+e.call(t,t[o],o))&&(a+=r);return a},$o.mean=function(t,r){var a,i=0,o=t.length,l=-1,s=o;if(1===arguments.length)for(;++l<o;)n(a=e(t[l]))?i+=a:--s;else for(;++l<o;)n(a=e(r.call(t,t[l],l)))?i+=a:--s;return s?i/s:void 0},$o.quantile=function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),a=+t[r-1],i=n-r;return i?a+i*(t[r]-a):a},$o.median=function(r,a){var i,o=[],l=r.length,s=-1;if(1===arguments.length)for(;++s<l;)n(i=e(r[s]))&&o.push(i);else for(;++s<l;)n(i=e(a.call(r,r[s],s)))&&o.push(i);return o.length?$o.quantile(o.sort(t),.5):void 0};var sl=r(t);$o.bisectLeft=sl.left,$o.bisect=$o.bisectRight=sl.right,$o.bisector=function(e){return r(1===e.length?function(n,r){return t(e(n),r)}:e)},$o.shuffle=function(t){for(var e,n,r=t.length;r;)n=0|Math.random()*r--,e=t[r],t[r]=t[n],t[n]=e;return t},$o.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},$o.pairs=function(t){for(var e,n=0,r=t.length-1,a=t[0],i=new Array(0>r?0:r);r>n;)i[n]=[e=a,a=t[++n]];return i},$o.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,e=$o.min(arguments,a),n=new Array(e);++t<e;)for(var r,i=-1,o=n[t]=new Array(r);++i<r;)o[i]=arguments[i][t];return n},$o.transpose=function(t){return $o.zip.apply($o,t)},$o.keys=function(t){var e=[];for(var n in t)e.push(n);return e},$o.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},$o.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},$o.merge=function(t){for(var e,n,r,a=t.length,i=-1,o=0;++i<a;)o+=t[i].length;for(n=new Array(o);--a>=0;)for(r=t[a],e=r.length;--e>=0;)n[--o]=r[e];return n};var ul=Math.abs;$o.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),1/0===(e-t)/n)throw new Error("infinite range");var r,a=[],o=i(ul(n)),l=-1;if(t*=o,e*=o,n*=o,0>n)for(;(r=t+n*++l)>e;)a.push(r/o);else for(;(r=t+n*++l)<e;)a.push(r/o);return a},$o.map=function(t){var e=new l;if(t instanceof l)t.forEach(function(t,n){e.set(t,n)});else for(var n in t)e.set(n,t[n]);return e};var cl="__proto__",dl="\x00";o(l,{has:c,get:function(t){return this._[s(t)]},set:function(t,e){return this._[s(t)]=e},remove:d,keys:f,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:u(e),value:this._[e]});return t},size:h,empty:p,forEach:function(t){for(var e in this._)t.call(this,u(e),this._[e])}}),$o.nest=function(){function t(e,o,s){if(s>=i.length)return r?r.call(a,o):n?o.sort(n):o;for(var u,c,d,f,h=-1,p=o.length,g=i[s++],v=new l;++h<p;)(f=v.get(u=g(c=o[h])))?f.push(c):v.set(u,[c]);return e?(c=e(),d=function(n,r){c.set(n,t(e,r,s))}):(c={},d=function(n,r){c[n]=t(e,r,s)}),v.forEach(d),c}function e(t,n){if(n>=i.length)return t;var r=[],a=o[n++];return t.forEach(function(t,a){r.push({key:t,values:e(a,n)})}),a?r.sort(function(t,e){return a(t.key,e.key)}):r}var n,r,a={},i=[],o=[];return a.map=function(e,n){return t(n,e,0)},a.entries=function(n){return e(t($o.map,n,0),0)},a.key=function(t){return i.push(t),a},a.sortKeys=function(t){return o[i.length-1]=t,a},a.sortValues=function(t){return n=t,a},a.rollup=function(t){return r=t,a},a},$o.set=function(t){var e=new g;if(t)for(var n=0,r=t.length;r>n;++n)e.add(t[n]);return e},o(g,{has:c,add:function(t){return this._[s(t+="")]=!0,t},remove:d,values:f,size:h,empty:p,forEach:function(t){for(var e in this._)t.call(this,u(e))}}),$o.behavior={},$o.rebind=function(t,e){for(var n,r=1,a=arguments.length;++r<a;)t[n=arguments[r]]=v(t,e,e[n]);return t};var fl=["webkit","ms","moz","Moz","o","O"];$o.dispatch=function(){for(var t=new x,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=b(t);return t},x.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},$o.event=null,$o.requote=function(t){return t.replace(hl,"\\$&")};var hl=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,pl={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},gl=function(t,e){return e.querySelector(t)},vl=function(t,e){return e.querySelectorAll(t)},yl=Qo.matches||Qo[y(Qo,"matchesSelector")],ml=function(t,e){return yl.call(t,e)};"function"==typeof Sizzle&&(gl=function(t,e){return Sizzle(t,e)[0]||null},vl=Sizzle,ml=Sizzle.matchesSelector),$o.selection=function(){return Ml};var xl=$o.selection.prototype=[];xl.select=function(t){var e,n,r,a,i=[];t=C(t);for(var o=-1,l=this.length;++o<l;){i.push(e=[]),e.parentNode=(r=this[o]).parentNode;for(var s=-1,u=r.length;++s<u;)(a=r[s])?(e.push(n=t.call(a,a.__data__,s,o)),n&&"__data__"in a&&(n.__data__=a.__data__)):e.push(null)}return w(i)},xl.selectAll=function(t){var e,n,r=[];t=T(t);for(var a=-1,i=this.length;++a<i;)for(var o=this[a],l=-1,s=o.length;++l<s;)(n=o[l])&&(r.push(e=Zo(t.call(n,n.__data__,l,a))),e.parentNode=n);return w(r)};var bl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};$o.ns={prefix:bl,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.slice(0,e),t=t.slice(e+1)),bl.hasOwnProperty(n)?{space:bl[n],local:t}:t}},xl.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=$o.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(S(e,t[e]));return this}return this.each(S(t,e))},xl.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=N(t)).length,a=-1;if(e=n.classList){for(;++a<r;)if(!e.contains(t[a]))return!1}else for(e=n.getAttribute("class");++a<r;)if(!D(t[a]).test(e))return!1;return!0}for(e in t)this.each(_(e,t[e]));return this}return this.each(_(t,e))},xl.style=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e="");for(n in t)this.each(I(n,t[n],e));return this}if(2>r)return tl.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(I(t,e,n))},xl.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(V(e,t[e]));return this}return this.each(V(t,e))},xl.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},xl.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},xl.append=function(t){return t=F(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},xl.insert=function(t,e){return t=F(t),e=C(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},xl.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},xl.data=function(t,e){function n(t,n){var r,a,i,o=t.length,d=n.length,f=Math.min(o,d),h=new Array(d),p=new Array(d),g=new Array(o);if(e){var v,y=new l,m=new Array(o);for(r=-1;++r<o;)y.has(v=e.call(a=t[r],a.__data__,r))?g[r]=a:y.set(v,a),m[r]=v;for(r=-1;++r<d;)(a=y.get(v=e.call(n,i=n[r],r)))?a!==!0&&(h[r]=a,a.__data__=i):p[r]=z(i),y.set(v,!0);for(r=-1;++r<o;)y.get(m[r])!==!0&&(g[r]=t[r])}else{for(r=-1;++r<f;)a=t[r],i=n[r],a?(a.__data__=i,h[r]=a):p[r]=z(i);for(;d>r;++r)p[r]=z(n[r]);for(;o>r;++r)g[r]=t[r]}p.update=h,p.parentNode=h.parentNode=g.parentNode=t.parentNode,s.push(p),u.push(h),c.push(g)}var r,a,i=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(r=this[0]).length);++i<o;)(a=r[i])&&(t[i]=a.__data__);return t}var s=R([]),u=w([]),c=w([]);if("function"==typeof t)for(;++i<o;)n(r=this[i],t.call(r,r.parentNode.__data__,i));else for(;++i<o;)n(r=this[i],t);return u.enter=function(){return s},u.exit=function(){return c},u},xl.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},xl.filter=function(t){var e,n,r,a=[];"function"!=typeof t&&(t=E(t));for(var i=0,o=this.length;o>i;i++){a.push(e=[]),e.parentNode=(n=this[i]).parentNode;for(var l=0,s=n.length;s>l;l++)(r=n[l])&&t.call(r,r.__data__,l,i)&&e.push(r)}return w(a)},xl.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],a=r.length-1,i=r[a];--a>=0;)(n=r[a])&&(i&&i!==n.nextSibling&&i.parentNode.insertBefore(n,i),i=n);return this},xl.sort=function(t){t=G.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},xl.each=function(t){return Y(this,function(e,n,r){t.call(e,e.__data__,n,r)})},xl.call=function(t){var e=Zo(arguments);return t.apply(e[0]=this,e),this},xl.empty=function(){return!this.node()},xl.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],r=0,a=n.length;a>r;r++){var i=n[r];if(i)return i}return null},xl.size=function(){var t=0;return Y(this,function(){++t}),t};var Al=[];$o.selection.enter=R,$o.selection.enter.prototype=Al,Al.append=xl.append,Al.empty=xl.empty,Al.node=xl.node,Al.call=xl.call,Al.size=xl.size,Al.select=function(t){for(var e,n,r,a,i,o=[],l=-1,s=this.length;++l<s;){r=(a=this[l]).update,o.push(e=[]),e.parentNode=a.parentNode;for(var u=-1,c=a.length;++u<c;)(i=a[u])?(e.push(r[u]=n=t.call(a.parentNode,i.__data__,u,l)),n.__data__=i.__data__):e.push(null)}return w(o)},Al.insert=function(t,e){return arguments.length<2&&(e=O(this)),xl.insert.call(this,t,e)},xl.transition=function(){for(var t,e,n=Du||++Vu,r=[],a=Nu||{time:Date.now(),ease:wa,delay:0,duration:250},i=-1,o=this.length;++i<o;){r.push(t=[]);for(var l=this[i],s=-1,u=l.length;++s<u;)(e=l[s])&&Oo(e,s,n,a),t.push(e)}return Go(r,n)},xl.interrupt=function(){return this.each(B)},$o.select=function(t){var e=["string"==typeof t?gl(t,Ko):t];return e.parentNode=Qo,w([e])},$o.selectAll=function(t){var e=Zo("string"==typeof t?vl(t,Ko):t);return e.parentNode=Qo,w([e])};var Ml=$o.select(Qo);xl.on=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e=!1);for(n in t)this.each(X(n,t[n],e));return this}if(2>r)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(X(t,e,n))};var kl=$o.map({mouseenter:"mouseover",mouseleave:"mouseout"});kl.forEach(function(t){"on"+t in Ko&&kl.remove(t)});var wl="onselectstart"in Ko?null:y(Qo.style,"userSelect"),Cl=0;$o.mouse=function(t){return H(t,M())};var Tl=/WebKit/.test(tl.navigator.userAgent)?-1:0;$o.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=M().changedTouches),e)for(var r,a=0,i=e.length;i>a;++a)if((r=e[a]).identifier===n)return H(t,r)},$o.behavior.drag=function(){function t(){this.on("mousedown.drag",a).on("touchstart.drag",i)}function e(t,e,a,i,o){return function(){function l(){var t,n,r=e(f,g);r&&(t=r[0]-x[0],n=r[1]-x[1],p|=t|n,x=r,h({type:"drag",x:r[0]+u[0],y:r[1]+u[1],dx:t,dy:n}))}function s(){e(f,g)&&(y.on(i+v,null).on(o+v,null),m(p&&$o.event.target===d),h({type:"dragend"}))}var u,c=this,d=$o.event.target,f=c.parentNode,h=n.of(c,arguments),p=0,g=t(),v=".drag"+(null==g?"":"-"+g),y=$o.select(a()).on(i+v,l).on(o+v,s),m=j(),x=e(f,g);r?(u=r.apply(c,arguments),u=[u.x-x[0],u.y-x[1]]):u=[0,0],h({type:"dragstart"})}}var n=k(t,"drag","dragstart","dragend"),r=null,a=e(m,$o.mouse,J,"mousemove","mouseup"),i=e(W,$o.touch,$,"touchmove","touchend");return t.origin=function(e){return arguments.length?(r=e,t):r},$o.rebind(t,n,"on")},$o.touches=function(t,e){return arguments.length<2&&(e=M().touches),e?Zo(e).map(function(e){var n=H(t,e);return n.identifier=e.identifier,n}):[]};var Sl=Math.PI,Ll=2*Sl,Dl=Sl/2,Nl=1e-6,_l=Nl*Nl,Pl=Sl/180,Il=180/Sl,Vl=Math.SQRT2,Fl=2,zl=4;$o.interpolateZoom=function(t,e){function n(t){var e=t*m;if(y){var n=ne(g),o=i/(Fl*f)*(n*re(Vl*e+g)-ee(g));return[r+o*u,a+o*c,i*n/ne(Vl*e+g)]}return[r+t*u,a+t*c,i*Math.exp(Vl*e)]}var r=t[0],a=t[1],i=t[2],o=e[0],l=e[1],s=e[2],u=o-r,c=l-a,d=u*u+c*c,f=Math.sqrt(d),h=(s*s-i*i+zl*d)/(2*i*Fl*f),p=(s*s-i*i-zl*d)/(2*s*Fl*f),g=Math.log(Math.sqrt(h*h+1)-h),v=Math.log(Math.sqrt(p*p+1)-p),y=v-g,m=(y||Math.log(s/i))/Vl;return n.duration=1e3*m,n},$o.behavior.zoom=function(){function t(t){t.on(S,u).on(Yl+".zoom",d).on("dblclick.zoom",f).on(N,c)}function e(t){return[(t[0]-w.x)/w.k,(t[1]-w.y)/w.k]}function n(t){return[t[0]*w.k+w.x,t[1]*w.k+w.y]}function r(t){w.k=Math.max(T[0],Math.min(T[1],t))}function a(t,e){e=n(e),w.x+=t[0]-e[0],w.y+=t[1]-e[1]}function i(){x&&x.domain(m.range().map(function(t){return(t-w.x)/w.k}).map(m.invert)),M&&M.domain(b.range().map(function(t){return(t-w.y)/w.k}).map(b.invert))}function o(t){t({type:"zoomstart"})}function l(t){i(),t({type:"zoom",scale:w.k,translate:[w.x,w.y]})}function s(t){t({type:"zoomend"})}function u(){function t(){c=1,a($o.mouse(r),f),l(u)}function n(){d.on(L,null).on(D,null),h(c&&$o.event.target===i),s(u)}var r=this,i=$o.event.target,u=_.of(r,arguments),c=0,d=$o.select(tl).on(L,t).on(D,n),f=e($o.mouse(r)),h=j();B.call(r),o(u)}function c(){function t(){var t=$o.touches(h);return f=w.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=e(t))}),t}function n(){var e=$o.event.target;$o.select(e).on(x,i).on(b,d),M.push(e);for(var n=$o.event.changedTouches,o=0,s=n.length;s>o;++o)g[n[o].identifier]=null;var u=t(),c=Date.now();if(1===u.length){if(500>c-y){var f=u[0],h=g[f.identifier];r(2*w.k),a(f,h),A(),l(p)}y=c}else if(u.length>1){var f=u[0],m=u[1],k=f[0]-m[0],C=f[1]-m[1];v=k*k+C*C}}function i(){for(var t,e,n,i,o=$o.touches(h),s=0,u=o.length;u>s;++s,i=null)if(n=o[s],i=g[n.identifier]){if(e)break;t=n,e=i}if(i){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,d=v&&Math.sqrt(c/v);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+i[0])/2,(e[1]+i[1])/2],r(d*f)}y=null,a(t,e),l(p)}function d(){if($o.event.touches.length){for(var e=$o.event.changedTouches,n=0,r=e.length;r>n;++n)delete g[e[n].identifier];for(var a in g)return void t()}$o.selectAll(M).on(m,null),k.on(S,u).on(N,c),C(),s(p)}var f,h=this,p=_.of(h,arguments),g={},v=0,m=".zoom-"+$o.event.changedTouches[0].identifier,x="touchmove"+m,b="touchend"+m,M=[],k=$o.select(h),C=j();B.call(h),n(),o(p),k.on(S,null).on(N,n)}function d(){var t=_.of(this,arguments);v?clearTimeout(v):(h=e(p=g||$o.mouse(this)),B.call(this),o(t)),v=setTimeout(function(){v=null,s(t)},50),A(),r(Math.pow(2,.002*El())*w.k),a(p,h),l(t)}function f(){var t=_.of(this,arguments),n=$o.mouse(this),i=e(n),u=Math.log(w.k)/Math.LN2;o(t),r(Math.pow(2,$o.event.shiftKey?Math.ceil(u)-1:Math.floor(u)+1)),a(n,i),l(t),s(t)}var h,p,g,v,y,m,x,b,M,w={x:0,y:0,k:1},C=[960,500],T=Gl,S="mousedown.zoom",L="mousemove.zoom",D="mouseup.zoom",N="touchstart.zoom",_=k(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=_.of(this,arguments),e=w;Du?$o.select(this).transition().each("start.zoom",function(){w=this.__chart__||{x:0,y:0,k:1},o(t)}).tween("zoom:zoom",function(){var n=C[0],r=C[1],a=n/2,i=r/2,o=$o.interpolateZoom([(a-w.x)/w.k,(i-w.y)/w.k,n/w.k],[(a-e.x)/e.k,(i-e.y)/e.k,n/e.k]);return function(e){var r=o(e),s=n/r[2];this.__chart__=w={x:a-r[0]*s,y:i-r[1]*s,k:s},l(t)}}).each("end.zoom",function(){s(t)}):(this.__chart__=w,o(t),l(t),s(t))})},t.translate=function(e){return arguments.length?(w={x:+e[0],y:+e[1],k:w.k},i(),t):[w.x,w.y]},t.scale=function(e){return arguments.length?(w={x:w.x,y:w.y,k:+e},i(),t):w.k},t.scaleExtent=function(e){return arguments.length?(T=null==e?Gl:[+e[0],+e[1]],t):T},t.center=function(e){return arguments.length?(g=e&&[+e[0],+e[1]],t):g},t.size=function(e){return arguments.length?(C=e&&[+e[0],+e[1]],t):C},t.x=function(e){return arguments.length?(x=e,m=e.copy(),w={x:0,y:0,k:1},t):x},t.y=function(e){return arguments.length?(M=e,b=e.copy(),w={x:0,y:0,k:1},t):M},$o.rebind(t,_,"on")};var El,Gl=[0,1/0],Yl="onwheel"in Ko?(El=function(){return-$o.event.deltaY*($o.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ko?(El=function(){return $o.event.wheelDelta},"mousewheel"):(El=function(){return-$o.event.detail},"MozMousePixelScroll");$o.color=ie,ie.prototype.toString=function(){return this.rgb()+""},$o.hsl=oe;var Rl=oe.prototype=new ie;Rl.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,this.l/t)},Rl.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,t*this.l)},Rl.rgb=function(){return le(this.h,this.s,this.l)},$o.hcl=se;var Ol=se.prototype=new ie;Ol.brighter=function(t){return new se(this.h,this.c,Math.min(100,this.l+Bl*(arguments.length?t:1)))},Ol.darker=function(t){return new se(this.h,this.c,Math.max(0,this.l-Bl*(arguments.length?t:1)))},Ol.rgb=function(){return ue(this.h,this.c,this.l).rgb()},$o.lab=ce;var Bl=18,Xl=.95047,ql=1,Ul=1.08883,jl=ce.prototype=new ie;jl.brighter=function(t){return new ce(Math.min(100,this.l+Bl*(arguments.length?t:1)),this.a,this.b)},jl.darker=function(t){return new ce(Math.max(0,this.l-Bl*(arguments.length?t:1)),this.a,this.b)},jl.rgb=function(){return de(this.l,this.a,this.b)},$o.rgb=ve;var Hl=ve.prototype=new ie;Hl.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,r=this.b,a=30;return e||n||r?(e&&a>e&&(e=a),n&&a>n&&(n=a),r&&a>r&&(r=a),new ve(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,r/t))):new ve(a,a,a)},Hl.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new ve(t*this.r,t*this.g,t*this.b)},Hl.hsl=function(){return Ae(this.r,this.g,this.b)},Hl.toString=function(){return"#"+xe(this.r)+xe(this.g)+xe(this.b)};var Wl=$o.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Wl.forEach(function(t,e){Wl.set(t,ye(e))}),$o.functor=Ce,$o.xhr=Se(Te),$o.dsv=function(t,e){function n(t,n,i){arguments.length<3&&(i=n,n=null);var o=Le(t,e,null==n?r:a(n),i);return o.row=function(t){return arguments.length?o.response(null==(n=t)?r:a(t)):n},o}function r(t){return n.parse(t.responseText)}function a(t){return function(e){return n.parse(e.responseText,t)}}function i(e){return e.map(o).join(t)}function o(t){return l.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var l=new RegExp('["'+t+"\n]"),s=t.charCodeAt(0);return n.parse=function(t,e){var r;return n.parseRows(t,function(t,n){if(r)return r(t,n-1);var a=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=e?function(t,n){return e(a(t),n)}:a})},n.parseRows=function(t,e){function n(){if(c>=u)return o;if(a)return a=!1,i;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<u;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var r=t.charCodeAt(n+1);return 13===r?(a=!0,10===t.charCodeAt(n+2)&&++c):10===r&&(a=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;u>c;){var r=t.charCodeAt(c++),l=1;if(10===r)a=!0;else if(13===r)a=!0,10===t.charCodeAt(c)&&(++c,++l);else if(r!==s)continue;return t.slice(e,c-l)}return t.slice(e)}for(var r,a,i={},o={},l=[],u=t.length,c=0,d=0;(r=n())!==o;){for(var f=[];r!==i&&r!==o;)f.push(r),r=n();e&&null==(f=e(f,d++))||l.push(f)}return l},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var r=new g,a=[];return e.forEach(function(t){for(var e in t)r.has(e)||a.push(r.add(e))}),[a.map(o).join(t)].concat(e.map(function(e){return a.map(function(t){return o(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(i).join("\n")},n},$o.csv=$o.dsv(",","text/csv"),$o.tsv=$o.dsv("	","text/tab-separated-values");var $l,Jl,Zl,Kl,Ql,ts=tl[y(tl,"requestAnimationFrame")]||function(t){setTimeout(t,17)};$o.timer=function(t,e,n){var r=arguments.length;2>r&&(e=0),3>r&&(n=Date.now());var a=n+e,i={c:t,t:a,f:!1,n:null};Jl?Jl.n=i:$l=i,Jl=i,Zl||(Kl=clearTimeout(Kl),Zl=1,ts(_e))},$o.timer.flush=function(){Pe(),Ie()},$o.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var es=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Fe);$o.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=$o.round(t,Ve(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),es[8+n/3]};var ns=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,rs=$o.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=$o.round(t,Ve(t,e))).toFixed(Math.max(0,Math.min(20,Ve(t*(1+1e-15),e))))}}),as=$o.time={},is=Date;Ge.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){os.setUTCDate.apply(this._,arguments)},setDay:function(){os.setUTCDay.apply(this._,arguments)},setFullYear:function(){os.setUTCFullYear.apply(this._,arguments)},setHours:function(){os.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){os.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){os.setUTCMinutes.apply(this._,arguments)},setMonth:function(){os.setUTCMonth.apply(this._,arguments)},setSeconds:function(){os.setUTCSeconds.apply(this._,arguments)},setTime:function(){os.setTime.apply(this._,arguments)}};var os=Date.prototype;as.year=Ye(function(t){return t=as.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),as.years=as.year.range,as.years.utc=as.year.utc.range,as.day=Ye(function(t){var e=new is(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),as.days=as.day.range,as.days.utc=as.day.utc.range,as.dayOfYear=function(t){var e=as.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=as[t]=Ye(function(t){return(t=as.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=as.year(t).getDay();return Math.floor((as.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});as[t+"s"]=n.range,as[t+"s"].utc=n.utc.range,as[t+"OfYear"]=function(t){var n=as.year(t).getDay();return Math.floor((as.dayOfYear(t)+(n+e)%7)/7)}}),as.week=as.sunday,as.weeks=as.sunday.range,as.weeks.utc=as.sunday.utc.range,as.weekOfYear=as.sundayOfYear;var ls={"-":"",_:" ",0:"0"},ss=/^\s*\d+/,us=/^%/;$o.locale=function(t){return{numberFormat:ze(t),timeFormat:Oe(t)}};var cs=$o.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});$o.format=cs.numberFormat,$o.geo={},un.prototype={s:0,t:0,add:function(t){cn(t,this.t,ds),cn(ds.s,this.s,this),this.s?this.t+=ds.t:this.s=ds.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ds=new un;$o.geo.stream=function(t,e){t&&fs.hasOwnProperty(t.type)?fs[t.type](t,e):dn(t,e)};var fs={Feature:function(t,e){dn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)dn(n[r].geometry,e)}},hs={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){fn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)fn(n[r],e,0)},Polygon:function(t,e){hn(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)hn(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)dn(n[r],e)}};$o.geo.area=function(t){return ps=0,$o.geo.stream(t,vs),ps};var ps,gs=new un,vs={sphere:function(){ps+=4*Sl},point:m,lineStart:m,lineEnd:m,polygonStart:function(){gs.reset(),vs.lineStart=pn},polygonEnd:function(){var t=2*gs;ps+=0>t?4*Sl+t:t,vs.lineStart=vs.lineEnd=vs.point=m}};$o.geo.bounds=function(){function t(t,e){x.push(b=[c=t,f=t]),d>e&&(d=e),e>h&&(h=e)}function e(e,n){var r=gn([e*Pl,n*Pl]);if(y){var a=yn(y,r),i=[a[1],-a[0],0],o=yn(i,a);bn(o),o=An(o);var s=e-p,u=s>0?1:-1,g=o[0]*Il*u,v=ul(s)>180;if(v^(g>u*p&&u*e>g)){var m=o[1]*Il;m>h&&(h=m)}else if(g=(g+360)%360-180,v^(g>u*p&&u*e>g)){var m=-o[1]*Il;d>m&&(d=m)}else d>n&&(d=n),n>h&&(h=n);v?p>e?l(c,e)>l(c,f)&&(f=e):l(e,f)>l(c,f)&&(c=e):f>=c?(c>e&&(c=e),e>f&&(f=e)):e>p?l(c,e)>l(c,f)&&(f=e):l(e,f)>l(c,f)&&(c=e)
}else t(e,n);y=r,p=e}function n(){A.point=e}function r(){b[0]=c,b[1]=f,A.point=t,y=null}function a(t,n){if(y){var r=t-p;m+=ul(r)>180?r+(r>0?360:-360):r}else g=t,v=n;vs.point(t,n),e(t,n)}function i(){vs.lineStart()}function o(){a(g,v),vs.lineEnd(),ul(m)>Nl&&(c=-(f=180)),b[0]=c,b[1]=f,y=null}function l(t,e){return(e-=t)<0?e+360:e}function s(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,d,f,h,p,g,v,y,m,x,b,A={point:t,lineStart:n,lineEnd:r,polygonStart:function(){A.point=a,A.lineStart=i,A.lineEnd=o,m=0,vs.polygonStart()},polygonEnd:function(){vs.polygonEnd(),A.point=t,A.lineStart=n,A.lineEnd=r,0>gs?(c=-(f=180),d=-(h=90)):m>Nl?h=90:-Nl>m&&(d=-90),b[0]=c,b[1]=f}};return function(t){h=f=-(c=d=1/0),x=[],$o.geo.stream(t,A);var e=x.length;if(e){x.sort(s);for(var n,r=1,a=x[0],i=[a];e>r;++r)n=x[r],u(n[0],a)||u(n[1],a)?(l(a[0],n[1])>l(a[0],a[1])&&(a[1]=n[1]),l(n[0],a[1])>l(a[0],a[1])&&(a[0]=n[0])):i.push(a=n);for(var o,n,p=-1/0,e=i.length-1,r=0,a=i[e];e>=r;a=n,++r)n=i[r],(o=l(a[1],n[0]))>p&&(p=o,c=n[0],f=a[1])}return x=b=null,1/0===c||1/0===d?[[0/0,0/0],[0/0,0/0]]:[[c,d],[f,h]]}}(),$o.geo.centroid=function(t){ys=ms=xs=bs=As=Ms=ks=ws=Cs=Ts=Ss=0,$o.geo.stream(t,Ls);var e=Cs,n=Ts,r=Ss,a=e*e+n*n+r*r;return _l>a&&(e=Ms,n=ks,r=ws,Nl>ms&&(e=xs,n=bs,r=As),a=e*e+n*n+r*r,_l>a)?[0/0,0/0]:[Math.atan2(n,e)*Il,te(r/Math.sqrt(a))*Il]};var ys,ms,xs,bs,As,Ms,ks,ws,Cs,Ts,Ss,Ls={sphere:m,point:kn,lineStart:Cn,lineEnd:Tn,polygonStart:function(){Ls.lineStart=Sn},polygonEnd:function(){Ls.lineStart=Cn}},Ds=Pn(Ln,zn,Gn,[-Sl,-Sl/2]),Ns=1e9;$o.geo.clipExtent=function(){var t,e,n,r,a,i,o={stream:function(t){return a&&(a.valid=!1),a=i(t),a.valid=!0,a},extent:function(l){return arguments.length?(i=Bn(t=+l[0][0],e=+l[0][1],n=+l[1][0],r=+l[1][1]),a&&(a.valid=!1,a=null),o):[[t,e],[n,r]]}};return o.extent([[0,0],[960,500]])},($o.geo.conicEqualArea=function(){return qn(Un)}).raw=Un,$o.geo.albers=function(){return $o.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},$o.geo.albersUsa=function(){function t(t){var i=t[0],o=t[1];return e=null,n(i,o),e||(r(i,o),e)||a(i,o),e}var e,n,r,a,i=$o.geo.albers(),o=$o.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=$o.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=i.scale(),n=i.translate(),r=(t[0]-n[0])/e,a=(t[1]-n[1])/e;return(a>=.12&&.234>a&&r>=-.425&&-.214>r?o:a>=.166&&.234>a&&r>=-.214&&-.115>r?l:i).invert(t)},t.stream=function(t){var e=i.stream(t),n=o.stream(t),r=l.stream(t);return{point:function(t,a){e.point(t,a),n.point(t,a),r.point(t,a)},sphere:function(){e.sphere(),n.sphere(),r.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},t.precision=function(e){return arguments.length?(i.precision(e),o.precision(e),l.precision(e),t):i.precision()},t.scale=function(e){return arguments.length?(i.scale(e),o.scale(.35*e),l.scale(e),t.translate(i.translate())):i.scale()},t.translate=function(e){if(!arguments.length)return i.translate();var u=i.scale(),c=+e[0],d=+e[1];return n=i.translate(e).clipExtent([[c-.455*u,d-.238*u],[c+.455*u,d+.238*u]]).stream(s).point,r=o.translate([c-.307*u,d+.201*u]).clipExtent([[c-.425*u+Nl,d+.12*u+Nl],[c-.214*u-Nl,d+.234*u-Nl]]).stream(s).point,a=l.translate([c-.205*u,d+.212*u]).clipExtent([[c-.214*u+Nl,d+.166*u+Nl],[c-.115*u-Nl,d+.234*u-Nl]]).stream(s).point,t},t.scale(1070)};var _s,Ps,Is,Vs,Fs,zs,Es={point:m,lineStart:m,lineEnd:m,polygonStart:function(){Ps=0,Es.lineStart=jn},polygonEnd:function(){Es.lineStart=Es.lineEnd=Es.point=m,_s+=ul(Ps/2)}},Gs={point:Hn,lineStart:m,lineEnd:m,polygonStart:m,polygonEnd:m},Ys={point:Jn,lineStart:Zn,lineEnd:Kn,polygonStart:function(){Ys.lineStart=Qn},polygonEnd:function(){Ys.point=Jn,Ys.lineStart=Zn,Ys.lineEnd=Kn}};$o.geo.path=function(){function t(t){return t&&("function"==typeof l&&i.pointRadius(+l.apply(this,arguments)),o&&o.valid||(o=a(i)),$o.geo.stream(t,o)),i.result()}function e(){return o=null,t}var n,r,a,i,o,l=4.5;return t.area=function(t){return _s=0,$o.geo.stream(t,a(Es)),_s},t.centroid=function(t){return xs=bs=As=Ms=ks=ws=Cs=Ts=Ss=0,$o.geo.stream(t,a(Ys)),Ss?[Cs/Ss,Ts/Ss]:ws?[Ms/ws,ks/ws]:As?[xs/As,bs/As]:[0/0,0/0]},t.bounds=function(t){return Fs=zs=-(Is=Vs=1/0),$o.geo.stream(t,a(Gs)),[[Is,Vs],[Fs,zs]]},t.projection=function(t){return arguments.length?(a=(n=t)?t.stream||nr(t):Te,e()):n},t.context=function(t){return arguments.length?(i=null==(r=t)?new Wn:new tr(t),"function"!=typeof l&&i.pointRadius(l),e()):r},t.pointRadius=function(e){return arguments.length?(l="function"==typeof e?e:(i.pointRadius(+e),+e),t):l},t.projection($o.geo.albersUsa()).context(null)},$o.geo.transform=function(t){return{stream:function(e){var n=new rr(e);for(var r in t)n[r]=t[r];return n}}},rr.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},$o.geo.projection=ir,$o.geo.projectionMutator=or,($o.geo.equirectangular=function(){return ir(sr)}).raw=sr.invert=sr,$o.geo.rotation=function(t){function e(e){return e=t(e[0]*Pl,e[1]*Pl),e[0]*=Il,e[1]*=Il,e}return t=cr(t[0]%360*Pl,t[1]*Pl,t.length>2?t[2]*Pl:0),e.invert=function(e){return e=t.invert(e[0]*Pl,e[1]*Pl),e[0]*=Il,e[1]*=Il,e},e},ur.invert=sr,$o.geo.circle=function(){function t(){var t="function"==typeof r?r.apply(this,arguments):r,e=cr(-t[0]*Pl,-t[1]*Pl,0).invert,a=[];return n(null,null,1,{point:function(t,n){a.push(t=e(t,n)),t[0]*=Il,t[1]*=Il}}),{type:"Polygon",coordinates:[a]}}var e,n,r=[0,0],a=6;return t.origin=function(e){return arguments.length?(r=e,t):r},t.angle=function(r){return arguments.length?(n=pr((e=+r)*Pl,a*Pl),t):e},t.precision=function(r){return arguments.length?(n=pr(e*Pl,(a=+r)*Pl),t):a},t.angle(90)},$o.geo.distance=function(t,e){var n,r=(e[0]-t[0])*Pl,a=t[1]*Pl,i=e[1]*Pl,o=Math.sin(r),l=Math.cos(r),s=Math.sin(a),u=Math.cos(a),c=Math.sin(i),d=Math.cos(i);return Math.atan2(Math.sqrt((n=d*o)*n+(n=u*c-s*d*l)*n),s*c+u*d*l)},$o.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return $o.range(Math.ceil(i/v)*v,a,v).map(f).concat($o.range(Math.ceil(u/y)*y,s,y).map(h)).concat($o.range(Math.ceil(r/p)*p,n,p).filter(function(t){return ul(t%v)>Nl}).map(c)).concat($o.range(Math.ceil(l/g)*g,o,g).filter(function(t){return ul(t%y)>Nl}).map(d))}var n,r,a,i,o,l,s,u,c,d,f,h,p=10,g=p,v=90,y=360,m=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(i).concat(h(s).slice(1),f(a).reverse().slice(1),h(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(i=+e[0][0],a=+e[1][0],u=+e[0][1],s=+e[1][1],i>a&&(e=i,i=a,a=e),u>s&&(e=u,u=s,s=e),t.precision(m)):[[i,u],[a,s]]},t.minorExtent=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],l=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),l>o&&(e=l,l=o,o=e),t.precision(m)):[[r,l],[n,o]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(v=+e[0],y=+e[1],t):[v,y]},t.minorStep=function(e){return arguments.length?(p=+e[0],g=+e[1],t):[p,g]},t.precision=function(e){return arguments.length?(m=+e,c=vr(l,o,90),d=yr(r,n,m),f=vr(u,s,90),h=yr(i,a,m),t):m},t.majorExtent([[-180,-90+Nl],[180,90-Nl]]).minorExtent([[-180,-80-Nl],[180,80+Nl]])},$o.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||r.apply(this,arguments),n||a.apply(this,arguments)]}}var e,n,r=mr,a=xr;return t.distance=function(){return $o.geo.distance(e||r.apply(this,arguments),n||a.apply(this,arguments))},t.source=function(n){return arguments.length?(r=n,e="function"==typeof n?null:n,t):r},t.target=function(e){return arguments.length?(a=e,n="function"==typeof e?null:e,t):a},t.precision=function(){return arguments.length?t:0},t},$o.geo.interpolate=function(t,e){return br(t[0]*Pl,t[1]*Pl,e[0]*Pl,e[1]*Pl)},$o.geo.length=function(t){return Rs=0,$o.geo.stream(t,Os),Rs};var Rs,Os={sphere:m,point:m,lineStart:Ar,lineEnd:m,polygonStart:m,polygonEnd:m},Bs=Mr(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});($o.geo.azimuthalEqualArea=function(){return ir(Bs)}).raw=Bs;var Xs=Mr(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},Te);($o.geo.azimuthalEquidistant=function(){return ir(Xs)}).raw=Xs,($o.geo.conicConformal=function(){return qn(kr)}).raw=kr,($o.geo.conicEquidistant=function(){return qn(wr)}).raw=wr;var qs=Mr(function(t){return 1/t},Math.atan);($o.geo.gnomonic=function(){return ir(qs)}).raw=qs,Cr.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Dl]},($o.geo.mercator=function(){return Tr(Cr)}).raw=Cr;var Us=Mr(function(){return 1},Math.asin);($o.geo.orthographic=function(){return ir(Us)}).raw=Us;var js=Mr(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});($o.geo.stereographic=function(){return ir(js)}).raw=js,Sr.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Dl]},($o.geo.transverseMercator=function(){var t=Tr(Sr),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=Sr,$o.geom={},$o.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,a=Ce(n),i=Ce(r),o=t.length,l=[],s=[];for(e=0;o>e;e++)l.push([+a.call(this,t[e],e),+i.call(this,t[e],e),e]);for(l.sort(_r),e=0;o>e;e++)s.push([l[e][0],-l[e][1]]);var u=Nr(l),c=Nr(s),d=c[0]===u[0],f=c[c.length-1]===u[u.length-1],h=[];for(e=u.length-1;e>=0;--e)h.push(t[l[u[e]][2]]);for(e=+d;e<c.length-f;++e)h.push(t[l[c[e]][2]]);return h}var n=Lr,r=Dr;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e)},$o.geom.polygon=function(t){return pl(t,Hs),t};var Hs=$o.geom.polygon.prototype=[];Hs.area=function(){for(var t,e=-1,n=this.length,r=this[n-1],a=0;++e<n;)t=r,r=this[e],a+=t[1]*r[0]-t[0]*r[1];return.5*a},Hs.centroid=function(t){var e,n,r=-1,a=this.length,i=0,o=0,l=this[a-1];for(arguments.length||(t=-1/(6*this.area()));++r<a;)e=l,l=this[r],n=e[0]*l[1]-l[0]*e[1],i+=(e[0]+l[0])*n,o+=(e[1]+l[1])*n;return[i*t,o*t]},Hs.clip=function(t){for(var e,n,r,a,i,o,l=Vr(t),s=-1,u=this.length-Vr(this),c=this[u-1];++s<u;){for(e=t.slice(),t.length=0,a=this[s],i=e[(r=e.length-l)-1],n=-1;++n<r;)o=e[n],Pr(o,c,a)?(Pr(i,c,a)||t.push(Ir(i,o,c,a)),t.push(o)):Pr(i,c,a)&&t.push(Ir(i,o,c,a)),i=o;l&&t.push(t[0]),c=a}return t};var Ws,$s,Js,Zs,Ks,Qs=[],tu=[];Br.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(qr),e.length},ta.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ea.prototype={insert:function(t,e){var n,r,a;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=ia(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(a=r.R,a&&a.C?(n.C=a.C=!1,r.C=!0,t=r):(t===n.R&&(ra(this,n),t=n,n=t.U),n.C=!1,r.C=!0,aa(this,r))):(a=r.L,a&&a.C?(n.C=a.C=!1,r.C=!0,t=r):(t===n.L&&(aa(this,n),t=n,n=t.U),n.C=!1,r.C=!0,ra(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,a=t.U,i=t.L,o=t.R;if(n=i?o?ia(o):i:o,a?a.L===t?a.L=n:a.R=n:this._=n,i&&o?(r=n.C,n.C=t.C,n.L=i,i.U=n,n!==o?(a=n.U,n.U=t.U,t=n.R,a.L=t,n.R=o,o.U=n):(n.U=a,a=n,t=n.R)):(r=t.C,t=n),t&&(t.U=a),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===a.L){if(e=a.R,e.C&&(e.C=!1,a.C=!0,ra(this,a),e=a.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,aa(this,e),e=a.R),e.C=a.C,a.C=e.R.C=!1,ra(this,a),t=this._;break}}else if(e=a.L,e.C&&(e.C=!1,a.C=!0,aa(this,a),e=a.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ra(this,e),e=a.L),e.C=a.C,a.C=e.L.C=!1,aa(this,a),t=this._;break}e.C=!0,t=a,a=a.U}while(!t.C);t&&(t.C=!1)}}},$o.geom.voronoi=function(t){function e(t){var e=new Array(t.length),r=l[0][0],a=l[0][1],i=l[1][0],o=l[1][1];return oa(n(t),l).cells.forEach(function(n,l){var s=n.edges,u=n.site,c=e[l]=s.length?s.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=r&&u.x<=i&&u.y>=a&&u.y<=o?[[r,o],[i,o],[i,a],[r,a]]:[];c.point=t[l]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(i(t,e)/Nl)*Nl,y:Math.round(o(t,e)/Nl)*Nl,i:e}})}var r=Lr,a=Dr,i=r,o=a,l=eu;return t?e(t):(e.links=function(t){return oa(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return oa(n(t)).cells.forEach(function(n,r){for(var a,i,o=n.site,l=n.edges.sort(qr),s=-1,u=l.length,c=l[u-1].edge,d=c.l===o?c.r:c.l;++s<u;)a=c,i=d,c=l[s].edge,d=c.l===o?c.r:c.l,r<i.i&&r<d.i&&sa(o,i,d)<0&&e.push([t[r],t[i.i],t[d.i]])}),e},e.x=function(t){return arguments.length?(i=Ce(r=t),e):r},e.y=function(t){return arguments.length?(o=Ce(a=t),e):a},e.clipExtent=function(t){return arguments.length?(l=null==t?eu:t,e):l===eu?null:l},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):l===eu?null:l&&l[1]},e)};var eu=[[-1e6,-1e6],[1e6,1e6]];$o.geom.delaunay=function(t){return $o.geom.voronoi().triangles(t)},$o.geom.quadtree=function(t,e,n,r,a){function i(t){function i(t,e,n,r,a,i,o,l){if(!isNaN(n)&&!isNaN(r))if(t.leaf){var s=t.x,c=t.y;if(null!=s)if(ul(s-n)+ul(c-r)<.01)u(t,e,n,r,a,i,o,l);else{var d=t.point;t.x=t.y=t.point=null,u(t,d,s,c,a,i,o,l),u(t,e,n,r,a,i,o,l)}else t.x=n,t.y=r,t.point=e}else u(t,e,n,r,a,i,o,l)}function u(t,e,n,r,a,o,l,s){var u=.5*(a+l),c=.5*(o+s),d=n>=u,f=r>=c,h=(f<<1)+d;t.leaf=!1,t=t.nodes[h]||(t.nodes[h]=da()),d?a=u:l=u,f?o=c:s=c,i(t,e,n,r,a,o,l,s)}var c,d,f,h,p,g,v,y,m,x=Ce(l),b=Ce(s);if(null!=e)g=e,v=n,y=r,m=a;else if(y=m=-(g=v=1/0),d=[],f=[],p=t.length,o)for(h=0;p>h;++h)c=t[h],c.x<g&&(g=c.x),c.y<v&&(v=c.y),c.x>y&&(y=c.x),c.y>m&&(m=c.y),d.push(c.x),f.push(c.y);else for(h=0;p>h;++h){var A=+x(c=t[h],h),M=+b(c,h);g>A&&(g=A),v>M&&(v=M),A>y&&(y=A),M>m&&(m=M),d.push(A),f.push(M)}var k=y-g,w=m-v;k>w?m=v+k:y=g+w;var C=da();if(C.add=function(t){i(C,t,+x(t,++h),+b(t,h),g,v,y,m)},C.visit=function(t){fa(t,C,g,v,y,m)},h=-1,null==e){for(;++h<p;)i(C,t[h],d[h],f[h],g,v,y,m);--h}else t.forEach(C.add);return d=f=t=c=null,C}var o,l=Lr,s=Dr;return(o=arguments.length)?(l=ua,s=ca,3===o&&(a=n,r=e,n=e=0),i(t)):(i.x=function(t){return arguments.length?(l=t,i):l},i.y=function(t){return arguments.length?(s=t,i):s},i.extent=function(t){return arguments.length?(null==t?e=n=r=a=null:(e=+t[0][0],n=+t[0][1],r=+t[1][0],a=+t[1][1]),i):null==e?null:[[e,n],[r,a]]},i.size=function(t){return arguments.length?(null==t?e=n=r=a=null:(e=n=0,r=+t[0],a=+t[1]),i):null==e?null:[r-e,a-n]},i)},$o.interpolateRgb=ha,$o.interpolateObject=pa,$o.interpolateNumber=ga,$o.interpolateString=va;var nu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ru=new RegExp(nu.source,"g");$o.interpolate=ya,$o.interpolators=[function(t,e){var n=typeof e;return("string"===n?Wl.has(e)||/^(#|rgb\(|hsl\()/.test(e)?ha:va:e instanceof ie?ha:Array.isArray(e)?ma:"object"===n&&isNaN(e)?pa:ga)(t,e)}],$o.interpolateArray=ma;var au=function(){return Te},iu=$o.map({linear:au,poly:Ca,quad:function(){return Ma},cubic:function(){return ka},sin:function(){return Ta},exp:function(){return Sa},circle:function(){return La},elastic:Da,back:Na,bounce:function(){return _a}}),ou=$o.map({"in":Te,out:ba,"in-out":Aa,"out-in":function(t){return Aa(ba(t))}});$o.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,r=e>=0?t.slice(e+1):"in";return n=iu.get(n)||au,r=ou.get(r)||Te,xa(r(n.apply(null,Jo.call(arguments,1))))},$o.interpolateHcl=Pa,$o.interpolateHsl=Ia,$o.interpolateLab=Va,$o.interpolateRound=Fa,$o.transform=function(t){var e=Ko.createElementNS($o.ns.prefix.svg,"g");return($o.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new za(n?n.matrix:lu)})(t)},za.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var lu={a:1,b:0,c:0,d:1,e:0,f:0};$o.interpolateTransform=Ra,$o.layout={},$o.layout.bundle=function(){return function(t){for(var e=[],n=-1,r=t.length;++n<r;)e.push(Xa(t[n]));return e}},$o.layout.chord=function(){function t(){var t,u,d,f,h,p={},g=[],v=$o.range(i),y=[];for(n=[],r=[],t=0,f=-1;++f<i;){for(u=0,h=-1;++h<i;)u+=a[f][h];g.push(u),y.push($o.range(i)),t+=u}for(o&&v.sort(function(t,e){return o(g[t],g[e])}),l&&y.forEach(function(t,e){t.sort(function(t,n){return l(a[e][t],a[e][n])})}),t=(Ll-c*i)/t,u=0,f=-1;++f<i;){for(d=u,h=-1;++h<i;){var m=v[f],x=y[m][h],b=a[m][x],A=u,M=u+=b*t;p[m+"-"+x]={index:m,subindex:x,startAngle:A,endAngle:M,value:b}}r[m]={index:m,startAngle:d,endAngle:u,value:(u-d)/t},u+=c}for(f=-1;++f<i;)for(h=f-1;++h<i;){var k=p[f+"-"+h],w=p[h+"-"+f];(k.value||w.value)&&n.push(k.value<w.value?{source:w,target:k}:{source:k,target:w})}s&&e()}function e(){n.sort(function(t,e){return s((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,r,a,i,o,l,s,u={},c=0;return u.matrix=function(t){return arguments.length?(i=(a=t)&&a.length,n=r=null,u):a},u.padding=function(t){return arguments.length?(c=t,n=r=null,u):c},u.sortGroups=function(t){return arguments.length?(o=t,n=r=null,u):o},u.sortSubgroups=function(t){return arguments.length?(l=t,n=null,u):l},u.sortChords=function(t){return arguments.length?(s=t,n&&e(),u):s},u.chords=function(){return n||t(),n},u.groups=function(){return r||t(),r},u},$o.layout.force=function(){function t(t){return function(e,n,r,a){if(e.point!==t){var i=e.cx-t.x,o=e.cy-t.y,l=a-n,s=i*i+o*o;if(s>l*l/v){if(p>s){var u=e.charge/s;t.px-=i*u,t.py-=o*u}return!0}if(e.point&&s&&p>s){var u=e.pointCharge/s;t.px-=i*u,t.py-=o*u}}return!e.charge}}function e(t){t.px=$o.event.x,t.py=$o.event.y,l.resume()}var n,r,a,i,o,l={},s=$o.dispatch("start","tick","end"),u=[1,1],c=.9,d=su,f=uu,h=-30,p=cu,g=.1,v=.64,y=[],m=[];return l.tick=function(){if((r*=.99)<.005)return s.end({type:"end",alpha:r=0}),!0;var e,n,l,d,f,p,v,x,b,A=y.length,M=m.length;for(n=0;M>n;++n)l=m[n],d=l.source,f=l.target,x=f.x-d.x,b=f.y-d.y,(p=x*x+b*b)&&(p=r*i[n]*((p=Math.sqrt(p))-a[n])/p,x*=p,b*=p,f.x-=x*(v=d.weight/(f.weight+d.weight)),f.y-=b*v,d.x+=x*(v=1-v),d.y+=b*v);if((v=r*g)&&(x=u[0]/2,b=u[1]/2,n=-1,v))for(;++n<A;)l=y[n],l.x+=(x-l.x)*v,l.y+=(b-l.y)*v;if(h)for(Ja(e=$o.geom.quadtree(y),r,o),n=-1;++n<A;)(l=y[n]).fixed||e.visit(t(l));for(n=-1;++n<A;)l=y[n],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*c,l.y-=(l.py-(l.py=l.y))*c);s.tick({type:"tick",alpha:r})},l.nodes=function(t){return arguments.length?(y=t,l):y},l.links=function(t){return arguments.length?(m=t,l):m},l.size=function(t){return arguments.length?(u=t,l):u},l.linkDistance=function(t){return arguments.length?(d="function"==typeof t?t:+t,l):d},l.distance=l.linkDistance,l.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,l):f},l.friction=function(t){return arguments.length?(c=+t,l):c},l.charge=function(t){return arguments.length?(h="function"==typeof t?t:+t,l):h},l.chargeDistance=function(t){return arguments.length?(p=t*t,l):Math.sqrt(p)},l.gravity=function(t){return arguments.length?(g=+t,l):g},l.theta=function(t){return arguments.length?(v=t*t,l):Math.sqrt(v)},l.alpha=function(t){return arguments.length?(t=+t,r?r=t>0?t:0:t>0&&(s.start({type:"start",alpha:r=t}),$o.timer(l.tick)),l):r},l.start=function(){function t(t,r){if(!n){for(n=new Array(s),l=0;s>l;++l)n[l]=[];for(l=0;u>l;++l){var a=m[l];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}for(var i,o=n[e],l=-1,u=o.length;++l<u;)if(!isNaN(i=o[l][t]))return i;return Math.random()*r}var e,n,r,s=y.length,c=m.length,p=u[0],g=u[1];for(e=0;s>e;++e)(r=y[e]).index=e,r.weight=0;for(e=0;c>e;++e)r=m[e],"number"==typeof r.source&&(r.source=y[r.source]),"number"==typeof r.target&&(r.target=y[r.target]),++r.source.weight,++r.target.weight;for(e=0;s>e;++e)r=y[e],isNaN(r.x)&&(r.x=t("x",p)),isNaN(r.y)&&(r.y=t("y",g)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(a=[],"function"==typeof d)for(e=0;c>e;++e)a[e]=+d.call(this,m[e],e);else for(e=0;c>e;++e)a[e]=d;if(i=[],"function"==typeof f)for(e=0;c>e;++e)i[e]=+f.call(this,m[e],e);else for(e=0;c>e;++e)i[e]=f;if(o=[],"function"==typeof h)for(e=0;s>e;++e)o[e]=+h.call(this,y[e],e);else for(e=0;s>e;++e)o[e]=h;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return n||(n=$o.behavior.drag().origin(Te).on("dragstart.force",ja).on("drag.force",e).on("dragend.force",Ha)),arguments.length?void this.on("mouseover.force",Wa).on("mouseout.force",$a).call(n):n},$o.rebind(l,s,"on")};var su=20,uu=1,cu=1/0;$o.layout.hierarchy=function(){function t(a){var i,o=[a],l=[];for(a.depth=0;null!=(i=o.pop());)if(l.push(i),(u=n.call(t,i,i.depth))&&(s=u.length)){for(var s,u,c;--s>=0;)o.push(c=u[s]),c.parent=i,c.depth=i.depth+1;r&&(i.value=0),i.children=u}else r&&(i.value=+r.call(t,i,i.depth)||0),delete i.children;return Qa(a,function(t){var n,a;e&&(n=t.children)&&n.sort(e),r&&(a=t.parent)&&(a.value+=t.value)}),l}var e=ni,n=ti,r=ei;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(r=e,t):r},t.revalue=function(e){return r&&(Ka(e,function(t){t.children&&(t.value=0)}),Qa(e,function(e){var n;e.children||(e.value=+r.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},$o.layout.partition=function(){function t(e,n,r,a){var i=e.children;if(e.x=n,e.y=e.depth*a,e.dx=r,e.dy=a,i&&(o=i.length)){var o,l,s,u=-1;for(r=e.value?r/e.value:0;++u<o;)t(l=i[u],n,s=l.value*r,a),n+=s}}function e(t){var n=t.children,r=0;if(n&&(a=n.length))for(var a,i=-1;++i<a;)r=Math.max(r,e(n[i]));return 1+r}function n(n,i){var o=r.call(this,n,i);return t(o[0],0,a[0],a[1]/e(o[0])),o}var r=$o.layout.hierarchy(),a=[1,1];return n.size=function(t){return arguments.length?(a=t,n):a},Za(n,r)},$o.layout.pie=function(){function t(i){var o=i.map(function(n,r){return+e.call(t,n,r)}),l=+("function"==typeof r?r.apply(this,arguments):r),s=(("function"==typeof a?a.apply(this,arguments):a)-l)/$o.sum(o),u=$o.range(i.length);null!=n&&u.sort(n===du?function(t,e){return o[e]-o[t]}:function(t,e){return n(i[t],i[e])});var c=[];return u.forEach(function(t){var e;c[t]={data:i[t],value:e=o[t],startAngle:l,endAngle:l+=e*s}}),c}var e=Number,n=du,r=0,a=Ll;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(r=e,t):r},t.endAngle=function(e){return arguments.length?(a=e,t):a},t};var du={};$o.layout.stack=function(){function t(l,s){if(!(f=l.length))return l;var u=l.map(function(n,r){return e.call(t,n,r)}),c=u.map(function(e){return e.map(function(e,n){return[i.call(t,e,n),o.call(t,e,n)]})}),d=n.call(t,c,s);u=$o.permute(u,d),c=$o.permute(c,d);var f,h,p,g,v=r.call(t,c,s),y=u[0].length;for(p=0;y>p;++p)for(a.call(t,u[0][p],g=v[p],c[0][p][1]),h=1;f>h;++h)a.call(t,u[h][p],g+=c[h-1][p][1],c[h][p][1]);return l}var e=Te,n=li,r=si,a=oi,i=ai,o=ii;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:fu.get(e)||li,t):n},t.offset=function(e){return arguments.length?(r="function"==typeof e?e:hu.get(e)||si,t):r},t.x=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(o=e,t):o},t.out=function(e){return arguments.length?(a=e,t):a},t};var fu=$o.map({"inside-out":function(t){var e,n,r=t.length,a=t.map(ui),i=t.map(ci),o=$o.range(r).sort(function(t,e){return a[t]-a[e]}),l=0,s=0,u=[],c=[];for(e=0;r>e;++e)n=o[e],s>l?(l+=i[n],u.push(n)):(s+=i[n],c.push(n));return c.reverse().concat(u)},reverse:function(t){return $o.range(t.length).reverse()},"default":li}),hu=$o.map({silhouette:function(t){var e,n,r,a=t.length,i=t[0].length,o=[],l=0,s=[];for(n=0;i>n;++n){for(e=0,r=0;a>e;e++)r+=t[e][n][1];r>l&&(l=r),o.push(r)}for(n=0;i>n;++n)s[n]=(l-o[n])/2;return s},wiggle:function(t){var e,n,r,a,i,o,l,s,u,c=t.length,d=t[0],f=d.length,h=[];for(h[0]=s=u=0,n=1;f>n;++n){for(e=0,a=0;c>e;++e)a+=t[e][n][1];for(e=0,i=0,l=d[n][0]-d[n-1][0];c>e;++e){for(r=0,o=(t[e][n][1]-t[e][n-1][1])/(2*l);e>r;++r)o+=(t[r][n][1]-t[r][n-1][1])/l;i+=o*t[e][n][1]}h[n]=s-=a?i/a*l:0,u>s&&(u=s)}for(n=0;f>n;++n)h[n]-=u;return h},expand:function(t){var e,n,r,a=t.length,i=t[0].length,o=1/a,l=[];for(n=0;i>n;++n){for(e=0,r=0;a>e;e++)r+=t[e][n][1];if(r)for(e=0;a>e;e++)t[e][n][1]/=r;else for(e=0;a>e;e++)t[e][n][1]=o}for(n=0;i>n;++n)l[n]=0;return l},zero:si});$o.layout.histogram=function(){function t(t,i){for(var o,l,s=[],u=t.map(n,this),c=r.call(this,u,i),d=a.call(this,c,u,i),i=-1,f=u.length,h=d.length-1,p=e?1:1/f;++i<h;)o=s[i]=[],o.dx=d[i+1]-(o.x=d[i]),o.y=0;if(h>0)for(i=-1;++i<f;)l=u[i],l>=c[0]&&l<=c[1]&&(o=s[$o.bisect(d,l,1,h)-1],o.y+=p,o.push(t[i]));return s}var e=!0,n=Number,r=pi,a=fi;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(r=Ce(e),t):r},t.bins=function(e){return arguments.length?(a="number"==typeof e?function(t){return hi(t,e)}:Ce(e),t):a},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},$o.layout.pack=function(){function t(t,i){var o=n.call(this,t,i),l=o[0],s=a[0],u=a[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(l.x=l.y=0,Qa(l,function(t){t.r=+c(t.value)}),Qa(l,xi),r){var d=r*(e?1:Math.max(2*l.r/s,2*l.r/u))/2;Qa(l,function(t){t.r+=d}),Qa(l,xi),Qa(l,function(t){t.r-=d})}return Mi(l,s/2,u/2,e?1:1/Math.max(2*l.r/s,2*l.r/u)),o}var e,n=$o.layout.hierarchy().sort(gi),r=0,a=[1,1];return t.size=function(e){return arguments.length?(a=e,t):a},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(r=+e,t):r},Za(t,n)},$o.layout.tree=function(){function t(t,a){var c=o.call(this,t,a),d=c[0],f=e(d);if(Qa(f,n),f.parent.m=-f.z,Ka(f,r),u)Ka(d,i);else{var h=d,p=d,g=d;Ka(d,function(t){t.x<h.x&&(h=t),t.x>p.x&&(p=t),t.depth>g.depth&&(g=t)});var v=l(h,p)/2-h.x,y=s[0]/(p.x+l(p,h)/2+v),m=s[1]/(g.depth||1);Ka(d,function(t){t.x=(t.x+v)*y,t.y=t.depth*m})}return c}function e(t){for(var e,n={A:null,children:[t]},r=[n];null!=(e=r.pop());)for(var a,i=e.children,o=0,l=i.length;l>o;++o)r.push((i[o]=a={_:i[o],parent:e,children:(a=i[o].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=a);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,r=t.i?n[t.i-1]:null;if(e.length){Li(t);var i=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+l(t._,r._),t.m=t.z-i):t.z=i}else r&&(t.z=r.z+l(t._,r._));t.parent.A=a(t,r,t.parent.A||n[0])}function r(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t,e,n){if(e){for(var r,a=t,i=t,o=e,s=a.parent.children[0],u=a.m,c=i.m,d=o.m,f=s.m;o=Ti(o),a=Ci(a),o&&a;)s=Ci(s),i=Ti(i),i.a=t,r=o.z+d-a.z-u+l(o._,a._),r>0&&(Si(Di(o,t,n),t,r),u+=r,c+=r),d+=o.m,u+=a.m,f+=s.m,c+=i.m;o&&!Ti(i)&&(i.t=o,i.m+=d-c),a&&!Ci(s)&&(s.t=a,s.m+=u-f,n=t)}return n}function i(t){t.x*=s[0],t.y=t.depth*s[1]}var o=$o.layout.hierarchy().sort(null).value(null),l=wi,s=[1,1],u=null;return t.separation=function(e){return arguments.length?(l=e,t):l},t.size=function(e){return arguments.length?(u=null==(s=e)?i:null,t):u?null:s},t.nodeSize=function(e){return arguments.length?(u=null==(s=e)?null:i,t):u?s:null},Za(t,o)},$o.layout.cluster=function(){function t(t,i){var o,l=e.call(this,t,i),s=l[0],u=0;Qa(s,function(t){var e=t.children;e&&e.length?(t.x=_i(e),t.y=Ni(e)):(t.x=o?u+=n(t,o):0,t.y=0,o=t)});var c=Pi(s),d=Ii(s),f=c.x-n(c,d)/2,h=d.x+n(d,c)/2;return Qa(s,a?function(t){t.x=(t.x-s.x)*r[0],t.y=(s.y-t.y)*r[1]}:function(t){t.x=(t.x-f)/(h-f)*r[0],t.y=(1-(s.y?t.y/s.y:1))*r[1]}),l}var e=$o.layout.hierarchy().sort(null).value(null),n=wi,r=[1,1],a=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(a=null==(r=e),t):a?null:r},t.nodeSize=function(e){return arguments.length?(a=null!=(r=e),t):a?r:null},Za(t,e)},$o.layout.treemap=function(){function t(t,e){for(var n,r,a=-1,i=t.length;++a<i;)r=(n=t[a]).value*(0>e?0:e),n.area=isNaN(r)||0>=r?0:r}function e(n){var i=n.children;if(i&&i.length){var o,l,s,u=d(n),c=[],f=i.slice(),p=1/0,g="slice"===h?u.dx:"dice"===h?u.dy:"slice-dice"===h?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(f,u.dx*u.dy/n.value),c.area=0;(s=f.length)>0;)c.push(o=f[s-1]),c.area+=o.area,"squarify"!==h||(l=r(c,g))<=p?(f.pop(),p=l):(c.area-=c.pop().area,a(c,g,u,!1),g=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(a(c,g,u,!0),c.length=c.area=0),i.forEach(e)}}function n(e){var r=e.children;if(r&&r.length){var i,o=d(e),l=r.slice(),s=[];for(t(l,o.dx*o.dy/e.value),s.area=0;i=l.pop();)s.push(i),s.area+=i.area,null!=i.z&&(a(s,i.z?o.dx:o.dy,o,!l.length),s.length=s.area=0);r.forEach(n)}}function r(t,e){for(var n,r=t.area,a=0,i=1/0,o=-1,l=t.length;++o<l;)(n=t[o].area)&&(i>n&&(i=n),n>a&&(a=n));return r*=r,e*=e,r?Math.max(e*a*p/r,r/(e*i*p)):1/0}function a(t,e,n,r){var a,i=-1,o=t.length,l=n.x,u=n.y,c=e?s(t.area/e):0;if(e==n.dx){for((r||c>n.dy)&&(c=n.dy);++i<o;)a=t[i],a.x=l,a.y=u,a.dy=c,l+=a.dx=Math.min(n.x+n.dx-l,c?s(a.area/c):0);a.z=!0,a.dx+=n.x+n.dx-l,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++i<o;)a=t[i],a.x=l,a.y=u,a.dx=c,u+=a.dy=Math.min(n.y+n.dy-u,c?s(a.area/c):0);a.z=!1,a.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function i(r){var a=o||l(r),i=a[0];return i.x=0,i.y=0,i.dx=u[0],i.dy=u[1],o&&l.revalue(i),t([i],i.dx*i.dy/i.value),(o?n:e)(i),f&&(o=a),a}var o,l=$o.layout.hierarchy(),s=Math.round,u=[1,1],c=null,d=Vi,f=!1,h="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(t){return arguments.length?(u=t,i):u},i.padding=function(t){function e(e){var n=t.call(i,e,e.depth);return null==n?Vi(e):Fi(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Fi(e,t)}if(!arguments.length)return c;var r;return d=null==(c=t)?Vi:"function"==(r=typeof t)?e:"number"===r?(t=[t,t,t,t],n):n,i},i.round=function(t){return arguments.length?(s=t?Math.round:Number,i):s!=Number},i.sticky=function(t){return arguments.length?(f=t,o=null,i):f},i.ratio=function(t){return arguments.length?(p=t,i):p},i.mode=function(t){return arguments.length?(h=t+"",i):h},Za(i,l)},$o.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,r,a;do n=2*Math.random()-1,r=2*Math.random()-1,a=n*n+r*r;while(!a||a>1);return t+e*n*Math.sqrt(-2*Math.log(a)/a)}},logNormal:function(){var t=$o.random.normal.apply($o,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=$o.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},$o.scale={};var pu={floor:Te,ceil:Te};$o.scale.linear=function(){return Bi([0,1],[0,1],ya,!1)};var gu={s:1,g:1,p:1,r:1,e:1};$o.scale.log=function(){return Ji($o.scale.linear().domain([0,1]),10,!0,[1,10])};var vu=$o.format(".0e"),yu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};$o.scale.pow=function(){return Zi($o.scale.linear(),1,[0,1])},$o.scale.sqrt=function(){return $o.scale.pow().exponent(.5)},$o.scale.ordinal=function(){return Qi([],{t:"range",a:[[]]})},$o.scale.category10=function(){return $o.scale.ordinal().range(mu)},$o.scale.category20=function(){return $o.scale.ordinal().range(xu)},$o.scale.category20b=function(){return $o.scale.ordinal().range(bu)
},$o.scale.category20c=function(){return $o.scale.ordinal().range(Au)};var mu=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(me),xu=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(me),bu=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(me),Au=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(me);$o.scale.quantile=function(){return to([],[])},$o.scale.quantize=function(){return eo(0,1,[0,1])},$o.scale.threshold=function(){return no([.5],[0,1])},$o.scale.identity=function(){return ro([0,1])},$o.svg={},$o.svg.arc=function(){function t(){var t=e.apply(this,arguments),i=n.apply(this,arguments),o=r.apply(this,arguments)+Mu,l=a.apply(this,arguments)+Mu,s=(o>l&&(s=o,o=l,l=s),l-o),u=Sl>s?"0":"1",c=Math.cos(o),d=Math.sin(o),f=Math.cos(l),h=Math.sin(l);return s>=ku?t?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":t?"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+u+",1 "+i*f+","+i*h+"L"+t*f+","+t*h+"A"+t+","+t+" 0 "+u+",0 "+t*c+","+t*d+"Z":"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+u+",1 "+i*f+","+i*h+"L0,0Z"}var e=ao,n=io,r=oo,a=lo;return t.innerRadius=function(n){return arguments.length?(e=Ce(n),t):e},t.outerRadius=function(e){return arguments.length?(n=Ce(e),t):n},t.startAngle=function(e){return arguments.length?(r=Ce(e),t):r},t.endAngle=function(e){return arguments.length?(a=Ce(e),t):a},t.centroid=function(){var t=(e.apply(this,arguments)+n.apply(this,arguments))/2,i=(r.apply(this,arguments)+a.apply(this,arguments))/2+Mu;return[Math.cos(i)*t,Math.sin(i)*t]},t};var Mu=-Dl,ku=Ll-Nl;$o.svg.line=function(){return so(Te)};var wu=$o.map({linear:uo,"linear-closed":co,step:fo,"step-before":ho,"step-after":po,basis:bo,"basis-open":Ao,"basis-closed":Mo,bundle:ko,cardinal:yo,"cardinal-open":go,"cardinal-closed":vo,monotone:Do});wu.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Cu=[0,2/3,1/3,0],Tu=[0,1/3,2/3,0],Su=[0,1/6,2/3,1/6];$o.svg.line.radial=function(){var t=so(No);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ho.reverse=po,po.reverse=ho,$o.svg.area=function(){return _o(Te)},$o.svg.area.radial=function(){var t=_o(No);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},$o.svg.chord=function(){function t(t,l){var s=e(this,i,t,l),u=e(this,o,t,l);return"M"+s.p0+r(s.r,s.p1,s.a1-s.a0)+(n(s,u)?a(s.r,s.p1,s.r,s.p0):a(s.r,s.p1,u.r,u.p0)+r(u.r,u.p1,u.a1-u.a0)+a(u.r,u.p1,s.r,s.p0))+"Z"}function e(t,e,n,r){var a=e.call(t,n,r),i=l.call(t,a,r),o=s.call(t,a,r)+Mu,c=u.call(t,a,r)+Mu;return{r:i,a0:o,a1:c,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(c),i*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function r(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Sl)+",1 "+e}function a(t,e,n,r){return"Q 0,0 "+r}var i=mr,o=xr,l=Po,s=oo,u=lo;return t.radius=function(e){return arguments.length?(l=Ce(e),t):l},t.source=function(e){return arguments.length?(i=Ce(e),t):i},t.target=function(e){return arguments.length?(o=Ce(e),t):o},t.startAngle=function(e){return arguments.length?(s=Ce(e),t):s},t.endAngle=function(e){return arguments.length?(u=Ce(e),t):u},t},$o.svg.diagonal=function(){function t(t,a){var i=e.call(this,t,a),o=n.call(this,t,a),l=(i.y+o.y)/2,s=[i,{x:i.x,y:l},{x:o.x,y:l},o];return s=s.map(r),"M"+s[0]+"C"+s[1]+" "+s[2]+" "+s[3]}var e=mr,n=xr,r=Io;return t.source=function(n){return arguments.length?(e=Ce(n),t):e},t.target=function(e){return arguments.length?(n=Ce(e),t):n},t.projection=function(e){return arguments.length?(r=e,t):r},t},$o.svg.diagonal.radial=function(){var t=$o.svg.diagonal(),e=Io,n=t.projection;return t.projection=function(t){return arguments.length?n(Vo(e=t)):e},t},$o.svg.symbol=function(){function t(t,r){return(Lu.get(e.call(this,t,r))||Eo)(n.call(this,t,r))}var e=zo,n=Fo;return t.type=function(n){return arguments.length?(e=Ce(n),t):e},t.size=function(e){return arguments.length?(n=Ce(e),t):n},t};var Lu=$o.map({circle:Eo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Pu)),n=e*Pu;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/_u),n=e*_u/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/_u),n=e*_u/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});$o.svg.symbolTypes=Lu.keys();var Du,Nu,_u=Math.sqrt(3),Pu=Math.tan(30*Pl),Iu=[],Vu=0;Iu.call=xl.call,Iu.empty=xl.empty,Iu.node=xl.node,Iu.size=xl.size,$o.transition=function(t){return arguments.length?Du?t.transition():t:Ml.transition()},$o.transition.prototype=Iu,Iu.select=function(t){var e,n,r,a=this.id,i=[];t=C(t);for(var o=-1,l=this.length;++o<l;){i.push(e=[]);for(var s=this[o],u=-1,c=s.length;++u<c;)(r=s[u])&&(n=t.call(r,r.__data__,u,o))?("__data__"in r&&(n.__data__=r.__data__),Oo(n,u,a,r.__transition__[a]),e.push(n)):e.push(null)}return Go(i,a)},Iu.selectAll=function(t){var e,n,r,a,i,o=this.id,l=[];t=T(t);for(var s=-1,u=this.length;++s<u;)for(var c=this[s],d=-1,f=c.length;++d<f;)if(r=c[d]){i=r.__transition__[o],n=t.call(r,r.__data__,d,s),l.push(e=[]);for(var h=-1,p=n.length;++h<p;)(a=n[h])&&Oo(a,h,o,i),e.push(a)}return Go(l,o)},Iu.filter=function(t){var e,n,r,a=[];"function"!=typeof t&&(t=E(t));for(var i=0,o=this.length;o>i;i++){a.push(e=[]);for(var n=this[i],l=0,s=n.length;s>l;l++)(r=n[l])&&t.call(r,r.__data__,l,i)&&e.push(r)}return Go(a,this.id)},Iu.tween=function(t,e){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(t):Y(this,null==e?function(e){e.__transition__[n].tween.remove(t)}:function(r){r.__transition__[n].tween.set(t,e)})},Iu.attr=function(t,e){function n(){this.removeAttribute(l)}function r(){this.removeAttributeNS(l.space,l.local)}function a(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(l);return n!==t&&(e=o(n,t),function(t){this.setAttribute(l,e(t))})})}function i(t){return null==t?r:(t+="",function(){var e,n=this.getAttributeNS(l.space,l.local);return n!==t&&(e=o(n,t),function(t){this.setAttributeNS(l.space,l.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var o="transform"==t?Ra:ya,l=$o.ns.qualify(t);return Yo(this,"attr."+t,e,l.local?i:a)},Iu.attrTween=function(t,e){function n(t,n){var r=e.call(this,t,n,this.getAttribute(a));return r&&function(t){this.setAttribute(a,r(t))}}function r(t,n){var r=e.call(this,t,n,this.getAttributeNS(a.space,a.local));return r&&function(t){this.setAttributeNS(a.space,a.local,r(t))}}var a=$o.ns.qualify(t);return this.tween("attr."+t,a.local?r:n)},Iu.style=function(t,e,n){function r(){this.style.removeProperty(t)}function a(e){return null==e?r:(e+="",function(){var r,a=tl.getComputedStyle(this,null).getPropertyValue(t);return a!==e&&(r=ya(a,e),function(e){this.style.setProperty(t,r(e),n)})})}var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.style(n,t[n],e);return this}n=""}return Yo(this,"style."+t,e,a)},Iu.styleTween=function(t,e,n){function r(r,a){var i=e.call(this,r,a,tl.getComputedStyle(this,null).getPropertyValue(t));return i&&function(e){this.style.setProperty(t,i(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,r)},Iu.text=function(t){return Yo(this,"text",t,Ro)},Iu.remove=function(){return this.each("end.transition",function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)})},Iu.ease=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof t&&(t=$o.ease.apply($o,arguments)),Y(this,function(n){n.__transition__[e].ease=t}))},Iu.delay=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].delay:Y(this,"function"==typeof t?function(n,r,a){n.__transition__[e].delay=+t.call(n,n.__data__,r,a)}:(t=+t,function(n){n.__transition__[e].delay=t}))},Iu.duration=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].duration:Y(this,"function"==typeof t?function(n,r,a){n.__transition__[e].duration=Math.max(1,t.call(n,n.__data__,r,a))}:(t=Math.max(1,t),function(n){n.__transition__[e].duration=t}))},Iu.each=function(t,e){var n=this.id;if(arguments.length<2){var r=Nu,a=Du;Du=n,Y(this,function(e,r,a){Nu=e.__transition__[n],t.call(e,e.__data__,r,a)}),Nu=r,Du=a}else Y(this,function(r){var a=r.__transition__[n];(a.event||(a.event=$o.dispatch("start","end"))).on(t,e)});return this},Iu.transition=function(){for(var t,e,n,r,a=this.id,i=++Vu,o=[],l=0,s=this.length;s>l;l++){o.push(t=[]);for(var e=this[l],u=0,c=e.length;c>u;u++)(n=e[u])&&(r=Object.create(n.__transition__[a]),r.delay+=r.duration,Oo(n,u,i,r)),t.push(n)}return Go(o,i)},$o.svg.axis=function(){function t(t){t.each(function(){var t,u=$o.select(this),c=this.__chart__||n,d=this.__chart__=n.copy(),f=null==s?d.ticks?d.ticks.apply(d,l):d.domain():s,h=null==e?d.tickFormat?d.tickFormat.apply(d,l):Te:e,p=u.selectAll(".tick").data(f,d),g=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Nl),v=$o.transition(p.exit()).style("opacity",Nl).remove(),y=$o.transition(p.order()).style("opacity",1),m=Math.max(a,0)+o,x=Ei(d),b=u.selectAll(".domain").data([0]),A=(b.enter().append("path").attr("class","domain"),$o.transition(b));g.append("line"),g.append("text");var M,k,w,C,T=g.select("line"),S=y.select("line"),L=p.select("text").text(h),D=g.select("text"),N=y.select("text"),_="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(t=Bo,M="x",w="y",k="x2",C="y2",L.attr("dy",0>_?"0em":".71em").style("text-anchor","middle"),A.attr("d","M"+x[0]+","+_*i+"V0H"+x[1]+"V"+_*i)):(t=Xo,M="y",w="x",k="y2",C="x2",L.attr("dy",".32em").style("text-anchor",0>_?"end":"start"),A.attr("d","M"+_*i+","+x[0]+"H0V"+x[1]+"H"+_*i)),T.attr(C,_*a),D.attr(w,_*m),S.attr(k,0).attr(C,_*a),N.attr(M,0).attr(w,_*m),d.rangeBand){var P=d,I=P.rangeBand()/2;c=d=function(t){return P(t)+I}}else c.rangeBand?c=d:v.call(t,d,c);g.call(t,c,d),y.call(t,d,d)})}var e,n=$o.scale.linear(),r=Fu,a=6,i=6,o=3,l=[10],s=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(r=e in zu?e+"":Fu,t):r},t.ticks=function(){return arguments.length?(l=arguments,t):l},t.tickValues=function(e){return arguments.length?(s=e,t):s},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(a=+e,i=+arguments[n-1],t):a},t.innerTickSize=function(e){return arguments.length?(a=+e,t):a},t.outerTickSize=function(e){return arguments.length?(i=+e,t):i},t.tickPadding=function(e){return arguments.length?(o=+e,t):o},t.tickSubdivide=function(){return arguments.length&&t},t};var Fu="bottom",zu={top:1,right:1,bottom:1,left:1};$o.svg.brush=function(){function t(i){i.each(function(){var i=$o.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",a).on("touchstart.brush",a),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var l=i.selectAll(".resize").data(p,Te);l.exit().remove(),l.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Eu[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),l.style("display",t.empty()?"none":null);var c,d=$o.transition(i),f=$o.transition(o);s&&(c=Ei(s),f.attr("x",c[0]).attr("width",c[1]-c[0]),n(d)),u&&(c=Ei(u),f.attr("y",c[0]).attr("height",c[1]-c[0]),r(d)),e(d)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+c[+/e$/.test(t)]+","+d[+/^s/.test(t)]+")"})}function n(t){t.select(".extent").attr("x",c[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function r(t){t.select(".extent").attr("y",d[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function a(){function a(){32==$o.event.keyCode&&(L||(m=null,N[0]-=c[1],N[1]-=d[1],L=2),A())}function p(){32==$o.event.keyCode&&2==L&&(N[0]+=c[1],N[1]+=d[1],L=0,A())}function g(){var t=$o.mouse(b),a=!1;x&&(t[0]+=x[0],t[1]+=x[1]),L||($o.event.altKey?(m||(m=[(c[0]+c[1])/2,(d[0]+d[1])/2]),N[0]=c[+(t[0]<m[0])],N[1]=d[+(t[1]<m[1])]):m=null),T&&v(t,s,0)&&(n(w),a=!0),S&&v(t,u,1)&&(r(w),a=!0),a&&(e(w),k({type:"brush",mode:L?"move":"resize"}))}function v(t,e,n){var r,a,l=Ei(e),s=l[0],u=l[1],p=N[n],g=n?d:c,v=g[1]-g[0];return L&&(s-=p,u-=v+p),r=(n?h:f)?Math.max(s,Math.min(u,t[n])):t[n],L?a=(r+=p)+v:(m&&(p=Math.max(s,Math.min(u,2*m[n]-r))),r>p?(a=r,r=p):a=p),g[0]!=r||g[1]!=a?(n?o=null:i=null,g[0]=r,g[1]=a,!0):void 0}function y(){g(),w.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),$o.select("body").style("cursor",null),_.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),D(),k({type:"brushend"})}var m,x,b=this,M=$o.select($o.event.target),k=l.of(b,arguments),w=$o.select(b),C=M.datum(),T=!/^(n|s)$/.test(C)&&s,S=!/^(e|w)$/.test(C)&&u,L=M.classed("extent"),D=j(),N=$o.mouse(b),_=$o.select(tl).on("keydown.brush",a).on("keyup.brush",p);if($o.event.changedTouches?_.on("touchmove.brush",g).on("touchend.brush",y):_.on("mousemove.brush",g).on("mouseup.brush",y),w.interrupt().selectAll("*").interrupt(),L)N[0]=c[0]-N[0],N[1]=d[0]-N[1];else if(C){var P=+/w$/.test(C),I=+/^n/.test(C);x=[c[1-P]-N[0],d[1-I]-N[1]],N[0]=c[P],N[1]=d[I]}else $o.event.altKey&&(m=N.slice());w.style("pointer-events","none").selectAll(".resize").style("display",null),$o.select("body").style("cursor",M.style("cursor")),k({type:"brushstart"}),g()}var i,o,l=k(t,"brushstart","brush","brushend"),s=null,u=null,c=[0,0],d=[0,0],f=!0,h=!0,p=Gu[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:c,y:d,i:i,j:o},n=this.__chart__||e;this.__chart__=e,Du?$o.select(this).transition().each("start.brush",function(){i=n.i,o=n.j,c=n.x,d=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=ma(c,e.x),r=ma(d,e.y);return i=o=null,function(a){c=e.x=n(a),d=e.y=r(a),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=e.i,o=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(s=e,p=Gu[!s<<1|!u],t):s},t.y=function(e){return arguments.length?(u=e,p=Gu[!s<<1|!u],t):u},t.clamp=function(e){return arguments.length?(s&&u?(f=!!e[0],h=!!e[1]):s?f=!!e:u&&(h=!!e),t):s&&u?[f,h]:s?f:u?h:null},t.extent=function(e){var n,r,a,l,f;return arguments.length?(s&&(n=e[0],r=e[1],u&&(n=n[0],r=r[0]),i=[n,r],s.invert&&(n=s(n),r=s(r)),n>r&&(f=n,n=r,r=f),(n!=c[0]||r!=c[1])&&(c=[n,r])),u&&(a=e[0],l=e[1],s&&(a=a[1],l=l[1]),o=[a,l],u.invert&&(a=u(a),l=u(l)),a>l&&(f=a,a=l,l=f),(a!=d[0]||l!=d[1])&&(d=[a,l])),t):(s&&(i?(n=i[0],r=i[1]):(n=c[0],r=c[1],s.invert&&(n=s.invert(n),r=s.invert(r)),n>r&&(f=n,n=r,r=f))),u&&(o?(a=o[0],l=o[1]):(a=d[0],l=d[1],u.invert&&(a=u.invert(a),l=u.invert(l)),a>l&&(f=a,a=l,l=f))),s&&u?[[n,a],[r,l]]:s?[n,r]:u&&[a,l])},t.clear=function(){return t.empty()||(c=[0,0],d=[0,0],i=o=null),t},t.empty=function(){return!!s&&c[0]==c[1]||!!u&&d[0]==d[1]},$o.rebind(t,l,"on")};var Eu={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Gu=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Yu=as.format=cs.timeFormat,Ru=Yu.utc,Ou=Ru("%Y-%m-%dT%H:%M:%S.%LZ");Yu.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?qo:Ou,qo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},qo.toString=Ou.toString,as.second=Ye(function(t){return new is(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),as.seconds=as.second.range,as.seconds.utc=as.second.utc.range,as.minute=Ye(function(t){return new is(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),as.minutes=as.minute.range,as.minutes.utc=as.minute.utc.range,as.hour=Ye(function(t){var e=t.getTimezoneOffset()/60;return new is(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),as.hours=as.hour.range,as.hours.utc=as.hour.utc.range,as.month=Ye(function(t){return t=as.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),as.months=as.month.range,as.months.utc=as.month.utc.range;var Bu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Xu=[[as.second,1],[as.second,5],[as.second,15],[as.second,30],[as.minute,1],[as.minute,5],[as.minute,15],[as.minute,30],[as.hour,1],[as.hour,3],[as.hour,6],[as.hour,12],[as.day,1],[as.day,2],[as.week,1],[as.month,1],[as.month,3],[as.year,1]],qu=Yu.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Ln]]),Uu={range:function(t,e,n){return $o.range(Math.ceil(t/n)*n,+e,n).map(jo)},floor:Te,ceil:Te};Xu.year=as.year,as.scale=function(){return Uo($o.scale.linear(),Xu,qu)};var ju=Xu.map(function(t){return[t[0].utc,t[1]]}),Hu=Ru.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Ln]]);ju.year=as.year.utc,as.scale.utc=function(){return Uo($o.scale.linear(),ju,Hu)},$o.text=Se(function(t){return t.responseText}),$o.json=function(t,e){return Le(t,"application/json",Ho,e)},$o.html=function(t,e){return Le(t,"text/html",Wo,e)},$o.xml=Se(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define($o):"object"==typeof module&&module.exports&&(module.exports=$o),this.d3=$o}(),function(t){t.fn.stocCharts=function(e){function n(){g=t(f).width(),v=t(f).height(),m=e,P=t(f).attr("id");var n=P+"_svg";p=d3.select("#"+P).append("svg").attr("width","100%").attr("height","100%").attr("id",P+"-svg").attr("class",n).attr("viewBox","0 0 "+Math.max(g,v)+" "+Math.min(g,v)).attr("preserveAspectRatio","xMinYMin"),d3.select("#tooltipChart").empty()&&H.appendToolTip()}function r(t){var e=t.sort(function(t,e){return parseInt(t)<parseInt(e)});return e}function a(t,e,n,r){var a=t*(Math.PI/180),i=e/Math.tan(a)+r;return i}function o(t,e){var n=t*(Math.PI/180),r=e/Math.tan(n);return r}function s(t){var e=50,n=2,r=60,l=200/1.73,s=(t.length*e,0),u=0,c=0,d=0,f=0,h=0,p=0,g=0,v={},y=[];for(v.arrayOfPolygons=y,i=1;i<=t.length;i++){var m,x,b={},A=[];for(b.coordinates=A,j=0;j<4;j++){0==j?(m=a(r,t[i-1],l,f),x=1==i?o(60,t[i-1]):+h+o(r,t[i-1]),s=m,c=x+n):1==j?(m+=l-2*m,x=1==i?o(60,t[i-1]):+g+o(r,t[i-1]),u=m,d=x+n):2==j?1==i?(m=l,x=0):(m=p,x=g):1==i?(m=0,x=0):(m=f,x=h);var M={x:m,y:x};b.coordinates.push(M)}f=s,h=c,p=u,g=d;var k={name:"Polygon-"+i,Percent:t[i-1],points:b.coordinates};v.arrayOfPolygons.push(k)}return v}function u(t){t.selectAll(".axis").select("path").style("display","none"),t.selectAll(".tick line").style("display","none"),t.selectAll("path.domain").style("display","none")}function c(t){var e=m,n=t.selectAll("text");n.style("font-size",e["font-size"],null),n.style("font-family",e["font-family"]),n.style("font-weight",e["font-weight"]),t.selectAll(".tick").selectAll("text").style("fill",e["tick-font-color"],null),t.selectAll(".title").selectAll("text").style("font-size",e.titleFontSize+"px"),t.selectAll(".legend").selectAll("text").style("fill",e.legendTextColor)}var d={attachWaterMark:function(){f.parent().css("background-repeat"," no-repeat"),f.parent().css("background-position","bottom right")}},f=t(this),h=t(f).attr("id");d.attachWaterMark(f);var p,g,v,m,b,A,M,C,T,S,L,D,N,_,P,I={left:10,right:35,top:5,bottom:35,scale:5},V=d3.time.format("%Y-%m-%d"),F=(d3.time.format("%b "),50),I={left:10,right:35,top:10,bottom:35,scale:50,areaLeft:60},E={drawYAxis:function(){var e=d3.select(".yaxis").append("svg").attr("width",40).attr("height",t(f).height());e.append("g").attr("class","y axis agnitio").attr("transform","translate(8,"+I.top+")").attr("stroke","black").attr("fill","none").call(b)},drawMulitpleLineChartWithSquare:function(e){for(var n,r,e=t.extend({lineArray:[],squareArray:[]},e),a=e.lineArray,i=e.squareArray,o=0;o<a.length;o++){var l=a[o],s=l.yFieldName,u=d3.extent(l.data,function(t){return t[s]});0==o?(n=u[0],r=u[1]):(n>u[0]&&(n=u[0]),r<u[1]&&(r=u[1]))}M.domain([n,r+3]);for(var o=0;o<a.length;o++){var l=a[o],c={};for(key in l)c[key]=l[key];$.drawLine(c)}for(var o=0;o<i.length;o++){var d=i[o],f={};for(key in d)f[key]=d[key];K.squareChart(f)}}},G={getValueToPercentageArray:function(t){for(var e=[],n=0,r=0;r<t.length;r++)n+=t[r];for(var r=0;r<t.length;r++)e.push(t[r]/n*100);return e}},Y={getLegendPositionArray:function(t,e,n){for(var r=6,a=.7*e,i=10,o=.05*n,l=[],s=10,u=0,c=0,d=0;d<t.length;d++){var f=t[d].toString(),h={x:0,y:0,endPos:0},p=0,g=.08*e,v=.05*e;30>g&&(g=30),20>v&&(v=20),p=0==d?g:l[d-1].endPos;var y=p+s+f.length*r+i+v;y>a&&(u++,p=g,y=p+s+f.length*r+i+v,c=u*o),h.x=p,h.y=c,h.endPos=y,h.textPos=p+s+i-5,l.push(h)}return l},showHorizontalLegend:function(t,e,n,r,a){for(var i=0,o=0;o<n.length;o++)i<n[o].toString().length&&(i=n[o].toString().length);i=7.5*i;for(var l,s=[],u={x:0,y:0,textXPos:0},c=5,d=Math.round(.9*t/(c+r+i)),o=0;o<n.length;o++){var u={};l=o%d==0?.025*t:l+c+r+i,u.x=l+3,o%d==0&&0!=o&&(e+=1.5*a),u.y=e,u.textXPos=l+c+r,s.push(u)}return s}},R={appendLabel:function(t,e,n,r,a,i,o){var l="black",s=300;isNaN(i)&&void 0===i||(l=i),isNaN(o)&&void 0===o||(s=o);var u=a.append("text");u.text(t).attr("transform","translate("+e+","+n+") rotate("+r+")").style("fill",l,"important").style("font-weight",500,"important")}},O={getMin:function(t){var e=d3.min(t);return e=0==e?e:0>e?1.5*e:.3*e},getMax:function(t){var e=d3.max(t);return e=0==e?e:e>0?1.3*e:.7*e}},B={leftMarginController:function(t){for(var e=0,n=0;n<t.length;n++)e<t[n].toString().length&&(e=t[n].toString().length);var r=8;return e=(e+1)*r,e+=20}},X={getTickArray:function(t,e,n){var r=[],a=Math.round((e-t)/(n-1)),i=t;r.push(i),n--;for(var o=1;n>o;o++)i+=a,r.push(i),o==n-1&&r.push(e);return r},getXTickArray:function(t,e,n,r){var a=[],i=13*n,o=Math.round(r/i),l=t;a.push(l);for(var s=(e-t)/o;e>l;)l=Math.floor(l+s),-1==a.indexOf(l)&&e>=l?a.push(l):l++;return a}},q={wrapText:function(t,e){t.each(function(){for(var t,n=d3.select(this),r=n.text().split(/\s+/).reverse(),a=[],i=0,o=1.1,l=n.attr("y"),s=parseFloat(n.attr("dy")),u=n.text(null).append("tspan").attr("x",0).attr("y",l).attr("dy",s+"em");t=r.pop();)a.push(t),u.text(a.join(" ")),u.node().getComputedTextLength()>e&&(a.pop(),u.text(a.join(" ")),a=[t],u=n.append("tspan").attr("x",0).attr("y",l).attr("dy",++i*o+s+"em").text(t))})}},U={showToolTip:function(e,n,r,a,i){var o=e.pageX,l=e.pageY,s=d3.svg.line().x(function(t,e){return h[e]}).y(function(t){return t}).interpolate("closed"),u=t(f).offset().left,c=t(f).offset().top,d=u+n/2,h=[],g=[],v=10,y=10,m=10,x=5,b=10*(r.toString().length+a.toString().length),A=u,M=c;if(d>=o){h[0]=o+v-A,h[1]=o+v+x-A,h[2]=o+v+x-A,h[3]=o+v+x+b-A,h[4]=o+v+x+b-A,h[5]=o+v+x-A,h[6]=o+v+x-A,g[0]=l-y-M,g[1]=l-y-x-M,g[2]=l-y-m-M,g[3]=l-y-m-M,g[4]=l-y+m-M,g[5]=l-y+m-M,g[6]=l-y+x-M;{p.append("path").attr("d",s(g)).attr("class","toolTipPath").attr("stroke",i).attr("stroke-width",2).attr("fill","#104162").style("opacity",1)}p.append("text").attr("x",o+v+x-A+b/2-7*(a.toString().length+r.toString().length)/2).attr("y",l-M-y).text(r+"  "+a).attr("id","toolTipText").attr("dy",".3em").attr("fill","white")}else{h[0]=o-v-A,h[1]=o-v-x-A,h[2]=o-v-x-A,h[3]=o-v-x-b-A,h[4]=o-v-x-b-A,h[5]=o-v-x-A,h[6]=o-v-x-A,g[0]=l-y-M,g[1]=l-y-x-M,g[2]=l-y-m-M,g[3]=l-y-m-M,g[4]=l-y+m-M,g[5]=l-y+m-M,g[6]=l-y+x-M;{p.append("path").attr("d",s(g)).attr("class","toolTipPath").attr("stroke",i).attr("stroke-width",2).attr("fill","#104162").style("opacity",1)}p.append("text").attr("x",o-v-x-A-b/2-7*(a.toString().length+r.toString().length)/2).attr("y",l-M-y).text(r+"  "+a).attr("id","toolTipText").attr("dy",".3em").attr("fill","white")}},hideTooTip:function(){p.select(".toolTipPath").remove(),p.select("#toolTipText").remove()}},H={appendToolTip:function(){var e='<div id="tooltipChart" style="z-index:999999;float:none;display:none; margin:0px; padding:0px; position:absolute; width:150px;"><div id="textContainer" style="width:150px; background-color:rgba(197,198,197,0.7); border-radius:5px; font-family:calibri; float:left; font-size:11px; padding:10px;">	<div class="xVal" style="text-align:center; font-size:13px;border-bottom:solid 1px #7b7b7b;background:url(http://stocinn.github.io/stocweb/img/tooltip-heading-bg.jpg) repeat-x;border-top-left-radius:5px; margin-top:-10px; margin-left:-10px;  margin-right:-10px;border-top-right-radius:7px; padding:5px 10px;">14 jan</div><div id="y-label" class="y-label label1" style="width:60%;display:none; font-weight:bold; float:left; text-align:left; padding:3px 0;">Auto Loans</div><div  class="yVal label1" style="width:40%; float:right;display:none; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label2" style="width:60%; float:left;display:none;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label2" style="width:40%;display:none; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label3" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label3" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label4" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label4" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label5" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label5" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label6" style="width:60%; float:left; font-weight:bold;text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label6" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>	</div>	<div id="rightHandIcon" style="position: relative; bottom:1px; height:31px; width:52px;	 background:url(http://stocinn.github.io/stocweb/img/toolTips-arrow.png) no-repeat;opacity:0.7; clear:both; float:right; bottom:0px; right:8px;">	 </div>	<div id="leftHandIcon" style="position: relative; bottom:1px; height:31px; width:52px;	 background:url(http://grafitome.github.io/img/toolTips-arrow-left.png) no-repeat;opacity:0.7; clear:both; float:left; bottom:0px; left:8px;">	 </div></div>';t("body").append(e)},appendToolTipOld:function(){var e="<div id='tooltipChart' style='display:none;position:absolute;background:rgba(0, 0, 0, 0.8); width:120px;  min-height: 40px; z-index:99999999 !important;box-shadow: inset 0 0 40px #222221;float:left; border-radius:5px; font-family: Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif;  color:white; text-shadow: 1px 0 1px #000;    '><div class='arrow' style='position: absolute;margin-left: -8px;font-size: 24px;color:#272726; text-shadow:none; top: 7px;'><i class='fa fa-caret-left'></i></div><div id='textContainer'><div   style='clear:both;width:100%;padding:2px 5px '><div style='width:50%;float:left;' class='xVal'></div></div><div  class='yContainer1 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label'  style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal' style='width:45%;margin-left:5%;float:left;'></div></div></div></div></div>";t("body").append(e)},showToolTip:function(e,n,r,a,i,o){var l,s=e.pageX;l=isNaN(o)?e.pageY:o;var u;u=n;var c;c=r;var d=t("#tooltipChart");t(d).find(".xVal").html(""),t(d).find(".xVal").html(c),t(d).find(".y-label").html(""),t(d).find(".yVal").html(""),t(d).find(".yVal").hide(),t(d).find(".y-label").hide();for(var h=0;h<i.length;h++){var p=i[h],g=h+1,v=".y-label.label"+g,y=".yVal.label"+g;t(d).find(v).html(p.headingName),t(d).find(y).html(p.headingVal),t(d).find(y).show(),t(d).find(v).show()}var m=s;if(t(".ps-scrollbar-x-rail"))try{m+=parseInt(t(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(x){}var b=t("body").find("#tooltipChart"),A=(t(b).find("#textContainer"),l-.98*t(b).height()),M=t(f).offset().left,k=.5*t(f).width();m>=M+k?(t(b).find("#rightHandIcon").show(),t(b).find("#leftHandIcon").hide(),m-=t(b).width()):(t(b).find("#rightHandIcon").hide(),t(b).find("#leftHandIcon").show()),t(b).css("left",m),t(b).css("top",A),t(b).show()},hideTooTip:function(){t("#tooltipChart").find(".yVal").html(""),d3.select("#tooltipChart").style("display","none")},showToolTipForBarWithMultipleLine:function(e,n,r,a,i,o){{var l,s=e.pageX;e.pageY-t(f).find("svg").offset().top-10}l=r,t("#draggLineToolTip").find(".xVal").html(a?"":l),o?t("#draggLineToolTip").find("#tooltip-dragger").show():t("#draggLineToolTip").find("#tooltip-dragger").hide(),d3.select("#draggLineToolTip").selectAll(".yDiv").style("display","none");var u=1;for(key in n){{t(".yContainer"+u).show()}d3.select("#y-label"+u).html(key+" "),d3.select("#yVal"+u).html(" "+n[key]),u++}var c=s+I.left;if(t(".ps-scrollbar-x-rail"))try{c+=parseInt(t(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(d){}var h=t("body").find("#draggLineToolTip"),p=t(h).find("#textContainer");t(window).width()-c<t("body").find("#draggLineToolTip").width()?(c-=t(h).width(),t(h).css("-ms-transform","rotate(-180deg) translate(15px)"),t(h).css("-webkit-transform","rotate(-180deg) translate(15px)"),t(h).css("transform","rotate(-180deg) translate(15px)"),t(p).css("-ms-transform"," translateY(10px) rotate(180deg)"),t(p).css("-webkit-transform","translateY(10px)  rotate(180deg)"),t(p).css("transform","translateY(10px) rotate(180deg)")):(t(h).css("-ms-transform",""),t(h).css("-webkit-transform",""),t(h).css("transform",""),t(p).css("-ms-transform",""),t(p).css("-webkit-transform",""),t(p).css("transform",""));var g=e.pageY-t(f).find("#draggLineToolTip").height()/2;null!=i?t("body").find("#draggLineToolTip").css("left",c):t("body").find("#draggLineToolTip").css("left",c-5),t("body").find("#draggLineToolTip").css("top",g-20),t("body").find("#draggLineToolTip").show()},hideMulitpleLineBarToolTip:function(){d3.select("#draggLineToolTip").style("display","none")},appendToolTipForBarWithMultipleLine:function(){var e="<div id='draggLineToolTip' style='display:none;position:absolute;background:rgba(0, 0, 0, 0.8); width:120px;  min-height: 40px; z-index:99999999 !important;box-shadow: inset 0 0 40px #222221;float:left; border-radius:5px; font-family: Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif;  color:white; text-shadow: 1px 0 1px #000;    '><div  id='tooltip-dragger' style='position: absolute;margin-left: -8px; border-left:solid 1px #000; min-height:250px; top:-100px;'></div><div class='arrow' style='position: absolute;margin-left: -8px;font-size: 24px;color:#272726; text-shadow:none; top: 7px;'><i class='fa fa-caret-left'></i></div><div id='textContainer'><div   style='clear:both;width:100%;padding:2px 5px '><div style='width:50%;float:left;' class='xVal'></div></div><div  class='yContainer1 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label1'  style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal1' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer2 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label2' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal2' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer3 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label3' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal3' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer4 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label4' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal4' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer5 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label5' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal5' style='width:42%;float:left;margin-left:8%;'></div></div></div></div></div>";
t("body").append(e)}},W={init:function(t,e,n,r,a,i){var o=Math.ceil(.15*e),l=Math.ceil(.5*e),s=Math.ceil(e/o),u=Math.ceil(n/l);t.selectAll(".hline").data(d3.range(s)).enter().append("line").attr("class","horizontalGridLine").attr("y1",function(t){return t*o+6}).attr("y2",function(t){return t*o+6}).attr("x1",function(){return 0}).attr("x2",function(){return n}).style("stroke",i).style("stroke-width",.3).attr("transform","translate("+r+","+a+")"),t.selectAll(".vline").data(d3.range(u)).enter().append("line").attr("class","verticalGridLine").attr("x1",function(t){return t*l}).attr("x2",function(t){return t*l}).attr("y1",function(){return 0}).attr("y2",function(){return e}).style("stroke",i).style("stroke-width",.1).attr("transform","translate("+r+","+a+")")}},$={drawLine:function(e){var n,e=t.extend({color:"red",axisColor:"blue",data:[],xFieldName:"",yFieldName:"",showAllTicks:!1,formatDate:"%b %d"},e);n=0==e.data.length?L:e.data;var r,a;if(r=""==e.xFieldName?N:e.xFieldName,a=""==e.yFieldName?_:e.yFieldName,0==t(f).find(".axis").length){var i=d3.time.format(e.formatDate);e.showAllTicks&&A.ticks(d3.time.days,1).tickFormat(i).tickSize(0).tickPadding(8),A.tickFormat(i).tickSize(0).tickPadding(8),p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-I.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(A).selectAll(".tick").each(function(t){var e=new Date(t);e=convertDateIntoYYMMDD(e),p.append("line").attr("class","horizontalGridLine").attr("x1",function(){return C(V.parse(e))}).attr("x2",function(){return C(V.parse(e))}).attr("y1",0).attr("y2",v-I.scale+10).attr("stroke","#F2F3F3")}),p.append("g").attr("class","y axis").attr("transform","translate("+(g-I.scale+10)+",3)").attr("fill",e.axisColor).call(b)}{var o=d3.svg.line().interpolate("linear").x(function(t){return C(V.parse(t[r]))+5}).y(function(t){return M(t[a])-10}),l=t(f).attr("id")+"_line"+_;p.append("path").attr("d",o(n)).attr("stroke",e.color).attr("class",l).attr("stroke-width","2").attr("fill","none").on("mouseover",function(){attachToolTip.showToolTip(d3.event)}).on("mouseleave",function(){attachToolTip.hideToolTip(d3.event)})}},drawBarWithMultipleLineAndCircle:function(e){function n(t,e){return(j=d3.svg.line().interpolate(t).x(function(t){return C(t.x)}).y(function(t){var e=I[t.name];return e(t.y)}))(e)}var e=t.extend({data:[],xAxis:[],marginLeft:40,marginRight:40,marginTop:60},e),r=e.xAxis.ticks;H.appendToolTipForBarWithMultipleLine();var a=e.data,i=[];i=d3.keys(e.data);var o=d3.scale.ordinal(),l=[],s=[];for(key in a){var u=a[key];l.push(u.color),s.push(u.data)}o.domain(i),o.range(l);for(var c=0,d=o.domain().map(function(t){return{name:t,values:a[t].data.map(function(n,r){return{x:r,y:n,timeIndex:e.xAxis.ticks[r],name:t,indicationLabel:a[t].indicationLabel}}),chartType:a[t].chartType,lineType:a[t].lineType}}),h={},y=0;y<d.length;y++)h[d[y].name]="legend-"+y;for(var x=[],k=0;k<d[0].values.length;k++){for(var u={},w=0;w<i.length;w++)u[i[w]]=d[w].values[k].y+":"+d[w].values[k].indicationLabel;u.x=k,u.timeIndex=e.xAxis.ticks[k],x.push(u)}S=1.4*S,v-=1.5*e.marginTop;for(var L=!1,D=0,N=0,_=40,P=40,I={},y=0;y<i.length;y++){L=!L,L?N=N+e.marginRight+_:D=D+e.marginLeft+_,T=d3.min(a[i[y]].data,function(t){return t}),S=d3.max(a[i[y]].data,function(t){return t}),S=1.5*S,M=d3.scale.linear().domain([T,S]).range([v,0]),I[i[y]]=M;var V=X.getTickArray(T,S,5),F=p.append("g").attr("class","y axis").attr("transform",function(){return L?(b=d3.svg.axis().scale(M).orient("right").tickValues(V).tickSize(5,0),"translate("+(g-N)+","+e.marginTop+")"):(b=d3.svg.axis().scale(M).orient("left").tickValues(V).tickSize(5,0),"translate("+D+","+e.marginTop+")")}).attr("stroke",e.axisColor).attr("fill","none").call(b);if(F.selectAll("text").text(function(t){return t+" "+a[i[y]].unit}).style("fill",a[i[y]].color),L){var z=v/2+2*a[i[y]].indicationLabel.length;F.append("text").text(function(){return a[i[y]].indicationLabel}).attr("transform","translate("+(_+P)+","+z+") rotate(-90)").style("fill",a[i[y]].color)}else{var z=v/2+2*a[i[y]].indicationLabel.length;F.append("text").text(function(){return a[i[y]].indicationLabel}).attr("transform","translate("+(-_-P/2)+","+z+") rotate(-90)").style("fill",a[i[y]].color)}0==y&&F.selectAll(".tick").each(function(t){p.append("line").attr("class","horizontalGridLine").attr("x1",D).attr("x2",g-N).attr("y1",function(){return M(t)}).attr("y2",function(){return M(t)}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"})}g-=D;var E=p.append("g").attr("transform","translate("+(D-40)+","+e.marginTop+")").attr("class","grouping");C=d3.scale.linear().range([D,g-N]);var G=d3.min(d,function(t){return d3.min(t.values,function(t){return t.x})}),Y=d3.max(d,function(t){return d3.max(t.values,function(t){return t.x})});C.domain([G,Y]);for(var R=0,c=0;c<r.length;c++)R<r[c].toString().length&&(R=r[c].toString().length);A=d3.svg.axis().scale(C).orient("bottom").tickValues(X.getXTickArray(0,r.length-1,R,g-N-D));var O=p.append("g").attr("class","x axis").attr("transform","translate("+(D-40)+","+(v+e.marginTop)+")").attr("stroke",e.axisColor).attr("fill","none").call(A);O.selectAll("text").text(function(t){return r[t]}).style("fill",m.legendTextColor);var B=d.filter(function(t){return"bar"==t.chartType}),q=g/B[0].values.length;q/=2;var U=E.selectAll(".bar").data(B[0].values).enter().append("rect").attr("class",function(t){return"multichart bar "+h[t.name]+" pos_"+Math.floor(C(t.x))}).attr("width",q).attr("height",function(){return 0}).attr("x",function(){return 0}).attr("y",function(t){var e=I[t.name];return e(t.y)});U.transition().duration(1e3).attr("x",function(t){return C(t.x)-q/2}).attr("height",function(t){var e=I[t.name];return v-e(t.y)}).attr("fill",function(t){return o(t.name)});var j,W=E.selectAll("g.multipleLineGrouping").data(d.filter(function(t){return"bar"!=t.chartType})).enter().append("g").attr("class","multipleLineGrouping"),$=W.append("path").attr("d",function(t){return n(t.lineType,t.values)}).attr("class",function(t){return"multipleLine "+h[t.name]+" pos_"+Math.floor(C(t.x))}).attr("stroke",function(t){return o(t.name)}).attr("fill","none"),J=$.node().getTotalLength();$.attr("stroke-dasharray",function(t){for(var e=3,n=2*e,r=e;J>n;)r+=","+e+","+e,n+=2*e;return dottedLineParam=a[t.name].isDottedLine?r+","+J:J+","+J,dottedLineParam}).attr("stroke-dashoffset",J).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0),W.selectAll("circle.multipleLineCircle").data(function(t){return t.values}).enter().append("circle").attr("class",function(t){return"multichart  multipleLineCircle "+h[t.name]+" pos_"+Math.floor(C(t.x))}).attr("cx",function(t){return C(t.x)}).attr("cy",function(t){var e=I[t.name];return e(t.y)}).attr("r","3").attr("fill",function(t){return o(t.name)});var Z=(g-N)/o.domain().slice().length;Z=D+Z;var K=E.selectAll(".legend").data(o.domain().slice().reverse()).enter().append("g").attr("transform",function(t,e){return"translate("+Z*(e+1)/2+",0)"}),Q=18,te=10,ee=0,ne=ee+Q+te;K.append("rect").attr("x",ee).attr("width",12).attr("height",12).style("fill",o).attr("class",function(t){return"legend-rect "+h[t]}).on("click",function(e){if(-1!=d3.select(this).attr("class").indexOf("disable")){var n="legend-rect";d3.select(this).attr("class",n),d3.select(this).style("fill",o),p.select(".legend-text."+h[e]).style("text-decoration","none"),t(f).find(".multipleLineCircle."+h[e]).show();var r=p.selectAll(".multipleLine."+h[e]);r.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0),p.selectAll(".bar."+h[e]).transition().duration(1e3).attr("y",function(t){return M(t.y)}).attr("height",function(t){return v-M(t.y)})}else{t(this).addClass("disable");var n=t(this).attr("class");n+="  disable",d3.select(this).attr("class",n),d3.select(this).style("fill","grey"),p.select(".legend-text."+h[e]).style("text-decoration","line-through"),t(f).find(".multipleLineCircle."+h[e]).hide();var r=p.selectAll(".multipleLine."+h[e]);r.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",J),p.selectAll(".bar."+h[e]).transition().duration(1e3).attr("y",M(T)).attr("height",0)}}),K.append("text").attr("x",ne).attr("y",6).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+h[t]}).text(function(t){return t}).style("fill",m.legendTextColor),d3.selectAll(".multichart").on("mouseover",function(){var e=t(this).attr("class").split(" "),n=e[e.length-1];d3.selectAll("."+n).attr("stroke","blue");for(var r,a=d3.selectAll("circle."+n).attr("cx"),o=Math.floor(Math.floor(C.invert(a))),l=0;l<x.length;l++)x[l].x==o&&(r=x[l]);if(void 0!==r){for(var s="",u={},l=0;l<i.length;l++){var c=i[l],d=r[c].split(":")[0],f=r[c].split(":")[1];s+=c+" : "+d+" : "+f+" ",u[f]=d}H.showToolTipForBarWithMultipleLine(d3.event,u,r.timeIndex,!1,a,!0)}else H.hideMulitpleLineBarToolTip()}).on("mouseout",function(){d3.selectAll(".multichart").attr("stroke",""),H.hideMulitpleLineBarToolTip()})}},J={drawBrushing:function(e){function n(){var t=d3.mouse(this);s=l.append("g").attr("transform","translate(0,"+I.top+")").attr("class","brushedArea").append("rect").attr("class","brushedArea").attr("x",t[0]).attr("y",M(S)).attr("width",0).attr("height",function(){return d}).style("fill","rgba(1,1,1,.3)"),p=t[0],l.on("mousemove",i),h=!0}function r(){return o}function a(){if(h=!1,g){g=!1;for(var n=r(),a=0,i=0,o=!1,s=!1,d=0;d<n.length;d++){{n[d]}u==d&&(a=d,console.error("*** matched**"),o=!0),c==d&&(i=d,s=!0,console.error("*** matched ending**"))}o&&s&&(n=n.slice(a,i+1),i>a+3?(t(f).find("svg g").empty(),t(f).find(".brushedArea").remove(),l.on("mousemove",null),l.on("mousedown",null),l.on("mouseup",null),e(n)):(alert("further  zooming is not feasible"),t(f).find(".brushedArea").remove()))}}function i(){if(console.log("Mosuemove"),h){t(f).find("#tooltipChart").hide();var e=d3.mouse(this),n=e[0]-p;s.attr("width",n),u=Math.round(C.invert(e[1])),c=Math.round(C.invert(e[0])),console.log(Math.round(C.invert(e[1]))+":::"+Math.round(C.invert(e[0]))),g=!0}}var o=data,l=d3.select("."+t(f).attr("id")+"_svg");l.on("mousedown",n).on("mouseup",a);var s,u,c,d=v-I.scale,h=!1,p=0,g=!1}},Z={barChart:function(e){var n,e=t.extend({color:"red",axisColor:"blue",data:[],hideYAxis:!1,widthOfBar:"",formatDate:"%b %d",showAllTicks:!1,yFieldName:"",textonBar:!1,yFieldName:"",padding:0,attachBrushEvent:!1,xAxisIndicationLabel:"",yAxisIndicationLabel:""},e);n=0==e.data.length?L:e.data;var r;r=""==e.yFieldName?_:e.yFieldName;var a;a=""==e.widthOfBar?Math.floor((g-I.scale)/n.length):e.widthOfBar;var i=t(f).attr("id"),o=i+"_rect_"+r;if(0==t(f).find(".axis").length){var l=d3.time.format(e.formatDate);e.showAllTicks&&A.ticks(d3.time.days,1).tickFormat(l).tickSize(0).tickPadding(8),A.tickFormat(l).tickSize(0).tickPadding(8);var s=p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-I.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(A);s.selectAll(".tick").each(function(t){var e=new Date(t);e=convertDateIntoYYMMDD(e),p.append("line").attr("class","horizontalGridLine").attr("x1",function(){return C(V.parse(e))}).attr("x2",function(){return C(V.parse(e))}).attr("y1",0).attr("y2",v-I.scale+10).attr("stroke","#F2F3F3")});var u=p.append("g").attr("class","y axis").attr("transform","translate("+(g-I.scale+10)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(b);u.selectAll(".tick").each(function(t){p.append("line").attr("class","horizontalGridLine").attr("x1",0).attr("x2",g-I.scale+10).attr("y1",function(){return M(t)+3}).attr("y2",function(){return M(t)+3}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"})}var c=p.selectAll("."+o).data(n).enter().append("rect").attr("class",o).attr("x",function(t){return C(V.parse(t[N]))+e.padding}).attr("y",function(t){return M(t[r])}).attr("width",a).attr("height",function(){return M(S)}).on("mouseover",function(t){var e=t[r];d3.select(this).attr("fill","red");var n=V.parse(t[N]),a=convertDateIntoYYMMDD(n);attachToolTip.showToolTip(d3.event,e,a,void 0)}).on("mouseleave",function(t){t[r];d3.select(this).attr("fill",e.color),attachToolTip.hideTooTip()});c.transition().duration(2e3).attr("height",function(t){return v-I.scale-M(t[r])}).attr("fill",e.color),e.textonBar&&p.selectAll(".barText").data(n).enter().append("text").text(function(t){return parseInt(t[r])}).attr("x",function(t){return C(V.parse(t[N]))+2.5}).attr("y",function(t){return M(t[r])+20}),e.attachBrushEvent&&J.drawBrushing(n)},mulipleBarChart:function(e){for(var n,r,e=t.extend({barChartArray:[]},e),a=e.barChartArray,i=0;i<a.length;i++){var o=a[i],l=o.yFieldName,s=d3.extent(o.data,function(t){return t[l]});0==i?(n=s[0],r=s[1]):(n>s[0]&&(n=s[0]),r<s[1]&&(r=s[1]))}M.domain([n,r+3]);for(var i=0;i<a.length;i++){var o=a[i],u={};for(key in o)u[key]=o[key];this.barChart(u)}},stackedBarChart:function(e){function n(n,a){o=d3.keys(r[0]).filter(function(t){var n;return n=t!=e.xFieldName&&void 0==a[t]&&"groupedData"!=t&&"total"!=t});var s=r;s.forEach(function(t){var e=0;t.groupedData=o.map(function(n){return{x:t[N],y0:e,y1:e+=+t[n],name:n,exactYVal:t[n]}}),t.total=t.groupedData[t.groupedData.length-1].y1}),S=d3.max(s,function(t){return t.total}),T=d3.min(s,function(t){return t.total}),S=1.5*S;var d=d3.scale.linear().domain([0,S]).range([v,0]);b=d3.svg.axis().scale(d).orient("right").ticks(4).tickSize(5,0).tickFormat(d3.format(".2s")),p.select(".y.axis").call(b).selectAll(".tick").each(function(t){p.selectAll(".horizontalGridLine").attr("x1",0).attr("x2",g).attr("y1",function(){return d(t)}).attr("y2",function(){return d(t)}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"});var f=p.selectAll("g.stack-grouping").data(s).enter().append("g").attr("class","stack-grouping"),h=f.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return C(t.x)}).attr("y",function(){return d(0)}).attr("class",function(t){return l[t.name]+" bar"}).attr("width",C.rangeBand()).attr("height",function(){return 0}).style("fill",function(t){return i[t.name]}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var n=[{headingName:e.columnHeadingArray[t.name],headingVal:t.exactYVal}];H.showToolTip(d3.event,"",t.x,!1,n,.9*d3.event.pageY)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),H.hideTooTip()});h.transition().duration(2e3).attr("height",function(t){return d(t.y0)-d(t.y1)}).attr("y",function(t){return d(t.y1)}).attr("fill",function(t){return i[t.name]}),u(p),c(p)}var e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"black",hideAxis:!1,showAllTicks:!1,redrawing:!0,columnHeadingArray:[],xAxisIndicationLabel:"",yAxisIndicationLabel:""},e);g=g-F-I.left,v-=.25*v;var r=e.data;N=e.xFieldName;var a,i=(d3.layout.stack(),e.colorArray);a=""==e.widthOfBar?Math.floor(g/data.length):e.widthOfBar;for(var o=d3.keys(r[0]).filter(function(t){return t!=e.xFieldName}),l={},s=0;s<o.length;s++)l[o[s]]="legend-"+s;var d=r;d.forEach(function(t){var e=0;t.groupedData=o.map(function(n){return{x:t[N],y0:e,y1:e+=+t[n],name:n,exactYVal:t[n]}}),t.total=t.groupedData[t.groupedData.length-1].y1});for(var h=0;h<d.length;h++){d[h].groupedData}S=d3.max(d,function(t){return t.total}),T=d3.min(d,function(t){return t.total}),S=1.5*S,M=d3.scale.linear().domain([0,S]).range([v,0]),p=p.append("g").attr("transform","translate(0,"+I.top+")"),C=d3.scale.ordinal().rangeRoundBands([0,g],.1),C.domain(d.map(function(t){return t[N]})),A=d3.svg.axis().scale(C).orient("bottom"),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0).tickFormat(d3.format(".2s"));var y=p.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").attr("fill","none").call(A);y.selectAll("text").attr("transform","translate(0,15) rotate(0)"),y.selectAll("text").call(q.wrapText,C.rangeBand());var x=p.append("g").attr("class","y axis").attr("transform","translate("+g+",0)").attr("fill","none").call(b);if(x.selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"}),""!=e.xAxisIndicationLabel){var k=20,w=(I.scale-k/3,v+I.scale-k,v+I.scale+k,6),L=e.xAxisIndicationLabel.toString().length*w,D=.2*v,_=g/2-L/2;R.appendLabel(e.xAxisIndicationLabel,_,D,0,y,m.xLabelColor,600)}if(""!=e.yAxisIndicationLabel){var P=40,V=v/2-20,z=V+P,E=(g+I.scale-I.left+10,p.append("g").attr("transform","translate("+(g+F-I.left+5)+","+(z+30)+")"));R.appendLabel(e.yAxisIndicationLabel,0,.4*-(z+30),90,E,m.yLabelColor,600)}var G=p.selectAll("g.stack-grouping").data(d).enter().append("g").attr("class","stack-grouping"),Y=G.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return C(t.x)}).attr("y",function(){return M(0)}).attr("class",function(t){return l[t.name]+" bar"}).attr("width",C.rangeBand()).attr("height",function(){return 0}).style("fill",function(t){return i[t.name]}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var n=[{headingName:e.columnHeadingArray[t.name],headingVal:t.exactYVal}];H.showToolTip(d3.event,"",t.x,!1,n,.9*d3.event.pageY)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),H.hideTooTip()});Y.transition().duration(1e3).attr("height",function(t){return M(t.y0)-M(t.y1)}).attr("y",function(t){return M(t.y1)});var O=d3.keys(i),B=p.selectAll(".legend").data(O).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate("+I.left+","+(10+20*e)+")"}),X=18,U=10,j=0,W=j+X+U,$={};B.append("rect").attr("x",j).attr("width",18).attr("height",18).style("fill",function(t){return i[t]}).on("click",function(e){var r=!1;t("rect."+l[e]).length>1?(r=!0,$[e]=e,d3.select(this).style("text-decoration","grey"),d3.select(".legend-text."+l[e]).style("text-decoration","line-through")):(r=!1,delete $[e],d3.select(this).style("fill",i[e]),d3.select(".legend-text."+l[e]).style("text-decoration","none")),t(f).find("rect.bar").remove(),t(f).find("g.stack-grouping").remove(),n(e,$)}),B.append("text").attr("x",W).attr("y",9).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+l[t]}).text(function(t){return t}),u(p),c(p)},groupedBarChart:function(e){function n(t,n){s=d3.keys(l[0]).filter(function(t){var r;return r=t!=e.xFieldName&&void 0==n[t]&&"groupedData"!=t&&"timeIndex"!=t});l.forEach(function(t,e){t.groupedData=s.map(function(e){return{xVal:e,yVal:t[e],xFieldName:t[N]}}),t.timeIndex=e}),S=d3.max(i,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),S=1.5*S,M.domain([0,S]),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0),x.domain(s).rangeRoundBands([0,y.rangeBand()]),p.selectAll(".y.axis").call(b);{var r=p.selectAll("g.bar-grouping").data(l).enter().append("g").attr("class","bar-grouping").attr("transform",function(){return"translate("+y(0)+",0)"});r.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return x(t.xVal)}).attr("y",function(t){return M(t.yVal)}).attr("class",function(t){return"groupBar "+d[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",x.rangeBand()/1.2).attr("height",function(t){return v-M(t.yVal)}).attr("xFieldVal",function(t){return t.xFieldVal}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var n=(d3.select(this).attr("xFieldVal"),[{headingName:t.xVal,headingVal:t.yVal}]);H.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldName,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),H.hideTooTip()})}r.transition().duration(function(t,e){return 190*e}).attr("transform",function(t){return"translate("+y(t.timeIndex)+",0)"}),u(p),c(p)}var e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"#a7a7a7",hideAxis:!1,yIndicationLabel:"Value"},e),r=45;g=g-F-I.left,v=v-r-I.top;var a,i=(d3.layout.stack(),[]),o="";o=d3.scale.category20;var l=(e.colors,e.data);N=e.xFieldName,a=""==e.widthOfBar?Math.floor(g/l.length):e.widthOfBar;var s=d3.keys(l[0]).filter(function(t){return t!=e.xFieldName});l.forEach(function(t,e){t.groupedData=s.map(function(n){return{xVal:n,yVal:t[n],timeIndex:e,xFieldVal:t[N]}}),t.timeIndex=e}),W.init(p,v,g,I.left,.2*v,m.gridLineColor);for(var d={},h=0;h<s.length;h++)d[s[h]]="legend-"+h;i=l,C=d3.time.scale().range([0,g],.5),C.domain(d3.extent(l,function(t){return t.timeIndex}));var y=d3.scale.ordinal().rangeRoundBands([0,g],.5),x=d3.scale.ordinal();y.domain(i.map(function(t){return t.timeIndex})),x.domain(s).rangeRoundBands([0,y.rangeBand()]),M=d3.scale.linear().range([v,0]),S=d3.max(i,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),S=1.5*S,M.domain([0,S]),p=p.append("g").attr("transform","translate("+I.left+","+I.top+")");for(var k=0,w=[],T=0;T<i.length;T++)w[T]=i[T][N],k<w[T].toString().length&&(k=w[T].toString().length);A=d3.svg.axis().scale(y).orient("bottom").tickValues(X.getXTickArray(0,w.length,k,g)),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0);var L=p.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").attr("fill",e.axisColor).attr("fill","none").call(A);L.selectAll("text").text(function(t){return w[t]}).attr("fill","black");var D=p.append("g").attr("class","y axis").attr("transform","translate("+g+",0)").attr("fill",e.axisColor).attr("fill","none");D.call(b).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});var _=v/1.5+e.yAxisfactor.length/2*5,P=1.2*I.right;R.appendLabel(e.yAxisfactor,P,_,-90,D,m.yLabelColor,600);var V=6,z=e.xAxisfactor.length*V,E=g/2-z/2,G=r-5;R.appendLabel(e.xAxisfactor,E,G,0,L,m.xLabelColor,600);var V=9,Y=(g+F+I.left)/2-e.title.length*V/2,O=p.append("g").attr("class","title");R.appendLabel(e.title,Y,.06*v,0,O,m.chartTitleColor,800);var B=p.selectAll("g.bar-grouping").data(i).enter().append("g").attr("class","bar-grouping").attr("transform",function(t){return"translate("+y(t.timeIndex)+",0)"}),q=B.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(){return x(0)}).attr("y",function(){return M(0)}).attr("class",function(t){return"groupBar "+d[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",x.rangeBand()/1.2).attr("height",function(t){return v-M(t.yVal)}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var n=[{headingName:t.xVal,headingVal:t.yVal}];H.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldVal,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),H.hideTooTip()});q.transition().duration(function(t,e){return 600*e}).attr("x",function(t){return x(t.xVal)}).attr("y",function(t){return M(t.yVal)});var U=p.selectAll(".legend").data(s).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+(10+20*e)+")"}),j=10,$=5,J=0,Z=J+j+$,K={};U.append("rect").attr("x",J).attr("width",10).attr("height",10).style("fill",function(t){return e.colors[t]}).attr("index",function(t,e){return e}).on("click",function(r){{var a=!1;parseInt(d3.select(this).attr("index"))}p.selectAll("rect."+d[r]).empty()?(a=!1,delete K[r],d3.select(this).style("fill",function(t){return e.colors[t]}),p.select(".legend-text."+d[r]).style("text-decoration","none")):(a=!0,K[r]=r,d3.select(this).style("fill","grey"),p.select(".legend-text."+d[r]).style("text-decoration","line-through")),t(f).find("rect.groupBar").remove(),t(f).find(".bar-grouping").remove(),n(r,K)}),U.append("text").attr("x",Z).attr("y",4).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+d[t]}).text(function(t){return t}),u(p),c(p)},groupedBar2DChart:function(e,n){function r(t,n){d=d3.keys(s[0]).filter(function(t){var r;return r=t!=e.xFieldName&&void 0==n[t]&&"groupedData"!=t&&"timeIndex"!=t}),s.forEach(function(t,e){t.groupedData=d.map(function(e){return{xVal:e,yVal:t[e],xFieldName:t[N]}}),t.timeIndex=e});var r,i=s,o=d3.max(i,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),l=d3.min(i,function(t){return d3.min(t.groupedData,function(t){return t.yVal})});r=isNaN(a)?Math.ceil((o+l)/2):a,o=1.9*o,M.domain([l,o]),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0),k.domain(d).rangeRoundBands([0,x.rangeBand()]),p.selectAll(".horizontalGridLine").remove();var f=X.getTickArray(T,S,5);b.tickValues(f),p.selectAll(".y.axis").call(b).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});{var g=p.selectAll("g.bar-grouping").data(i).enter().append("g").attr("class","bar-grouping").attr("transform",function(){return"translate("+x(0)+",0)"});g.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return k(t.xVal)}).attr("y",function(t){return M(M(t.yVal)>=M(r)?r:t.yVal)}).attr("class",function(t){return"groupBar "+h[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",k.rangeBand()/1.2).attr("height",function(t){return M(t.yVal)>=M(r)?M(t.yVal)-M(r):M(r)-M(t.yVal)}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var n=[{headingName:t.xVal,headingVal:t.yVal}];H.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldName,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),H.hideTooTip()})}g.transition().duration(function(t,e){return 190*e}).attr("transform",function(t){return"translate("+x(t.timeIndex)+",0)"}),u(p),c(p)}var a,e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"#a7a7a7",hideAxis:!1,yIndicationLabel:"Value",midVal:""},e);a=isNaN(n)?"":n,g=g-F-I.left,v-=F,v=.9*v;var i,o=(d3.layout.stack(),[]),l="";l=d3.scale.category20;var s=(e.colors,e.data);N=e.xFieldName,i=""==e.widthOfBar?Math.floor(g/s.length):e.widthOfBar;var d=d3.keys(s[0]).filter(function(t){return t!=e.xFieldName});s.forEach(function(t,e){t.groupedData=d.map(function(e){return{xVal:e,yVal:t[e],xFieldVal:t[N]}}),t.timeIndex=e});for(var h={},y=0;y<d.length;y++)h[d[y]]="legend-"+y;o=s,C=d3.time.scale().range([0,g],.5),C.domain(d3.extent(s,function(t){return t.timeIndex}));var x=d3.scale.ordinal().rangeRoundBands([0,g],.5),k=d3.scale.ordinal();x.domain(o.map(function(t){return t.timeIndex})),k.domain(d).rangeRoundBands([0,x.rangeBand()]),M=d3.scale.linear().range([v,0]),S=d3.max(o,function(t){return d3.max(t.groupedData,function(t){return t.yVal})});var w,T=d3.min(o,function(t){return d3.min(t.groupedData,function(t){return t.yVal})});w=isNaN(a)?Math.ceil((S+T)/2):a,S=1.9*S,M.domain([T,S]),p=p.append("g").attr("transform","translate("+I.left+","+I.top+")");for(var L=0,D=[],_=0;_<o.length;_++)D[_]=o[_][N],L<D[_].toString().length&&(L=D[_].toString().length);A=d3.svg.axis().scale(x).orient("bottom").tickValues(X.getXTickArray(0,D.length,L,g)),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0);var P=p.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").attr("fill",e.axisColor).attr("fill","none");P.call(A).selectAll("text").text(function(t){return D[t]}).attr("fill","black");var V=p.append("g").attr("class","y axis").attr("transform","translate("+g+",0)").attr("fill",e.axisColor).attr("fill","none"),z=X.getTickArray(T,S,5);-1==z.indexOf(w)&&z.push(w),b.tickValues(z),V.call(b).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});var E=v/1.5+e.yAxisfactor.length/2*5,G=1.2*I.right;R.appendLabel(e.yAxisfactor,G,E,-90,V,m.yLabelColor,600);var Y=6,O=e.xAxisfactor.length*Y,B=g/2-O/2,q=.15*v;R.appendLabel(e.xAxisfactor,B,q,0,P,m.xLabelColor,600);var Y=9,U=(g+F+I.left)/2-e.title.length*Y/2,j=p.append("g").attr("class","title");R.appendLabel(e.title,U,.06*v,0,j,m.chartTitleColor,800);var W=p.selectAll("g.bar-grouping").data(o).enter().append("g").attr("class","bar-grouping").attr("transform",function(t){return"translate("+x(t.timeIndex)+",0)"}),$=W.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(){return k(0)}).attr("y",function(){return M(w)}).attr("class",function(t){return"groupBar "+h[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",k.rangeBand()/1.2).attr("height",function(t){return M(t.yVal)>M(w)?M(t.yVal)-M(w):M(w)-M(t.yVal)}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var n=[{headingName:t.xVal,headingVal:t.yVal}];H.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldVal,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),H.hideTooTip()});$.transition().duration(function(t,e){return 600*e}).attr("x",function(t){return k(t.xVal)}).attr("y",function(t){return M(M(t.yVal)>M(w)?w:t.yVal)});var J=p.selectAll(".legend").data(d).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+(10+20*e)+")"}),Z=10,K=10,Q=0,te=Q+Z+K,ee={};J.append("rect").attr("x",Q).attr("width",10).attr("height",10).style("fill",function(t){return e.colors[t]}).attr("index",function(t,e){return e}).on("click",function(n){{var a=!1;parseInt(d3.select(this).attr("index"))}p.selectAll("rect."+h[n]).empty()?(a=!1,delete ee[n],d3.select(this).style("fill",function(t){return e.colors[t]}),p.select(".legend-text."+h[n]).style("text-decoration","none")):(a=!0,ee[n]=n,d3.select(this).style("fill","grey"),p.select(".legend-text."+h[n]).style("text-decoration","line-through")),t(f).find("rect.groupBar").remove(),t(f).find(".bar-grouping").remove(),r(n,ee)}),J.append("text").attr("x",te).attr("y",4).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+h[t]}).text(function(t){return t}),u(p),c(p)},cricketAnalysis:function(t){for(var e={left:.1*g,right:.1*g,bottom:.2*v,top:.2*v,chartSeparator:5,xScalePaddingTop:.1*v,yScalePaddingLeft:.08*g},n=g-e.left-e.right,r=v-e.top-e.bottom,a=r+e.chartSeparator,i=e.bottom/3,o=a+i+e.chartSeparator,l=(e.bottom-i,t.data.tital),s=t.data.titalColor,u=t.data.yData,c=t.data.xData,d=t.data.xDatacolor,f=t.data.specialXData,h=t.data.specialDataLabel,y=t.data.specialData,m=t.data.specialXDataColor,x=t.data.specialXDataLabel,k=t.data.xLabelColor,w=t.data.yLabel,T=t.data.specialDataLabelOfWicket,S=(t.colorArray,t.xFieldName,t.yFieldName,t.axisColor),L=t.data.textColor,D=t.data["font-style"],N=10,_=30,P=50,I=14,V=14,F=14,z=[],E=u.length>c.length?u:c,G=0;G<E.length;G++){var Y={};u[G]&&(Y.y=u[G]),c[G]&&(Y.x=c[G]),f[G]&&(Y.specialX=f[G]),Y.timeIndex=G,z.push(Y)}C=d3.scale.linear().range([0,n]);var R=(d3.min(z,function(t){return t.x}),d3.max(z,function(t){return t.x}));C.domain([0,R]),M=d3.scale.linear().range([r,5.5]);var O=(d3.min(z,function(t){return t.y}),d3.max(z,function(t){return t.y}));O=1.5*O,M.domain([0,O]),p=p.append("g").attr("transform","translate("+e.left+","+e.top+")"),A=d3.svg.axis().scale(C).orient("bottom").ticks(10),b=d3.svg.axis().scale(M).orient("left").tickValues(d3.range(3,O,O/4));var B=d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").style("padding","5px").text("a simple tooltip"),X=(p.append("g").attr("class","GridLineLImage"),p.append("g").attr("class","tital-Group-of-team").attr("transform","translate("+-e.yScalePaddingLeft+","+-e.top/1.5+")")),q=X.append("svg:defs").append("svg:linearGradient").attr("id","gradientTital").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");q.append("stop").attr("offset","0").attr("stop-color","#0e0c1a"),q.append("stop").attr("offset","0.5").attr("stop-color","#414463"),q.append("stop").attr("offset","1").attr("stop-color","#0e0c1a"),X.append("rect").attr("width",n+e.yScalePaddingLeft+15).attr("height",e.top/1.7).attr("fill","url(#gradientTital)"),X.append("text").attr("x",30).attr("y",30).style("font-size","22").style("fill",s).style("font-family",D).text(l[0]+" v "+l[1]);
{var U=p.append("g").attr("class","over-axis-grouping");U.append("rect").attr("class","over-axis-heading").attr("x",-e.yScalePaddingLeft).attr("y",a).attr("height",i).attr("width",e.yScalePaddingLeft).attr("fill","#131e4c")}U.append("text").attr("x",-e.yScalePaddingLeft/2).attr("y",a+i/2).attr("dy",".35em").attr("text-anchor","middle").text("OVERS").attr("fill",k).style("font-weight",400).style("font-family","Arial Black");var j=U.append("g").attr("class","over-scale-group").attr("transform","translate(0,"+a+")"),H=j.append("svg:defs").append("svg:linearGradient").attr("id","gradientOverAxis").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(90)");H.append("stop").attr("offset","0").attr("stop-color","#182051"),H.append("stop").attr("offset","0.5").attr("stop-color","#8289b5"),H.append("stop").attr("offset",".8").attr("stop-color","#182051"),j.append("rect").attr("x",0).attr("y",0).attr("width",n+15).attr("height",i).attr("fill","url(#gradientOverAxis)");var W=j.call(A);d3.select(".over-scale-group").attr("fill","none"),W.selectAll("text").attr("dy",".35em").text(function(t){return 0==parseInt(t)?"":t}).attr("transform","translate(0,"+i/6+")").style("fill","white").style("font-family",D);{var $=p.append("g").attr("class","wicket-axis");$.append("rect").attr("class","wicket-axis-heading").attr("x",-e.yScalePaddingLeft).attr("y",o).attr("height",3*i).attr("width",e.yScalePaddingLeft).attr("fill","#9c9ca6")}$.append("image").attr("x",-e.yScalePaddingLeft/1.5).attr("y",o).attr("width",_).attr("height",P).attr("xlink:href",T);var J=$.append("g").attr("class","wicket-scale-group").attr("transform","translate(0,"+o+")");J.append("rect").attr("class","show-wicket-in-over").attr("x",0).attr("y",0).attr("width",n+15).attr("height",2*i).attr("fill","#9c9ca6");var Z=[],K=[];for(key in y)for(nestedKey in y[key])for(batsman in y[key][nestedKey])K.push(batsman),Z.push(key);J.selectAll("img").data(K).enter().append("image").attr("value",function(t){return t}).attr("x",function(t,e){return C(Z[e])-5}).attr("y",function(t,e){for(var n=0,r=e;r>=0;r--)Z[r]==Z[e]&&n++;return 1.1*n*N-N}).attr("width",N).attr("height",N).attr("fill","red").attr("xlink:href",h).on("mouseover",function(){t:for(key in y)for(nestedKey in y[key])for(batsman in y[key][nestedKey])if(batsman==d3.select(this).attr("value"))break t;B.style("visibility","visible").style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px").text(d3.select(this).attr("value")+" "+y[key][nestedKey][batsman])}).on("mouseout",function(){B.style("visibility","hidden")});var Q=p.append("g").attr("class","y axis").attr("transform","translate("+-e.yScalePaddingLeft+",0)").attr("stroke",S).attr("fill","none");b.tickSize(0,50);var te=Q.append("svg:defs").append("svg:linearGradient").attr("id","gradientYAxis").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");te.append("stop").attr("offset","0").attr("stop-color","#9c9ca6"),te.append("stop").attr("offset","0.5").attr("stop-color","#ffffff"),te.append("stop").attr("offset","1").attr("stop-color","#9c9ca6"),Q.append("rect").attr("class","run-axis").attr("x",0).attr("y",0).style("stroke","none").attr("height",r).attr("width",e.yScalePaddingLeft).attr("fill","url(#gradientYAxis)");var ee=Q.call(b);ee.selectAll("text").attr("transform","translate("+e.yScalePaddingLeft+",0)").style("fill",L);var ne=p.append("g").attr("class","yaxislabel").attr("transform","translate("+2*-e.yScalePaddingLeft+","+2*e.bottom+")");ne.append("text").attr("x",0).attr("y",r/2.25).text(w).style("font-size","20").attr("transform","rotate(-90)").style("fill",L).style("font-family",D);var re=n/(z.length-1)*.5,ae=p.append("g").attr("class","simple-line").attr("transform","translate(0,0)");ae.append("line").attr("y1",function(){return 0}).attr("y2",function(){return r}).attr("x1",function(){return 0}).attr("x2",function(){return 0}).style("stroke","gray");var ie=p.append("g").attr("class","bar-rectangle").attr("transform","translate(0,0)"),oe=ie.append("svg:defs").append("svg:linearGradient").attr("id","gradientBar").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");oe.append("stop").attr("offset","0").attr("stop-color","#9c9ca6"),oe.append("stop").attr("offset","0.5").attr("stop-color","#ffffff"),oe.append("stop").attr("offset","1").attr("stop-color","#0e0c1a"),ie.append("rect").attr("class","run-bar").attr("x",0).attr("y",0).style("stroke","none").attr("height",r).attr("width",n+15).attr("fill","url(#gradientBar)");var le={init:function(t,e,n,r,a,i){var o=Math.ceil(.2*e),l=Math.ceil(e/o);t.selectAll(".hline").data(d3.range(l)).enter().append("line").attr("y1",function(t){return t*o+6}).attr("y2",function(t){return t*o+6}).attr("x1",function(){return 0}).attr("x2",function(){return n}).style("stroke",i).style("opacity",.5).attr("transform","translate("+r+","+a+")")}};le.init(p,r,n,e.xScalePaddingLeft,e.xScalePaddingTop,"#353b37");var se=p.append("g").attr("class","legend-grouping").attr("transform","translate("+e.yScalePaddingLeft/4+",3)");se.append("rect").attr("width",I).attr("height",V).attr("fill",m),se.append("text").attr("x",V+3).attr("y",V/2).style("font-size !important",F).style("fill",L).style("font-family",D).text(x);{var ue=p.append("g").attr("class","bar-grouping").attr("transform","translate(0,0)"),ce=ue.selectAll(".runs-bar").data(z).enter().append("rect").attr("class","runs-bar").attr("x",function(t){return C(t.x)-re/2}).attr("y",function(t){return M(t.y)+re/2-5.5}).attr("width",re).attr("height",function(){return 0}).attr("fill",function(t){return-1==f.indexOf(t.x)?d:m}).style("z-index",51);ue.selectAll("circle").data(z).enter().append("circle").attr("class","runs-bar").attr("cx",function(t){return C(t.x)}).attr("cy",function(t){return M(t.y)+re/2-5.5}).attr("r",re/2).attr("fill",function(t){return-1==f.indexOf(t.x)?d:m}).style("z-index",1)}ce.transition().duration(1e3).attr("height",function(t){return M(0)-M(t.y)}),p.selectAll("text").style("font-weight",500)},bulletBar:function(t){for(var e=t.title,n=t.xAxisLabel,r=t.yAxisLabel,a=t.yAxisData,i=t.xAxisData1,o=t.xAxisData2,l=t.colorOfData1,s=t.colorOfData2,d=t.xAxisLabelData1,f=t.xAxisLabelData2,h=B.leftMarginController(a),y={left:h,right:h,bottom:45,top:.1*v,chartSeparator:10,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},x=g-y.left-y.right,b=v-y.top-y.bottom,A=b/i.length*.5,M=[],k=0;k<a.length;k++)M[k]=k;W.init(p,b,x,y.left,y.top,m.gridLineColor);var w=p.append("g").attr("class","main-group").attr("transform","translate("+y.left+","+y.top+")"),C=d3.min(d3.min(i)<d3.min(o)?i:o),T=d3.max(d3.max(i)>d3.max(o)?i:o);T=0==T?maxData1+2:T>0?1.2*T:.8*T,0==C?C-=2:C=0>C?1.5*C:.1*C;var S=d3.scale.linear().domain([T,C]).range([0,.5*x]),L=d3.svg.axis().scale(S).orient("bottom").ticks(5),D=w.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+b+")").call(L);D.selectAll("text").style("font-size",13).attr("fill","black");var N=d3.scale.linear().domain([C,T]).range([.5*x,x]),_=d3.svg.axis().scale(N).orient("bottom").ticks(5),P=w.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+b+")").call(_);P.selectAll("text").style("font-size",13).attr("fill","black");var I=d3.scale.linear().domain([0,a.length-1]).range([b-.5*A,.5*A]),V=d3.svg.axis().scale(I).orient("left").tickValues(M);w.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(V).selectAll("text").text(function(t){return a[t]});var F=d3.scale.linear().domain([0,a.length-1]).range([b-.5*A,.5*A]),z=d3.svg.axis().scale(F).orient("left").tickValues(M);w.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate("+(x+.5*y.right)+",0)").call(z).selectAll("text").text(function(t){return a[t]});var E=w.selectAll(".rect").data(i).enter().append("rect").attr("x",function(){return S(C)}).attr("y",function(t,e){return I(e)-A/2}).attr("height",A).attr("width",function(){return 0}).attr("index",function(t,e){return e}).attr("fill",l).on("mousemove",function(){var t=parseInt(d3.select(this).attr("index")),e=a[t];e=r+" "+e;var o=i[t],l=[{headingName:d+" "+n,headingVal:o}];H.showToolTip(d3.event,"",e,!1,l,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});E.transition().duration(1500).attr("x",function(t){return S(t)}).attr("width",function(t){return S(C)-S(t)-2});var G=w.selectAll(".rect").data(o).enter().append("rect").attr("x",function(){return N(C)+2}).attr("y",function(t,e){return I(e)-A/2}).attr("height",A).attr("width",function(){return 0}).attr("index",function(t,e){return e}).attr("fill",s).on("mousemove",function(){var t=parseInt(d3.select(this).attr("index")),e=a[t];e=r+" "+e;var i=o[t],l=[{headingName:f+" "+n,headingVal:i}];H.showToolTip(d3.event,"",e,!1,l,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});G.transition().duration(1500).attr("width",function(t){return N(t)-S(C)-2});var Y=6,O=r.length*Y,X=b/2+O/2,q=-y.left+15,U=x+.7*y.left;R.appendLabel(r,q,X,-90,w,m.yLabelColor,600),R.appendLabel(r,U,X,-90,w,m.yLabelColor,600);var j=d.length*Y,$=x/4-j/2,J=f.length*Y,Z=.75*x-J/2,K=b+(y.bottom-5);R.appendLabel(d,$,K,0,w,m.xLabelColor,600),R.appendLabel(f,Z,K,0,w,m.xLabelColor,600);var Y=8,Q=g/2-e.length*Y/2,te=p.append("g").attr("class","title");R.appendLabel(e,Q,.35*y.top,0,te,m.chartTitleColor,800),u(p),c(p)},setYSclae:function(t,e){var n,r,a=d3.extent(data,function(e){return e[t]}),i=d3.extent(data,function(t){return t[e]}),o=a[0],l=a[1],s=i[0],u=i[1];n=o>s?s:o,r=l>u?l:u,T=n,S=r,M.domain([T,S])},barWithLogo:function(e){g=t(f).width(),v=.7*t(f).height(),P=t(f).attr("id"),t("#"+P).empty();var n=P+"_svg";p=d3.select("#"+P).append("svg").attr("width","100%").attr("height",v).attr("class",n).attr("viewBox","0 0 "+Math.max(g,v)+" "+Math.min(g,v)).attr("preserveAspectRatio","xMinYMin");for(var r=e.data.title,a=(e.data.titalColor,e.data.yData),i=e.data.xData,o=e.data.imagePathArray,l=e.data.xData,s=e.data.color,d=e.data.xIndicationLabel,y=e.data.yIndicationLabel,x=B.leftMarginController(a),k={left:x,right:.05*g,bottom:.05*v,top:.07*v,chartSeparator:5},w=g-k.left-k.right,L=v-k.top-k.bottom,D=w/a.length*.5,N=[],_=a.length>i.length?a:i,I=[],V=0;V<_.length;V++){var F={timeIndex:V,x:i[V],y:a[V],imagePath:o[V],name:l[V]};N.push(F),I.push(V)}C=d3.scale.linear().range([0,w-D]);var z=(N[0].timeIndex,N[N.length-1].timeIndex);C.domain([0,z]),M=d3.scale.linear().range([L,0]),T=O.getMin(a),S=O.getMax(a),M.domain([0,S]);var E=8,G=g/2-r.length*E/2,Y=p.append("g").attr("class","title");R.appendLabel(r,G,.06*v,0,Y,m.chartTitleColor,800),p=p.append("g").attr("transform","translate("+k.left+","+k.top+")");var E=7,q=y.toString().length*E,U=L/2+q/2,j=-k.left+15;R.appendLabel(y,j,U,-90,p,m.yLabelColor,600),A=d3.svg.axis().scale(C).orient("bottom").ticks(10),b=d3.svg.axis().scale(M).orient("left").tickValues(X.getTickArray(T,S,6));var W=(p.append("g").attr("class","x axis").attr("transform","translate(0,"+L+")"),p.append("g").attr("class","y axis").attr("transform","translate(0,0)"));A.tickValues(I),W.call(b);var $=p.append("g").attr("class","bar-grouping"),J=$.selectAll(".bar").data(N).enter().append("rect").attr("width",D).attr("height",function(){return 0}).attr("x",function(t){return C(t.timeIndex)}).attr("y",function(t){return M(t.y)}).attr("fill",function(){return s}).on("mousemove",function(t){var e=[{headingName:y,headingVal:t.y}];H.showToolTip(d3.event,"",d+" "+t.x,!1,e,.95*d3.event.pageY),d3.select(this).style("fill","yellow")}).on("mouseleave",function(){H.hideTooTip(),d3.select(this).style("fill",s)});J.transition().duration(1e3).attr("height",function(t){return M(0)-M(t.y)});{var Z=d3.select("#"+h).append("div").style("left",C(0)).style("width",w).style("height",.4*v),K=Z.selectAll(".xScalebar").data(N).enter().append("div").style("width",D).style("height",.2*v).style("left",function(){return 0}).style("position","absolute").style("display","inline-block");K.append("img").style("width",D+"px").style("height",.2*v+"px").attr("src",function(t){return t.imagePath}).on("mousemove",function(t){var e=[{headingName:y,headingVal:t.y}];H.showToolTip(d3.event,"",d+" "+t.x,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()})}K.transition().duration(1e3).style("left",function(t,e){return 0==e?k.left+4+"px":k.left+4+C(t.timeIndex)+"px"}),K.append("div").style("width",D).style("height",.1*v).style("margin-top",.05*v).style("left",function(t,e){return 0==e?k.left:k.left+C(t.timeIndex)}).style("color","#a7a7a7").html(function(t){return t.name}).style("word-wrap","break-word"),u(p),c(p)}},K={squareChart:function(e){var n,e=t.extend({color:"red",axisColor:"blue",data:[],xFieldName:"",yFieldName:"",widthOfSquare:20},e);n=0==e.data.length?L:e.data;var r,a;r=""==e.xFieldName?N:e.xFieldName,a=""==e.yFieldName?_:e.yFieldName;var i=(Math.floor((g-I.scale)/n.length),t(f).attr("id")),o=i+"_square_"+a,l=e.widthOfSquare,s=35;p.selectAll("."+o).data(n).enter().append("rect").attr("class",o).attr("x",function(t){return C(V.parse(t[r]))-l*s/100+7}).attr("y",function(t){return M(t[a])-3*(l*s/100)}).attr("width",l).attr("height",function(){return l}).attr("fill",e.color).on("mouseover",function(t){t[a];d3.select(this).attr("width",l+5).attr("height",l+5),attachToolTip.showToolTip(d3.event)}).on("mouseleave",function(t){t[a];d3.select(this).attr("width",l).attr("height",l),attachToolTip.hideTooTip()}),0==t(f).find(".axis").length&&(p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-I.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(A),p.append("g").attr("class","y axis").attr("transform","translate("+(g-I.scale+10)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(b))}},Q={circleChart:function(e){var n,e=t.extend({color:"red",axisColor:"blue",r:10,data:[]},e);n=0==e.data.length?L:e.data;var r=(Math.floor((g-I.scale)/n.length),t(f).attr("id")),a=r+"_circle";p.selectAll("."+a).data(n).enter().append("circle").attr("class",a).attr("cx",function(t,n){return C(n)+e.r/2}).attr("cy",function(t){return M(t[_])}).attr("r",e.r).attr("fill",e.color).on("mouseover",function(t){console.log(JSON.stringify(t));var n=[{headingName:D.yAxisIndicationLabel,headingVal:t[_]}];H.showToolTip(d3.event,"",t[N],!1,n,.95*d3.event.pageY);t[_];d3.select(this).attr("r",e.r+5),d3.select(this).attr("stroke","cyan"),d3.select(this).attr("stroke-width","2").style("opacity","0.5")}).on("mouseleave",function(t){t[_];d3.select(this).attr("r",e.r),H.hideTooTip(),d3.select(this).attr("stroke","none"),d3.select(this).attr("stroke-width","0").style("opacity","1")}),0==t(f).find(".axis").length&&(p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-I.scale+7)+")").attr("stroke",e.axisColor).attr("fill","none").call(A).selectAll("text").text(function(t){return n[t][N]}),p.append("g").attr("class","y axis").attr("transform","translate("+(g-I.scale+5)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(b))}};n();var te={pieChart:function(e){var n,e=t.extend({data:[]},e);n=0==e.data.length?L:e.data;var r=g/2,a=0,i=d3.svg.arc().innerRadius(a).outerRadius(r),o=d3.svg.arc().outerRadius(r+10),l=d3.layout.pie(),s=d3.scale.category20(),u=p.append("svg").attr("width",g).attr("height",v),c=u.selectAll("g.arc").data(l(n)).enter().append("g").attr("class","slice").attr("stroke","white").attr("stroke-width",3).attr("transform","translate("+r+","+r+")").on("mouseover",function(t){d3.select("#piechartTooltip").style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px").style("opacity",10).select("#value").text(t.value),d3.select(this).attr("stroke","white").transition().duration(100).attr("d",o).attr("stroke-width",10)}).on("mouseout",function(){d3.select("#piechartTooltip").style("opacity",0),d3.select(this).transition().attr("d",i).attr("stroke","white").attr("stroke-width",3)});c.append("path").attr("fill",function(t,e){return s(e)}).attr("d",i)}},ee={drawPyramidChart:function(t,e,n,a){var i=-20,o=200;g-=I.scale,v-=I.scale,scaleX=d3.scale.linear().domain([i,o]).range([0,g]),scaleY=d3.scale.linear().domain([0,80]).range([v,0]),color=d3.scale.category10();var l,u=s(r(t)).arrayOfPolygons;l=n?p.append("g").attr("transform","translate("+(g-g/6)+","+(v+v/4)+") rotate(180)"):p.append("g").attr("transform","translate("+g/6+",0)"),l.selectAll("polygon").data(u).enter().append("polygon").attr("points",function(t){return t.points.map(function(t){return[scaleX(t.x),scaleY(t.y)].join(",")}).join(" ")}).attr("fill",function(t,n){return e[n].color}).attr("stroke-width",0).data(u).on("mousemove",function(t,n){var r=[{headingName:a,headingVal:e[n].amount}];H.showToolTip(d3.event,"",e[n].accountName,!1,r,.95*d3.event.pageY)}).on("mouseout",function(){H.hideTooTip()});var c=p.append("g").attr("class","legend").attr("transform",function(){return"translate("+.01*g+",10)"}),d=20,f=10,h=0,y=h+d+f;c.selectAll(".rect").data(e).enter().append("g").append("rect").attr("class","pyramidLegend").attr("width",d).attr("height",d).attr("y",function(t,e){return 1.5*e*d}).attr("fill",function(t,n){return e[n].color}),c.selectAll(".text").data(e).enter().append("text").attr("x",y).attr("y",function(t,e){return 1.5*e*d+d/2}).attr("dy",".35em").attr("class",function(t){return"legend-text  "+t}).attr("fill","white").text(function(t,n){return e[n].accountName})},draw3DPyramidSliceChart:function(t){function e(){return.6*outFactor*2}function n(){var t=180*Math.atan(outFactor/(.6*outFactor))/Math.PI;return t}function r(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function a(t){for(var e=outFactor,n=[],r=0;r<t.length;r++)n.push(e*t[r]/100),M.push(t[r]);return M.sort(function(t,e){return parseInt(t)<parseInt(e)}),n.sort(function(t,e){return parseInt(t)<parseInt(e)}),n}function i(){return.6*outFactor}function o(t,e,n,a){for(var i=r(e)/Math.sin(t*(Math.PI/180)),o=[],l=0;l<e.length;l++)o.push(i*e[l]/i-a*e[l]/i);return o}function l(t,e){var n=t*Math.cos(e*(Math.PI/180));return n}function s(t,e,n){var a=r(e),i=r(n),o=Math.sin(a/(i-t)),l=180*o/Math.PI;return l}function u(t,e){console.log("  Angle : "+t+" bottomWidth : "+e);var n=t*(Math.PI/180),r=Math.tan(n)*e;return r}function c(t,e,n,r,a,o,c,d,f,h,p,g,v,A,M){var k=t,w=e,C=[];if(1!=A){if(1==a)for(var T=0;5>T;T++){0==T?e-=n:1==T?e+=n:2==T?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==T?(t+=l(d,s(o,h,c)+S,p,n),e-=d,y=t,m=e):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(2==a)for(var T=0;5>T;T++){0==T?e-=n:1==T?e+=n:2==T?0==g?(t+=i(),e-=o):(t=x,e=b-v):3==T?(t-=l(d,s(o,h,c)+S,p,n),e-=d,N.push(t),_.push(e),x=t,b=e):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(3==a&&1!=A)for(var P,I,T=0;5>T;T++){0==T?(P=t,e-=n,I=e):1==T?(t=y,e=m):2==T?(t+=k-y,e-=I-m):3==T?(t=x,e=b):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}}else{var V=t-y,F=u(f,V);if(1==a)for(var T=0;5>T;T++){0==T?(e-=F,k=t,w=e):1==T?e+=F:2==T?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==T&&(t=k,e=w);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(2==a)for(var T=0;4>T;T++){0==T?(e-=F,k=t,w=e):1==T?e+=F:2==T?(t=x,e=b-v):3==T&&(t=k,e=w,N.push(t),_.push(e),b=e);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(3==a&&1!=A)for(var P,I,T=0;5>T;T++){0==T?(P=t,e-=n,I=e):1==T?(t=y,e=m):2==T?(t+=k-y,e-=I-m):3==T?(t=x,e=b):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}}return C}function d(t,e,n,r){for(var a=[],i=0;3>i;i++){0==i?(t=t,e+=n/2):1==i?t+=.3*outFactor/2:2==i&&(t+=.025*outFactor,e+=.025*outFactor);var o=e,l=t;a.push(JSON.parse('{"x":'+l+',"y":'+o+',"value":'+r+"}"))}return a}var f=G.getValueToPercentageArray(t.data),h=v>g?g:v;outFactor=.6*h;var y,m,x,b,A=10,M=[],k=a(f),w=n(),C=30,T=o(w,k,0,C),S=0,L=t.colorArray,D=[{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400}],N=[],_=[],P=0,I=0;g>v?(P=(g-outFactor)/2,I=0):(P=0,I=(v-outFactor)/2.1);for(var V=({x:(h-e())/2,y:(h-e())/2},d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear")),F=p.append("g").attr("transform","translate("+.13*g+","+.02*-v+")"),z=.3*h+.1*h,E=h,Y=(k[0],d3.scale.category20c(),E),R=0,O=A,B=0,X=0;X<k.length;X++){X==k.length-1&&(B=1);{F.append("path").attr("d",V(D)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(2e3).ease("linear").attr("d",V(c(z,Y,k[X],f,1,C,T,T[X],w,k,R,X,O,B,M[X]))).style("opacity",.7).attr("stroke","white").attr("stroke-width",1).attr("fill",function(){return L[X]}),F.append("path").attr("d",V(D)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1500).ease("linear").attr("d",V(c(z,Y,k[X],f,2,C,T,T[X],w,k,R,X,O,B,M[X]))).attr("stroke","white").style("opacity",.5).attr("stroke-width",.5).attr("fill",function(){return L[X]}),F.append("path").attr("d",V(D)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1e3).ease("linear").attr("d",V(c(z,Y,k[X],f,3,C,T,T[X],w,k,R,X,O,B,M[X]))).style("opacity",.3).attr("stroke","white").attr("stroke-width",.3).attr("fill",function(){return L[X]})}Y=E-k[X]-A,E=Y,R=k[X]}for(var q=outFactor<200?"10px":"12px",U=0;U<N.length;U++)F.append("path").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("d",V(d(N[U],_[U],k[U],M[U]))).attr("stroke",function(){return L[U]}).attr("stroke-width",1).attr("fill","none"),F.append("text").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("x",N[U]+.15*outFactor).attr("y",_[U]+.1*outFactor+k[U]/2).text(t.labels[U]+":"+t.data[U]+" "+t.unit).attr("font-family","sans-serif").attr("font-size",q).attr("fill",L[U])},draw3DPyramidChartWithoutSlice:function(t){function e(){return.6*outFactor*2}function n(){var t=180*Math.atan(outFactor/(.6*outFactor))/Math.PI;return t}function r(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function a(t){for(var e=outFactor,n=[],r=0;r<t.length;r++)n.push(e*t[r]/100),M.push(t[r]);return M.sort(function(t,e){return parseInt(t)<parseInt(e)}),n.sort(function(t,e){return parseInt(t)<parseInt(e)}),n}function i(){return.6*outFactor}function o(t,e,n,a){for(var i=r(e)/Math.sin(t*(Math.PI/180)),o=[],l=0;l<e.length;l++)o.push(i*e[l]/i-a*e[l]/i);return o}function l(t,e){var n=t*Math.cos(e*(Math.PI/180));return n}function s(t,e,n){var a=r(e),i=r(n),o=Math.sin(a/(i-t)),l=180*o/Math.PI;return l}function u(t,e){console.log("  Angle : "+t+" bottomWidth : "+e);var n=t*(Math.PI/180),r=Math.tan(n)*e;return r}function c(t,e,n,r,a,o,c,d,f,h,p,g,v,A,M){var k=t,w=e,C=[];if(1!=A){if(1==a)for(var T=0;5>T;T++){0==T?e-=n:1==T?e+=n:2==T?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==T?(t+=l(d,s(o,h,c)+S,p,n),e-=d,y=t,m=e):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(2==a)for(var T=0;5>T;T++){0==T?e-=n:1==T?e+=n:2==T?0==g?(t+=i(),e-=o):(t=x,e=b-v):3==T?(t-=l(d,s(o,h,c)+S,p,n),e-=d,N.push(t),_.push(e),x=t,b=e):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(3==a&&1!=A)for(var P,I,T=0;5>T;T++){0==T?(P=t,e-=n,I=e):1==T?(t=y,e=m):2==T?(t+=k-y,e-=I-m):3==T?(t=x,e=b):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}}else{var V=t-y,F=u(f,V);if(1==a)for(var T=0;5>T;T++){0==T?(e-=F,k=t,w=e):1==T?e+=F:2==T?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==T&&(t=k,e=w);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(2==a)for(var T=0;4>T;T++){0==T?(e-=F,k=t,w=e):1==T?e+=F:2==T?(t=x,e=b-v):3==T&&(t=k,e=w,N.push(t),_.push(e),b=e);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}else if(3==a&&1!=A)for(var P,I,T=0;5>T;T++){0==T?(P=t,e-=n,I=e):1==T?(t=y,e=m):2==T?(t+=k-y,e-=I-m):3==T?(t=x,e=b):4==T&&(t=k,e=w-n);var L=e,D=t;C.push(JSON.parse('{"x":'+D+',"y":'+L+',"value":'+M+"}"))}}return C}function d(t,e,n,r){for(var a=[],i=0;3>i;i++){0==i?(t=t,e+=n/2):1==i?t+=.3*outFactor/2:2==i&&(t+=.025*outFactor,e+=.025*outFactor);var o=e,l=t;a.push(JSON.parse('{"x":'+l+',"y":'+o+',"value":'+r+"}"))}return a}var f=G.getValueToPercentageArray(t.data),h=v>g?g:v;outFactor=.6*h;var y,m,x,b,A=0,M=[],k=a(f),w=n(),C=30,T=o(w,k,0,C),S=0,L=t.colorArray,D=[{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400}],N=[],_=[],P=0,I=0;g>v?(P=(g-outFactor)/2,I=0):(P=0,I=(v-outFactor)/2.1);for(var V=({x:(h-e())/2,y:(h-e())/2},d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear")),F=p.append("g").attr("transform","translate("+.1*g+","+.05*-v+")"),z=.3*h+.1*h,E=h,Y=(k[0],d3.scale.category20c(),E),R=0,O=A,B=0,X=0;X<k.length;X++){X==k.length-1&&(B=1);{F.append("path").attr("d",V(D)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(2e3).ease("linear").attr("d",V(c(z,Y,k[X],f,1,C,T,T[X],w,k,R,X,O,B,M[X]))).style("opacity",.7).attr("stroke","white").attr("stroke-width",1).attr("fill",function(){return L[X]}),F.append("path").attr("d",V(D)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1500).ease("linear").attr("d",V(c(z,Y,k[X],f,2,C,T,T[X],w,k,R,X,O,B,M[X]))).attr("stroke","white").style("opacity",.5).attr("stroke-width",.5).attr("fill",function(){return L[X]}),F.append("path").attr("d",V(D)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1e3).ease("linear").attr("d",V(c(z,Y,k[X],f,3,C,T,T[X],w,k,R,X,O,B,M[X]))).style("opacity",.3).attr("stroke","white").attr("stroke-width",.3).attr("fill",function(){return L[X]})}Y=E-k[X]-A,E=Y,R=k[X]}for(var q=outFactor<200?"10px":"12px",U=0;U<N.length;U++)F.append("path").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("d",V(d(N[U],_[U],k[U],M[U]))).attr("stroke",function(){return L[U]}).attr("stroke-width",1).attr("fill","none"),F.append("text").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("x",N[U]+.15*outFactor+3*U).attr("y",_[U]+.1*outFactor+k[U]/2-3*U).text(t.labels[U]+":"+t.data[U]+" "+t.unit).attr("font-family","sans-serif").attr("font-size",q).attr("fill",L[U])}},ne={drawRadarChart:function(t,e,n){var r=g>v?v:g,a=.1*g,i=.1*v,o=0;g>v?(a=Math.round(g-v)/3,o=a):(i=Math.round(v-g)/3,o=i);var l={radius:10,w:r-o,h:r-o,factor:1,factorLegend:.85,levels:3,maxValue:0,radians:2*Math.PI,opacityArea:0,ToRight:5,TranslateX:a,TranslateY:i,ExtraWidthX:100,ExtraWidthY:100,color:d3.scale.category20()};if("undefined"!=typeof n)for(var s in n)"undefined"!=typeof n[s]&&(l[s]=n[s]);l.maxValue=Math.max(l.maxValue,d3.max(e,function(t){return d3.max(t.map(function(t){return t.value}))}));for(var u,d=e[0].map(function(t){return t.axis}),f=d.length,h=l.factor*Math.min(l.w/2,l.h/2),y=d3.format(""),x=p.append("svg:g").attr("width",l.w+l.ExtraWidthX).attr("height",l.h+l.ExtraWidthY).append("g").attr("transform","translate("+.3*g+","+l.TranslateY+")"),b=0;b<l.levels;b++){var A=l.factor*h*((b+1)/l.levels);x.selectAll(".levels").data(d).enter().append("svg:line").attr("x1",function(t,e){return A*(1-l.factor*Math.sin(e*l.radians/f))}).attr("y1",function(t,e){return A*(1-l.factor*Math.cos(e*l.radians/f))}).attr("x2",function(t,e){return A*(1-l.factor*Math.sin((e+1)*l.radians/f))}).attr("y2",function(t,e){return A*(1-l.factor*Math.cos((e+1)*l.radians/f))}).attr("class","line").style("stroke","grey").style("stroke-opacity","3.75").style("stroke-width","0.5px").attr("transform","translate("+(l.w/2-A)+", "+(l.h/2-A)+")")}for(var b=0;b<l.levels;b++){var A=l.factor*h*((b+1)/l.levels);x.selectAll(".levels").data([0]).enter().append("svg:text").attr("x",function(){return A*(1-l.factor*Math.sin(0))}).attr("y",function(){return A*(1-l.factor*Math.cos(0))}).attr("class","legend").style("font-family","sans-serif").style("font-size","12px").attr("transform","translate("+(l.w/2-A+l.ToRight)+", "+(l.h/2-A)+")").style("fill",m["font-color"]).text(y((b+1)*l.maxValue/l.levels))}series=0;var M=x.selectAll(".axis").data(d).enter().append("g").attr("class","axis");M.append("line").attr("x1",l.w/2).attr("y1",l.h/2).attr("x2",function(t,e){return l.w/2*(1-l.factor*Math.sin(e*l.radians/f))}).attr("y2",function(t,e){return l.h/2*(1-l.factor*Math.cos(e*l.radians/f))}).attr("class","line").style("stroke","grey").style("stroke-width","1px"),M.append("text").attr("class","legend").text(function(t){return t}).style("font-family","sans-serif").style("font-size","11px").attr("text-anchor","middle").attr("dy","1.5em").attr("transform",function(){return"translate(0, -10)"}).style("fill",m["font-color"]).attr("x",function(t,e){return l.w/2*(1-l.factorLegend*Math.sin(e*l.radians/f))-60*Math.sin(e*l.radians/f)}).attr("y",function(t,e){return l.h/2*(1-Math.cos(e*l.radians/f))-20*Math.cos(e*l.radians/f)}),e.forEach(function(t){dataValues=[],x.selectAll(".nodes").data(t,function(t,e){dataValues.push([l.w/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.sin(e*l.radians/f)),l.h/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.cos(e*l.radians/f))])}),dataValues.push(dataValues[0]),x.selectAll(".area").data([dataValues]).enter().append("polygon").attr("class","radar-chart-serie"+series).style("stroke-width","2px").style("stroke",l.color(series)).attr("points",function(t){for(var e="",n=0;n<t.length;n++)e=e+t[n][0]+","+t[n][1]+" ";return e}).style("fill",function(){return l.color(series)}).style("fill-opacity",l.opacityArea).on("mouseover",function(){z="polygon."+d3.select(this).attr("class"),x.selectAll("polygon").transition(200).style("fill-opacity",.1),x.selectAll(z).transition(200).style("fill-opacity",.9)}).on("mouseout",function(){x.selectAll("polygon").transition(200).style("fill-opacity",l.opacityArea)}),series++}),series=0,e.forEach(function(t){x.selectAll(".nodes").data(t).enter().append("svg:circle").attr("class","radar-chart-serie"+series).attr("r",l.radius).attr("alt",function(t){return Math.max(t.value,0)}).attr("cx",function(t,e){return dataValues.push([l.w/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.sin(e*l.radians/f)),l.h/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.cos(e*l.radians/f))]),l.w/2*(1-Math.max(t.value,0)/l.maxValue*l.factor*Math.sin(e*l.radians/f))}).attr("cy",function(t,e){return l.h/2*(1-Math.max(t.value,0)/l.maxValue*l.factor*Math.cos(e*l.radians/f))}).attr("data-id",function(t){return t.axis}).style("fill",l.color(series)).style("fill-opacity",1.9).on("mouseover",function(t){newX=parseFloat(d3.select(this).attr("cx"))-10,newY=parseFloat(d3.select(this).attr("cy"))-5,u.attr("x",newX).attr("y",newY).text(y(t.value)).transition(100).style("opacity",1),z="polygon."+d3.select(this).attr("class"),x.selectAll("polygon").transition(100).style("fill-opacity",.1),x.selectAll(z).transition(200).style("fill-opacity",.7)}).on("mouseout",function(){u.transition(200).style("opacity",0),x.selectAll("polygon").transition(200).style("fill-opacity",l.opacityArea)}).append("svg:title").text(function(t){return Math.max(t.value,0)}).style("fill",m["font-color"]),series++}),u=x.append("text").style("opacity",0).style("font-family","sans-serif").style("font-size","13px"),c(p)}},re={drawCombinationalChart:function(t){function e(){var t=d3.svg.line().x(function(t,e){return q(G[e])}).y(function(t,e){return U(k.dataOfLine1[e])}),e=$.selectAll(".path").data([k.xAxisData]).enter().append("path").attr("d",t).attr("stroke",function(){return k.color[0]}).attr("stroke-width",3).attr("fill","none"),r=e.node().getTotalLength();e.attr("stroke-dasharray",function(){return r+","+r}).attr("stroke-dashoffset",r).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var a=$.selectAll("rect").data(k.xAxisData).enter().append("rect").attr("class","country1").attr("value",function(t,e){return e
}).attr("fill",function(t,e){return k.dataOfLine1[e]<0?"red":k.color[0]}).attr("x",0).attr("y",0).attr("width",function(t,e){return k.dataOfLine1[e]<0?b+1:b}).attr("height",function(t,e){return k.dataOfLine1[e]<0?b+1:b}).on("mouseover",function(){he.style("visibility","visible"),oe.style("visibility","visible").style("display","none"),n(d3.event,d3.select(this).attr("value"))}).on("mouseout",function(){he.style("visibility","hidden"),oe.style("visibility","hidden"),H.hideTooTip()});a.transition().duration(2400).attr("x",function(t,e){return q(G[e])-b/2}).attr("y",function(t,e){return U(k.dataOfLine1[e])-b/2});var i=d3.svg.line().x(function(t,e){return console.log("years="+k.xAxisData[e]),q(G[e])}).y(function(t,e){return console.log("dataOfLine2"+k.dataOfLine2[e]),U(k.dataOfLine2[e])}).interpolate("cardinal"),o=$.selectAll(".path").data([k.xAxisData]).enter().append("path").attr("d",i).attr("stroke",k.color[1]).attr("stroke-width",3).attr("fill","none"),r=o.node().getTotalLength();o.attr("stroke-dasharray",function(){return r+","+r}).attr("stroke-dashoffset",r).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var l=$.selectAll("circle").data(k.xAxisData).enter().append("circle").attr("class","country2").attr("value",function(t,e){return e}).attr("fill",function(t,e){return k.dataOfLine2[e]<0?"red":k.color[1]}).attr("cx",0).attr("cy",0).attr("r",function(t,e){return k.dataOfLine2[e]<0?x+1:x}).on("mouseover",function(){he.style("visibility","visible"),oe.style("visibility","visible").style("display","none"),n(d3.event,d3.select(this).attr("value"))}).on("mouseout",function(){he.style("visibility","hidden"),oe.style("visibility","hidden"),H.hideTooTip()});l.transition().duration(2400).attr("cx",function(t,e){return q(G[e])}).attr("cy",function(t,e){return U(k.dataOfLine2[e])})}function n(t,e){L=0,F=k.xAxisData[e],r(e,t),E=[k.PieData.Data1[e],k.PieData.Data2[e]],a()}function r(t,e){var n;n=k.dataOfLine1[t]>k.dataOfLine2[t]?k.xAxisData[t]+"=>"+k.labelLine1+" "+k.yLabel+" "+k.dataOfLine1[t]+"<br>"+k.xAxisData[t]+"=>"+k.labelLine2+" "+k.yLabel+" "+k.dataOfLine2[t]:k.xAxisData[t]+"=>"+k.labelLine2+" "+k.yLabel+" "+k.dataOfLine2[t]+"<br>"+k.xAxisData[t]+"=>"+k.labelLine1+" "+k.yLabel+" "+k.dataOfLine1[t];var r=[{headingName:k.labelLine2+" "+k.yLabel,headingVal:k.dataOfLine2[t]},{headingName:k.labelLine1+" "+k.yLabel,headingVal:k.dataOfLine1[t]}];H.showToolTip(e,"",k.xAxisData[t],!1,r,.95*d3.event.pageY)}function a(){d3.select("#dountGroup").remove();var t=$.append("g").attr("id","dountGroup").attr("transform","translate("+P.left+","+P.top+")"),e=d3.layout.pie().sort(null).value(function(t){return 0>t?0:t}),n=t.selectAll(".arc").data(e(E)).enter().append("g").attr("value",function(t,e){return 0==e?k.labelLine1:k.labelLine2}).attr("fill",function(t,e){return k.color[e]}).on("mouseover",function(){return d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=8;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"}),oe.style("visibility","visible")}).on("mousemove",function(){s(d3.select(this).attr("value"))}).on("mouseout",function(){return d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),oe.style("visibility","hidden")});n.append("path").attr("d",J).transition().duration(1500).attrTween("d",i)}function i(t){var e=d3.interpolate({startAngle:-180*z,endAngle:-180*z},t);return function(t){return J(e(t))}}function o(){var t;t=d3.min(k.dataOfLine1)<d3.min(k.dataOfLine2)?k.dataOfLine1:k.dataOfLine2,S=O.getMin(t),t=d3.max(k.dataOfLine1)>d3.max(k.dataOfLine2)?k.dataOfLine1:k.dataOfLine2,T=1.4*O.getMax(t)}function l(){var t=j.append("g").attr("id","legendGroup").attr("class","legend").attr("transform","translate("+(2*P.left+1.5*D)+","+(2*P.top-A)+")");t.selectAll("rect").data(k.color).enter().append("rect").attr("class","legend").attr("fill",function(t,e){return k.color[e]}).attr("y",function(t,e){return 2*e*A}).attr("width",A).attr("height",A),t.selectAll("text").data(k.color).enter().append("text").attr("x",function(){return A+3}).attr("y",function(t,e){return 0==e?A:3*A}).style("font-size",12).style("font-family","calibri").style("font-style","italic").text(function(t,e){return 0==e?k.labelLine1+" "+k.yLabel:k.labelLine2+" "+k.yLabel})}function s(t){var e;e=t==k.labelLine1?F+"=>"+k.labelLine1+" "+k.pieDataFactor+" "+E[0]:F+"=>"+k.labelLine2+" "+k.pieDataFactor+" "+E[1],oe.style("z-index",1).style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px").text(e)}function d(){var t,e,n,r,a=$.append("g").attr("id","clickedSymbolGroup").attr("transform","translate(0,0)"),i=[];for(key in k.clickedInfo)i.push(k.xAxisData.indexOf(parseInt(key)));a.selectAll("img").data(i).enter().append("image").attr("value",function(t){return k.xAxisData[t]}).attr("x",function(t){return q(t)-y/2}).attr("y",function(a,o){t=f(k.xAxisData[a]),e=k.dataOfLine1[t],n=k.dataOfLine2[t],r=e>n?e:n;for(var l=0,s=o;s>=0;s--)i[s]==i[o]&&++l;return U(r)-1.5*y*l}).attr("width",y).attr("height",y).attr("xlink:href",k.clickedSybmol).on("click",function(){g(d3.select(this).attr("value"))})}function f(t){for(var e=0;e<k.xAxisData.length&&k.xAxisData[e]!=t;e++);return e}function g(t){d3.select("#innerDiv").text(k.clickedInfo[t]),le.style("visibility","visible"),le.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px"),oe.style("visibility","hidden")}var v,y,x,b,A,M=h,k=t,w=parseInt(d3.select("#"+M).style("width")),C=parseInt(d3.select("#"+M).style("height"));301>C?(y=10,x=3,b=5,A=7):(y=18,x=5,b=8,A=12);for(var T,S,L,D,N,_=B.leftMarginController(k.dataOfLine1),P={top:.1*C,right:.05*w,bottom:45,left:_},I=w-P.left-P.right,V=C-P.top-P.bottom,F=(d3.select("#"+M),k.xAxisData[0]),z=Math.PI/180,E=[k.PieData.Data1[0],k.PieData.Data2[0]],G=[],Y=0;Y<k.xAxisData.length;Y++)G[Y]=Y;o();var q=d3.scale.linear().domain([0,k.xAxisData.length-1]).range([0,I]),U=d3.scale.linear().domain([S,T]).range([V,0]),j=(d3.select("#"+M),p);W.init(p,V,I,P.left,P.top,m.gridLineColor);var $=j.append("g").attr("id","combinationalGroup").attr("transform","translate("+P.left+","+P.top+")");D=P.top,N=D-.6*D;var J=d3.svg.arc().innerRadius(N).outerRadius(D);a(),l(),d();var Z=7.5,K=w/2-k.title.length*Z/2,Q=p.append("g").attr("class","title");R.appendLabel(k.title,K,P.top/2,0,Q,m.chartTitleColor,800);var Z=6,te=k.xAxisLabel.toString().length*Z,ee=V+(P.bottom-5),ne=I/2-te/2;R.appendLabel(k.xAxisLabel,ne,ee,0,$,m.xLabelColor,600);var re=k.yLabel.toString().length*Z,ae=V/2+re/2,ie=-P.left+15;R.appendLabel(k.yLabel,ie,ae,-90,$,m.yLabelColor,600);var oe=d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").style("padding","5px").text("a simple tooltip").style("display","none"),le=d3.select("body").attr("id","outerDiv").append("div").style("width","200px").style("background","#1f77b4").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("padding","2px").style("box-shadow","0 0 10px #ccc").style("color","white").style("font-size",15).text("NEWS");le.append("img").attr("id","closeButton").style("float","right").style("margin-top","-10px").style("margin-right","-10px").attr("src","http://stocinn.github.io/stocweb/img/cross.png").on("click",function(){le.style("visibility","hidden")}),le.append("div").attr("id","innerDiv").style("padding","5px 10px 5px 10px").style("font-size",12).style("color","black").style("background","#fff").text("inner box"),e();for(var se=0,Y=0;Y<k.xAxisData.length;Y++)se<k.xAxisData[Y].toString().length&&(se=k.xAxisData[Y].toString().length);var ue=d3.svg.axis().scale(q).orient("bottom").tickValues(X.getXTickArray(0,k.xAxisData.length,se,I)),ce=$.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+V+")").call(ue);ce.selectAll("text").text(function(t){return k.xAxisData[t]}).attr("font-family","calibri");var de=d3.svg.axis().scale(U).orient("left").tickValues(X.getTickArray(S,T,10));$.append("g").attr("id","y axis").attr("class","yAxis").attr("font-size",v).attr("transform","translate( 0 , 0)").call(de),d3.select(".yAxis path").attr("fill","none");var fe=[],he=(d3.svg.line().x(function(){return fe[L++]}).y(function(){return fe[L++]}),j.append("path").data([fe]).attr("stroke","gray").attr("stroke-width",1).attr("fill","none"));u(p),c(p)}},ae={drawDrillDownChart:function(t,e,n){function r(){function r(e,r){var l=e;if("undefined"!=typeof l){o.remove(),o=p.append("svg").attr("width",g).attr("height",1.5*v).append("g").attr("transform","translate("+i+","+.05*v+")"),T=d3.scale.ordinal().rangeRoundBands([i,g-.05*g],.1).domain(l.map(function(t){return t.x}));var s=d3.max(l,function(t){return t.y});s=1.5*s,S=d3.scale.linear().range([v-.08*v,.08*v]).domain([0,s]),D=d3.svg.axis().scale(T).tickSize(5).tickSubdivide(!1),N=d3.svg.axis().scale(S).tickSize(5).orient("left").tickSubdivide(!1);for(var d=l[0].name.length,f=0;f<l.length;f++){var h=l[f].name.length;h>d&&(d=h)}var y=X.getXTickArray(0,l.length,d,g-a.rightMargin);D.tickValues(y);var x=o.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(v-a.bottomMargin)+")").call(D);x.selectAll("text").text(function(t){return l[t].name});var b=o.append("svg:g").attr("class","y axis").attr("transform","translate("+a.leftMargin+",-35)").call(N);o.selectAll("rect").data(l).enter().append("rect").attr("id",t).on("mousemove",function(t){var e=[{headingName:a.yLabel,headingVal:t.y}];H.showToolTip(d3.event,"",a.xLabel+" "+t.name,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).attr("x",0).attr("y",v).transition().duration(1200).attr("x",function(t){return T(t.x)}).attr("y",function(t){return S(t.y)-a.bottomMargin}).attr("width",T.rangeBand()).attr("height",function(t){return v-S(t.y)}).attr("fill",function(t,e){return r[e]});var A=6,M=a.yLabel.toString().length*A,k=v/2+M/2,w=-i-.5*i;R.appendLabel(a.yLabel,w,k,-90,b,m.xLabelColor,600);var M=a.xLabel.toString().length*A,C=.1*v,_=g/2-M/2;R.appendLabel(a.xLabel,_,C,0,x,m.yLabelColor,600),d3.select(".resetDrillDownBtn").on("click",function(){ae.drawDrillDownChart(t,L,n),d3.select(".resetDrillBtnGroup").style("display","none")}),u(p),c(p)}}var i;i=30>.05*g?30:.05*g;var o=p.append("svg:g").attr("width",g).attr("height",v).attr("class","backtobrand").attr("transform","translate("+i+","+.1*v+")").append("g"),l=[],s=0,d=0,f=0;for(var h in e){d<e[h].data&&(d=e[h].data),f>e[h].data&&(f=e[h].data);var y=e[h].subData,x=[],b=0;for(var A in y){var M=y[A],k={name:A,x:b,y:M};x.push(k),b++}var w={x:s,y:e[h].data,color:e[h].color,subDataColorArray:e[h].subDataColorArray,name:h,subData:x};l.push(w),s++}var C=d;C=1.2*C;var T=d3.scale.ordinal().rangeRoundBands([i,g-.05*g],.1).domain(l.map(function(t,e){return e})),S=d3.scale.linear().range([v-a.topMargin,a.bottomMargin]).domain([0,C]),D=d3.svg.axis().scale(T).tickSize(5).tickSubdivide(!0),N=d3.svg.axis().scale(S).tickSize(5).orient("left").tickSubdivide(!1),_=o.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(v-a.bottomMargin)+")").call(D);_.selectAll("text").text(function(t){return l[t].name}),_.selectAll("text").call(q.wrapText,40);var P=o.append("svg:g").attr("class","y axis").attr("transform","translate("+a.leftMargin+","+-a.bottomMargin+")").call(N);if(o.selectAll("rect").data(l).enter().append("rect").on("click",function(t){t.subData.length>0?r(t.subData,t.subDataColorArray):alert("dont have sub data"),d3.select(".resetDrillBtnGroup").style("display","block")}).on("mousemove",function(t){var e=[{headingName:a.yLabel,headingVal:t.y}];H.showToolTip(d3.event,"",a.xLabel+" "+t.name,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).attr("x",0).attr("y",v).transition().duration(1200).attr("x",function(t){return T(t.x)}).attr("y",function(t){return S(t.y)-a.bottomMargin}).attr("width",T.rangeBand()).attr("height",function(t){return v-S(t.y)}).attr("fill",function(t){return t.color}).style("cursor",function(t){return t.subData.length>0?"pointer":""}),d3.select(".resetDrillDownBtn").empty()){var V=70,F=30,z=p.append("g").attr("class","resetDrillBtnGroup").attr("transform","translate("+(g-3*a.leftMargin)+","+I.top+")");z.append("rect").attr("width",V).attr("height",F).attr("x","0").attr("y","0").attr("rx","2").attr("ry","2").attr("class","resetDrillDownBtn").on("mouseover",function(){d3.select(".resetDrillDownBtn").style("fill","#7F7FFF")}).on("mouseout",function(){d3.select(this).style("fill","#19a586")}).style("fill","#19a586").style("display","inline-block").style("cursor","pointer"),z.append("text").attr("x",20).attr("y",F/2).attr("dy",".35em").attr("class","resetDrillDownBtn").text("Reset").attr("fill","white"),d3.select(".resetDrillBtnGroup").style("display","none")}var E=6,G=a.yLabel.toString().length*E,Y=v/2+G/2,O=-i;R.appendLabel(a.yLabel,O,Y,-90,P,m.yLabelColor,600);var G=a.xLabel.toString().length*E,B=.1*v,U=g/2-G/2;R.appendLabel(a.xLabel,U,B,0,_,m.xLabelColor,600),u(p),c(p)}var a={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),toolTipLabel:"Drilled Chart",redraw:"false"},i=9,o=g/2-n.title.length*i/2,l=p.append("g").attr("class","title");if(R.appendLabel(n.title,o,.06*v,0,l,m.chartTitleColor,800),"undefined"!=typeof n)for(var s in n)"undefined"!=typeof n[s]&&(a[s]=n[s]);p.selectAll(".tick").empty()?(L=e,v-=.2*v):p.selectAll("g").remove(),r()}},ie={variationAnalysis:function(e){var n,r,a,i,o,l=e.data.title,s=e.data.subTitle,d=(e.data.titleColor,e.data.yAxisData),h=e.data.yAxisLabel,y=e.data.xAxisData,x=e.data.xAxisLabel,b=B.leftMarginController(d),A={left:b,right:.05*g,bottom:45,top:.15*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},M=(t(f).offset().left,t(f).offset().top),k=g-A.left-A.right,w=v-A.top-A.bottom;r=w/(2*d.length),501>g?(i=18,o=8,n=11,a=9):(i=20,o=12,n=14,a=10);for(var C="calibri",T=[],S=[],L=0,D=0;D<y.length;D++)for(var N=0;2>N;N++)0==N?T[L]=y[D][N]:S[L++]=y[D][N];variationMainGroup=p.append("g").attr("class","main-group").attr("transform","translate("+A.left+","+A.top+")");var _=8,P=g/2-l.length*_/2,I=p.append("g").attr("class","title"),V=p.append("g").attr("class","sub-title");R.appendLabel(l,P,A.top/2.8,0,I,m.chartTitleColor,800),P=g/2-s.length*_/2,R.appendLabel(s,P,A.top/1.4,0,V,m.chartTitleColor,600);var F={init:function(t,e,n,r,a,i){var l=Math.ceil(.2*e),s=Math.ceil(n/l);t.selectAll(".vline").data(d3.range(s)).enter().append("line").attr("x1",function(t){return t*(n/o)}).attr("x2",function(t){return t*(n/o)}).attr("y1",function(){return 0}).attr("y2",function(){return e}).style("stroke",i).style("stroke-width",.3).attr("transform","translate("+r+","+a+")")}};F.init(variationMainGroup,w,k,0,0,m.gridLineColor);var z=d3.scale.linear().domain([0,d.length-1]).range([.5*r,w-.5*r]),E=d3.svg.axis().scale(z).orient("left").tickValues(X.getTickArray(0,d.length-1,12)),_=(variationMainGroup.append("g").attr("class","y axis").attr("transform","translate(0,0)").attr("fill","none").call(E).selectAll("text").text(function(t){return d[t]}).attr("fill","black"),7),G=h.toString().length*_,Y=w/2+G/2,q=-A.left+15;R.appendLabel(h,q,Y,-90,variationMainGroup,m.yLabelColor,600);var U=O.getMin(T);U=U>0?.8*U:1.5*U;var j=O.getMax(S);j=j>0?1.3*j:.8*j;{var W=d3.scale.linear().domain([U,j]).range([0,k]),$=d3.svg.axis().scale(W).orient("bottom");variationMainGroup.append("g").attr("class","x axis").attr("transform","translate(0,"+w+")").attr("font-size",n).attr("fint-family",C).call($).selectAll("text").attr("fill","black")}d3.select(".x-axis").attr("fill","none");var J=x.toString().length*_,Z=w+(A.bottom-5),K=k/2-J/2;R.appendLabel(x,K,Z,0,variationMainGroup,m.xLabelColor,600);var Q=variationMainGroup.append("g").attr("class","rectangle-group").attr("transform","translate(0,0)"),te=Q.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");te.append("stop").attr("offset","0").attr("stop-color","#00ff73"),te.append("stop").attr("offset","1").attr("stop-color","#00ffe7");var ee=(d3.min(T)+d3.max(S))/2,ne=Q.selectAll("rect").data(S).enter().append("rect").attr("value",function(t,e){return e}).attr("x",function(){return W(ee)}).attr("y",function(t,e){return z(e)-r/2}).attr("width",function(){return 0}).attr("height",r).attr("fill","url(#rectangleGradient)").on("mousemove",function(){var t=d3.event.pageY-(M+A.top);t=Math.round(z.invert(t));var e=y[t][0],n=y[t][1],r=h+"-"+d[t],a=[{headingName:"Min",headingVal:e+" "+x},{headingName:"Max",headingVal:n+" "+x}];H.showToolTip(d3.event,"",r,!1,a,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});ne.transition().duration(1e3).attr("x",function(t,e){return W(T[e])}).attr("width",function(t,e){return W(S[e])-W(T[e])}),Q.selectAll("text").data(S).enter().append("text").attr("x",function(t,e){return W(T[e])-(T[e].toString().length+x.length)*_}).attr("y",function(t,e){return z(e)+5}).attr("font-family",C).attr("fill",m.yLabelColor).text(function(t,e){return T[e]+" "+x});var re=variationMainGroup.append("g").attr("class","rectangleTextRightSide").attr("transform","translate(0,0)");re.selectAll("text").data(S).enter().append("text").attr("x",function(t,e){return W(S[e])+5}).attr("y",function(t,e){return z(e)+5}).attr("font-family",C).attr("fill",m.yLabelColor).text(function(t,e){return S[e]+" "+x}),u(p),c(p)}},oe={drawPieChartWithTransition:function(t){function e(t,e,n,r){r.selectAll(".rect").data(t).enter().append("rect").attr("y",function(t,e){return 2*e*n}).attr("width",n).attr("height",n).attr("fill",function(t,n){return e[n]}),r.selectAll(".text").data(t).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",n+4).attr("y",function(t,e){return 2*e*n+n/1.3}).text(function(t){return t})}function n(t,e,n,r){for(var a=0,i=0;i<n.length;i++)a<n[i].toString().length&&(a=n[i].toString().length);a=7*a;for(var o=[],l={x:0,y:0,textXPos:0},s=5,u=.1*t,c=Math.round(.8*t/(s+r+a)),i=0;i<n.length;i++){var l={};u=i%c==0?.1*t:u+s+r+a,l.x=u,i%c==0&&0!=i&&(e+=2*r),l.y=e,l.textXPos=u+s+r,o.push(l)}return o}function r(t){var e=d3.interpolate({startAngle:-180*y,endAngle:-180*y},t);return function(t){return C(e(t))}}function a(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}for(var i,o,l=t.key,s=t.value,u=t.label,d=t.color,f=t.legendOrient,h=t.innerRadius,y=Math.PI/180,m=.02*g,x=7,b=0,A=4,M=0;M<l.length;M++)b<l[M].toString().length&&(b=l[M].toString().length);var k;b*=x,o=b+m+A;var w;"left"==f?(i=g-b,w=p.append("g").attr("class","dountPie").attr("transform","translate("+(i/2+b)+","+v/2+")"),k=i/2>v/2?v/2:i/2,k=.92*k):"right"==f?(i=g-b-5,w=p.append("g").attr("class","dountPie").attr("transform","translate("+i/2+","+v/2+")"),k=i/2>v/2?v/2:i/2,k=.92*k):"top"==f?(console.log("top"),w=p.append("g").attr("class","dountPie").attr("transform","translate("+g/2+","+(v/2+2*m)+")"),k=g>v-4*m?v-4*m:g,k=.45*k):(console.log("bottom"),w=p.append("g").attr("class","dountPie").attr("transform","translate("+g/2+","+(v/2-2*m)+")"),k=g>v-4*m?v-4*m:g,k=.45*k);var C=d3.svg.arc().innerRadius(h*k).outerRadius(k),T=(d3.svg.arc().innerRadius(0).outerRadius(k+14),d3.layout.pie().sort(null).value(function(t){return t})),S=w.selectAll(".arc").data(T(s)).enter().append("g").attr("value",function(t,e){return e}).style("fill",function(t,e){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=w.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("x1",0).attr("y1",0).attr("x2",k*Math.sin(t.midAngle)).attr("y2",-(k*Math.cos(t.midAngle))).attr("gradientUnits","userSpaceOnUse").attr("gradientTransform","rotate(0)");return n.append("stop").attr("offset","0").attr("stop-color",function(){return a(d[e],.3)}),n.append("stop").attr("offset","1").attr("stop-color",function(){return a(d[e],-.3)}),"url(#rectangleGradient"+e+")"}).on("mouseover",function(){d3.select(this).attr("value");d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=8;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"}).attr("stroke","white")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=l[t],n=s[t],r=[{headingName:u,headingVal:n}];H.showToolTip(d3.event,"",e,!1,r,.96*d3.event.pageY)}).on("mouseout",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)").attr("stroke","none"),H.hideTooTip()});S.append("path").attr("d",C).transition().duration(1500).attrTween("d",r);var L,D,N;if("left"==f)N=v/2-l.length/2*m*2,L=p.append("g").attr("class","legend").attr("transform","translate(2,"+N+")"),e(l,d,m,L);else if("right"==f)D=i/2+(k+10),N=v/2-l.length/2*m*2,L=p.append("g").attr("class","legend").attr("transform","translate("+D+","+N+")"),e(l,d,m,L);else if("top"==f){D=.15*g,N=5,L=p.append("g").attr("class","legend").attr("transform","translate("+D+","+N+")");{var _=n(.7*g,0,l,m);L.selectAll(".rect").data(_).enter().append("rect").attr("width",m).attr("height",m).attr("x",function(t,e){return _[e].x}).attr("y",function(t,e){return _[e].y}).attr("fill",function(t,e){return d[e]}),L.selectAll(".text").data(_).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return _[e].textXPos}).attr("y",function(t,e){return _[e].y+m}).text(function(t,e){return l[e]})}}else{D=.15*g,N=v/2-2*m+k+4,L=p.append("g").attr("class","legend").attr("transform","translate("+D+","+N+")");{var _=n(.7*g,0,l,m);L.selectAll(".rect").data(_).enter().append("rect").attr("width",m).attr("height",m).attr("x",function(t,e){return _[e].x}).attr("y",function(t,e){return _[e].y}).attr("fill",function(t,e){return d[e]}),L.selectAll(".text").data(_).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return _[e].textXPos}).attr("y",function(t,e){return _[e].y+m}).text(function(t,e){return l[e]})}}c(p)},dountChartWithLegend:function(t){function e(t){var e=r(t);b.value.splice(0,0,x.value[e]),b.key.splice(0,0,x.key[e]),b.color.splice(0,0,x.color[e]),x.value.splice(e,1),x.key.splice(e,1),x.color.splice(e,1),o()}function n(t){for(var e=0;e<b.key.length&&b.key[e]!=t;e++);return x.value.splice(0,0,b.value[e]),x.key.splice(0,0,b.key[e]),x.color.splice(0,0,b.color[e]),o(),b.color[e]}function r(t){for(var e=0;e<x.key.length&&x.key[e]!=t;e++);return e}function a(t){for(var e,n=0,r=0;r<x.value.length;r++)x.key[r]==t&&(e=x.value[r]),n+=x.value[r];return Math.round(e/n*100)}function i(t,e){var n=r(t),i=[{headingName:x.label,headingVal:a(t)+"%"}];H.showToolTip(e,"",x.key[n],!1,i,.95*d3.event.pageY)}function o(){p.select("#group").remove(),T=C.append("g").attr("id","group").attr("transform","translate("+(A+w.left+w.right)/2+","+((M+w.top+w.bottom)/2-w.top)+")");var t=T.selectAll(".arc").data(D(x.value)).enter().append("g").attr("value",function(t,e){return x.key[e]}).attr("fill",function(t,e){return x.color[e]}).on("mouseover",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle+t.startAngle)/2;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"})}).on("mousemove",function(){i(d3.select(this).attr("value"),d3.event)}).on("mouseleave",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),H.hideTooTip()});t.append("path").attr("d",L).transition().duration(1500).attrTween("d",l);try{c(N)}catch(e){}}function l(t){var e=d3.interpolate({startAngle:-180*v,endAngle:-180*v},t);return function(t){return L(e(t))}}var s,u,d,f,h=0,g=0,v=Math.PI/180,y=t.divId,x=t.data,b={key:[],value:[],color:[]},A=parseInt(d3.select("#"+y).style("width")),M=parseInt(d3.select("#"+y).style("height"));301>A||301>M?(d=10,f=6,textSpace=7):401>A||401>M?(d=12,f=9,textSpace=9):601>A||601>M?(d=14,f=10,textSpace=12):(d=15,f=11,textSpace=19);{var k,w={top:.1*M,right:.1*A,bottom:.2*M,left:.1*A},A=A-w.left-w.right,M=M-w.top-w.bottom;x.key.length,d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").text("a simple tooltip")}A>M?(s=M/2,k=.05*M):(s=A/2,k=.05*A),u=s-.5*s;var C=(d3.select("#"+y),p),T=C.append("g").attr("id","group").attr("transform","translate("+(A+w.left+w.right)/2+","+((M+w.top+w.bottom)/2-w.top)+")"),S=2*s,L=d3.svg.arc().innerRadius(u).outerRadius(s),D=d3.layout.pie().sort(null).value(function(t){return t});o();var N=C.append("g").attr("transform","translate("+((A+w.left+w.right)/2-s)+","+((M+w.top+w.bottom)/2+s)+")");N.selectAll("rect").data(x.value).enter().append("rect").attr("class","legend").attr("value",function(t,e){return x.key[e]}).attr("fill",function(t,e){return x.color[e]}).attr("x",function(t,e){return e>3?parseInt(e/4)-1+.3*h++*S:.3*e*S}).attr("y",function(t,e){return e>3?2*k:void 0}).attr("width",k).attr("height",k).on("click",function(){"gray"==d3.select(this).attr("fill")?(d3.select(this).attr("fill",n(d3.select(this).attr("value"))),d3.select(this).style("text-decoration","none")):(d3.select(this).attr("fill","gray"),d3.select(this).style("text-decoration","line-through"),e(d3.select(this).attr("value")))});var _=N.selectAll("text").data(x.value).enter().append("text").attr("x",function(t,e){return e>3?parseInt(e/4)-1+.3*g++*S+k+3:.3*e*S+k+3}).attr("y",function(t,e){return e>3?3*k:k}).style("font-family","calibri").style("font-style","italic").text(function(t,e){return x.key[e]});c(p),_.style("fill",m.legendTextColor)},newDountChartWithBarAnalysis:function(t){function e(t){var e=i(s[t].subData);d3.select(".barGroup").remove();var n=T.append("g").attr("class","barGroup").attr("transform","translate("+.55*A+","+I+")"),a=n.selectAll(".rect").data(s[t].subData).enter().append("rect").attr("y",function(t,e){return 2*e*P}).attr("width",0).attr("height",P).attr("rx",.1*P).attr("ry",.1*P).attr("fill",function(t,e){var a=n.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return r(o[e],.5)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return r(o[e],-.5)}),"url(#rectangleGradient"+e+")"});a.transition().duration(1500).attr("width",function(t){var n=t/e,r=_*n;return r}),n.selectAll(".text").data(s[t].subData).enter().append("text").attr("x",5).attr("y",function(t,e){return 2*e*P+.65*P}).attr("fill","white").text(function(t){return Math.round(t/e*100)+u}),n.selectAll(".text").data(l).enter().append("text").attr("x",function(n,r){var a=s[t].subData[r]/e,i=_*a;return i+=5,i+8*n.toString().length<_?i:_-8*n.toString().length}).attr("y",function(t,e){return 2*e*P+.65*P}).text(function(t){return t})}function n(t){var e=d3.interpolate({startAngle:-180*x,endAngle:-180*x},t);return function(t){return z(e(t))}}function r(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}function a(t,e,n,r){r.selectAll(".circle").data(t).enter().append("circle").attr("id",function(t,e){return"legend"+e}).attr("cy",function(t,e){return 4*e*n}).attr("r",n).attr("fill",function(t,n){return e[n]}),r.selectAll(".text").data(t).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",n+4).attr("y",function(t,e){return 4*e*n+n/1.5}).text(function(t){return t})}function i(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}for(var o=t.subDataColor,l=t.subDataKey,s=t.obj,u=t.unit,d=[],f=[],h=[],y=t.title,m=0;m<s.length;m++)d.push(s[m].data),f.push(s[m].color),h.push(s[m].key);for(var x=Math.PI/180,b={left:.02*g,right:.02*g,bottom:.04*v,top:.04*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},A=g-b.left-b.right,M=v-b.top-b.bottom,k=0,w=0;w<h.length;w++)k<h[w].toString().length&&(k=h[w].toString().length);var C=9,k=k*C,T=p.append("g").attr("class","main-group").attr("transform","translate("+b.left+","+b.top+")"),S=.6*A-(k+C);S=.45*S;var L=T.append("g").attr("class","dountGroup").attr("transform","translate("+S+","+M/2+")"),D=M/2>S?S:M/2;D=.9*D;var N=.6*D,_=.45*A,P=2*D/l.length*.5,I=M/2-D,V=T.append("g").attr("class","fixBarGroup").attr("transform","translate("+.55*A+","+I+")");V.append("text").attr("y",-10).attr("id","subDataKey").style("font-size","16px","important").style("font-weight",600,"important").text(s[0].key);var F=(V.selectAll(".rect").data(l).enter().append("rect").attr("y",function(t,e){return 2*e*P}).attr("width",_).attr("height",P).attr("rx",.15*P).attr("ry",.15*P).attr("fill","#f5f5f5").style("style","border:1px solid black;border-radius: 15px;"),!0),z=d3.svg.arc().innerRadius(N).outerRadius(D),E=(d3.svg.arc().innerRadius(N-20).outerRadius(D+20),d3.layout.pie().sort(null).value(function(t){return t})),G=L.selectAll(".arc").data(E(d)).enter().append("g").attr("id",function(t,e){return"arc"+e}).attr("value",function(t,e){return e}).attr("startAngle",function(t){return t.startAngle}).attr("endAngle",function(t){return t.endAngle}).attr("fill",function(t,e){return f[e]}).on("click",function(){var t=parseInt(d3.select(this).attr("value"));p.select("#subDataKey").text(s[t].key),e(t)}).on("mouseover",function(){this.parentNode.appendChild(this);var t=parseInt(d3.select(this).attr("value"));p.select("#legend"+t).attr("r",Y+3),F&&(F=!1,d3.select("#legend"+(f.length-1)).attr("r",Y),d3.select("#arc"+(f.length-1)).transition().duration(500).ease("linear").attr("stroke",f[t]).attr("stroke-width",1)),d3.select(this).transition().duration(500).ease("bounce").attr("stroke",f[t]).attr("stroke-width",15)}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=y,n=[{headingName:s[t].key,headingVal:s[t].data}];H.showToolTip(d3.event,"",e,!1,n,.9*d3.event.pageY)}).on("mouseleave",function(){var t=parseInt(d3.select(this).attr("value"));d3.select("#legend"+t).attr("r",Y),d3.select(this).transition().duration(500).ease("linear").attr("stroke",f[t]).attr("stroke-width",1),H.hideTooTip()});G.append("path").attr("d",z).transition().duration(1500).attrTween("d",n);var Y=8,R=S+(D+b.left+20),O=v/2-h.length/2*Y*4;legendGroup=p.append("g").attr("class","legend").attr("transform","translate("+R+","+O+")"),a(h,f,Y,legendGroup),d3.select("#arc"+(f.length-1)).transition().duration(500).ease("linear").attr("stroke",f[f.length-1]).attr("stroke-width",15),d3.select("#legend"+(f.length-1)).attr("r",Y+3),e(s.length-1),c(p)},drawDountWithBarChart:function(t){function e(t){var e=r(t);M.value.splice(0,0,y.value[e]),M.key.splice(0,0,y.key[e]),M.color.splice(0,0,y.color[e]),y.value.splice(e,1),y.key.splice(e,1),y.color.splice(e,1),o()}function n(t){for(var e=0;e<M.key.length&&M.key[e]!=t;e++);return y.value.splice(0,0,M.value[e]),y.key.splice(0,0,M.key[e]),y.color.splice(0,0,M.color[e]),o(),M.color[e]}function r(t){for(var e=0;e<y.key.length&&y.key[e]!=t;e++);return e}function a(t){for(var e,n=0,r=0;r<y.value.length;r++)y.key[r]==t&&(e=y.value[r]),n+=y.value[r];return Math.round(e/n*100)}function i(t,e){var n=r(t);d3.event.pageY=d3.event.pageY;var i=[{headingName:y.label,headingVal:y.value[n]+" "+a(t)+"%"}];H.showToolTip(e,"",y.key[n],!1,i,.9*d3.event.pageY)
}function o(){p.select("#dountGroup").remove(),S=T.append("g").attr("id","dountGroup").attr("transform","translate("+.4*(k+C.left+C.right)/2+","+((w+C.top+C.bottom)/2-C.bottom)+")");var t=S.selectAll(".arc").data(z(y.value)).enter().append("g").attr("id",function(t,e){return y.key[e]}).attr("value",function(t,e){return y.key[e]}).attr("fill",function(t,e){return y.color[e]}).on("click",function(){s(d3.select(this).attr("value"))}).on("mouseover",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"})}).on("mousemove",function(){0==A&&(d3.select("#"+y.key[0]).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),A=1),i(d3.select(this).attr("value"),d3.event)}).on("mouseout",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),H.hideTooTip()});t.append("path").attr("d",F).transition().duration(1500).attrTween("d",l)}function l(t){var e=d3.interpolate({startAngle:-180*b,endAngle:-180*b},t);return function(t){return F(e(t))}}function s(t){p.select("#barGroup").remove();var e=T.append("g").attr("id","barGroup").attr("transform","translate("+(.4*(k+C.left+C.right)+C.left)+","+((w+C.top+C.bottom)/2-C.bottom-u/1.5)+")");d3.select("#showCountryGroup").remove();var n=T.append("g").attr("id","showCountryGroup").attr("transform","translate("+(.4*(k+C.left+C.right)+C.left)+","+((w+C.top+C.bottom)/2-C.bottom-u)+")");n.append("text").transition().duration(1500).attr("fill",y.color[r(t)]).style("font-family","calibri").style("font-size",2*f).style("font-style","italic").text(t);var a=d3.scale.linear().domain([0,d3.max(x[t])]).range([0,.32*k]),i=e.selectAll("g").data(x[t]).enter().append("g").attr("transform",function(t,e){return"translate(0,"+e*rectSize*2.6+")"}),o=i.append("rect").attr("width",function(){return 0}).attr("height",1.3*rectSize);o.transition().duration(1500).attr("width",function(e,n){return a(x[t][n])}).attr("fill",function(t,e){return x.color[e]});for(var l=0,s=0;s<x[t].length;s++)l+=x[t][s];i.append("text").transition().duration(1500).attr("x",function(e,n){return a(x[t][n])-2*f}).attr("y",1.3*rectSize/2).attr("dy",".35em").style("font-size",f+2).style("fill",y.textAndLegendColor).style("font-family","calibri").style("font-style","italic").text(function(e,n){return Math.round(x[t][n]/l*100)+"%  "+x.key[n]})}var u,d,f,h,g,v=t.divId,y=t.data,x=t.subDataArray,b=Math.PI/180,A=0,M={key:[],value:[],color:[]},k=parseInt(d3.select("#"+v).style("width")),w=parseInt(d3.select("#"+v).style("height"));301>k||301>w?(f=7,h=6,g=7):401>k||401>w?(f=10,h=9,g=9):601>k||601>w?(f=12,h=10,g=12):(f=14,h=11,g=19);var C={top:.1*w,right:.1*k,bottom:.2*w,left:.1*k},k=k-C.left-C.right,w=w-C.top-C.bottom,T=(d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").text("a simple tooltip"),d3.select("#"+v),p.append("g").attr("transform","translate(0,"+C.top+")")),S=T.append("g").attr("id","dountGroup").attr("transform","translate("+.4*(k+C.left+C.right)/2+","+(C.top+C.bottom)+")");.4*k>w?(u=w/2,rectSize=.06*w):(u=.4*k/2,rectSize=.4*k*.06),d=u-.5*u;var L=T.append("g").attr("id","lineGroup").attr("transform","translate("+(k+C.left+C.right)/2.4+",0)"),D=[0,(w+C.top+C.bottom)/2-C.bottom-u,0,(w+C.top+C.bottom)/2-C.bottom+u],N=0,_=d3.svg.line().x(function(){return D[N++]}).y(function(){return D[N++]}),P=L.append("path").data([D]).attr("stroke","lightgray").attr("stroke-width",1).attr("fill","none");P.attr("d",_);var V=2*u+2*I.right/2.5,F=d3.svg.arc().innerRadius(d).outerRadius(u),z=d3.layout.pie().sort(null).value(function(t){return t});o(),s(y.key[0]),d3.select("#"+y.key[0]).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"});var E=T.append("g").attr("transform","translate("+(.4*(k+C.left+C.right)/2-(u+C.right/2.5))+","+((w+I.top+I.bottom)/2-I.bottom+u+10)+")"),V=2*u+2*C.right/3,G=10,R=10,O=20,B=0,X=.05*V,q=.05*V,U=Y.getLegendPositionArray(y.key,V+.5*V,w);E.selectAll("rect").data(y.key).enter().append("rect").attr("class","legend").attr("value",function(t,e){return y.key[e]}).attr("fill",function(t,e){return y.color[e]}).attr("x",function(t,e){return U[e].x}).attr("y",function(t,e){return U[e].y}).attr("width",G).attr("height",R).on("click",function(){"gray"==d3.select(this).attr("fill")?(d3.select(this).attr("fill",n(d3.select(this).attr("value"))),d3.select(this).style("text-decoration","none")):(d3.select(this).attr("fill","gray"),d3.select(this).style("text-decoration","line-through"),e(d3.select(this).attr("value")))}),B=0,X=0*V+O,q=0*V,E.selectAll("text").data(y.key).enter().append("text").attr("x",function(t,e){return U[e].textPos}).attr("y",function(t,e){return U[e].y+R}).style("font-size",f).style("fill",y.textAndLegendColor).style("font-style","italic").style("font-family","calibri").text(function(t){return t}),c(p),E.selectAll("text").style("fill",m.legendTextColor)},multipleDountChartAnalysis:function(t){function e(t){var e=d3.interpolate({startAngle:-180*h,endAngle:-180*h},t);return function(t){return S(e(t))}}var n,r,a,i,o={left:.05*g,right:.05*g,bottom:.05*v,top:.05*v,chartSeparator:10,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},l=g-o.left-o.right,s=v-o.top-o.bottom,d=t.data.length,f=1,h=Math.PI/180,y=.015*l,x=1.3*y;a=.8*l/Math.round(d/2)/2<s/2?.8*l/Math.round(d/2)/2:s/2,a=.4*a,i=.75*a;var b=8,A=g/2-t.title.length*b/2,M=p.append("g").attr("class","title");R.appendLabel(t.title,A,o.top,0,M,m.chartTitleColor,800);for(var k,w,C=d3.layout.pie().sort(null).value(function(t){return t}),T=0;d>T;T++){1==d?(n=p.append("g").attr("id","dount-main-group").attr("class","legend").attr("transform","translate("+.8*l/2+","+.5*s+")"),a=s>.8*l?.8*l:s,a=.4*a,i=.75*a):T<Math.round(d/2)?(k=.3*s,n=p.append("g").attr("id","dount-main-group"+T).attr("class","legend").attr("transform","translate("+(.8*l/Math.round(d/2)*(T+1)/2+1.5*T*a)+","+k+")")):(w=d>6?k+4*a:k+3*a,n=p.append("g").attr("id","dount-main-group"+T).attr("class","legend").attr("transform","translate("+(.8*l/Math.round(d/2)*f/2+1.5*(f++-1)*a)+","+w+")"));var S=d3.svg.arc().innerRadius(i).outerRadius(a);r=n.selectAll(".arc").data(C(t.data[T].dountData)).enter().append("g").attr("value",function(t,e){return T+" "+e}).attr("fill",function(e,n){return t.data[T].colorArray[n]}).on("mouseover",function(){{var t=d3.select(this).attr("value");t.split(" ")}d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=7;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"})}).on("mousemove",function(){var e=d3.select(this).attr("value"),n=e.split(" ");console.log(t.data[parseInt(n[0])].dountKey[parseInt(n[1])]);var r=[{headingName:t.data[parseInt(n[0])].dountKey[parseInt(n[1])],headingVal:t.data[parseInt(n[0])].dountData[parseInt(n[1])]+" "+t.unit}];H.showToolTip(d3.event,"",t.data[parseInt(n[0])].className,!1,r,.93*d3.event.pageY)}).on("mouseout",function(){d3.select(".ShowArc").attr("display","none"),d3.select(this).transition().duration(500).ease("linear").attr("transform","translate(0,0)")}).on("mouseleave",function(){H.hideTooTip()}),r.append("path").attr("d",S).transition().duration(1500).attrTween("d",e),n.append("text").attr("x",-(6*t.data[T].totalStudent.length)/2).attr("y",3).attr("font-family","calibri").text(t.data[T].totalStudent),n.append("text").attr("x",-(6*t.data[T].className.length/2)).attr("y",a+11).attr("font-family","calibri").text(t.data[T].className)}var L=p.append("g").attr("class","legend").attr("transform","translate("+.8*l+","+.3*s+")"),D=L.selectAll("rect").data(t.legend).enter().append("rect").attr("width",y).attr("height",y).attr("x",function(){return.78*-l}).attr("y",function(){return s}).attr("fill",function(e,n){return t.legendColor[n]});D.transition().duration(1500).attr("x",0).attr("y",function(t,e){return 2*e*y});var N=L.selectAll("text").data(t.legend).enter().append("text").attr("x",function(){return.78*-l}).attr("y",function(t,e){return 2*e*y+y/2}).attr("dy",".31em").attr("font-family","calibri").attr("font-size",x).text(function(t){return t});N.transition().duration(1500).attr("x",y+8),L.append("line").attr("x1",-(.75*l*.1)).attr("y1",-y/2).attr("x2",-(.75*l*.1)).attr("y2",2*t.legend.length*y).attr("stroke","lightsteelblue"),u(p),c(p)}},le={drawHeatMapChart:function(t,e,n){function r(t){R.select(" #img").style("display","block"),R.select("#img").transition().attr("x",g-.09*g).attr("y",B(t.hours))}function a(){R.select("#img").style("display","none")}var i={colorLow:"#F6fdff",colorMed:"#81DCFF",colorHigh:"#0BBCFF",yAxisLabelSpacing:50};if("undefined"!=typeof n)for(var o in n)"undefined"!=typeof n[o]&&(i[o]=n[o]);var l=[],s=e.yAxisValue,d=[],f=(.7*g/s.length,{top:.03*v,right:1/12*g,bottom:.05*v,left:8/60*g}),h=g-i.yAxisLabelSpacing,y=v-.03*v-f.top-f.bottom,m=e.data,x=0;for(var b in m){var A=m[b];d.push(b);for(var M=0;M<A.length;M++){var k={};k.row=x,k.col=M,k.hours=A[M],l.push(k)}x++}var C=d3.min(l,function(t){return t.hours}),L=d3.max(l,function(t){return t.hours}),D=d3.scale.linear().domain([C,(C+L)/2,L]).range([i.colorLow,i.colorMed,i.colorHigh]),N=.8*v/s.length;w=.7*g/x;for(var _=(d3.scale.linear().range([0,h]),d3.scale.linear().range([y,0]),d3.scale.ordinal().domain(d3.range(x)).rangeRoundBands([0,w*x],.05)),P=d3.scale.ordinal().domain(d3.range(s.length)).rangeRoundBands([0,N*s.length],.1),I=d3.svg.axis().scale(_).orient("bottom").ticks(5),V=d3.svg.axis().scale(P).tickFormat(function(t){return s[t]}).orient("left").ticks(5),F=p.append("svg").attr("width",h+f.right/2).attr("height",y+f.top+f.bottom).append("g").attr("transform","translate("+.15*h+","+f.top+")"),z=(F.selectAll("g").data(l,function(t){return t.col+":"+t.row}).enter().append("svg:rect").attr("x",function(t){return t.row*w}).attr("y",function(t){return t.col*N}).attr("width",function(){return w}).attr("height",function(){return N}).style("fill",function(t){return D(t.hours)}).on("mouseover",function(t){d3.select(this).style("fill","cyan");var e=d3.event.pageX;r(t,e)}).on("mouseout",function(){d3.select(this).style("fill",function(t){return D(t.hours)}),a()}),F.selectAll("g").data(l,function(t){return t.col+":"+t.row}).enter().append("svg:text").attr("x",function(t){return t.row*w}).attr("y",function(t){return t.col*N}).attr("text-anchor","middle").attr("font-family","sans-serif").attr("font-size",function(){return w*N/(2.5*(w+N))}).attr("dy",function(t){return t.row+N/2}).attr("dx",function(t){return t.col+w/2}).text(function(t){return t.hours}).on("mouseover",function(t){var e=d3.event.pageX;r(t,e)}).on("mouseout",function(){a()}),[]),E=0;E<d.length;E++)z.push(E);I.tickValues(z),F.append("g").attr("class","x axis").attr("transform","translate(0,"+N*s.length+")").call(I).selectAll("text").text(function(t){return d[t]}).style("text-anchor","end").attr("dx","-1.0em").attr("dy","0.15em").attr("transform",function(){return"rotate(-45)"}),F.append("g").attr("class","y axis").call(V).selectAll("text").style("text-anchor","end").attr("dx","-0.0em").attr("dy","0.0em").attr("transform",function(){return"rotate(0)"});var G={top:20,right:20,bottom:30,left:8},Y=(g-G.left-G.right,v-G.top-G.bottom),R=p.append("svg").attr("width",g-G.left+G.right).attr("height",Y+G.top+G.bottom).append("g"),O=R.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("y1",P(0)).attr("x2","0%").attr("y2",P(s.length-1)).attr("gradientUnits","userSpaceOnUse");O.append("svg:stop").attr("offset","0%").attr("stop-color",D(C)).attr("stop-opacity",1),O.append("svg:stop").attr("offset","20%").attr("stop-color",D(10)).attr("stop-opacity",1),O.append("svg:stop").attr("offset","40%").attr("stop-color",D(20)).attr("stop-opacity",1),O.append("svg:stop").attr("offset","60%").attr("stop-color",D(30)).attr("stop-opacity",1),O.append("svg:stop").attr("offset","80%").attr("stop-color",D(40)).attr("stop-opacity",1),O.append("svg:stop").attr("offset","100%").attr("stop-color",D(L)).attr("stop-opacity",1),R.append("svg:rect").attr("x",g-.05*g).attr("y",f.top).attr("width",3*s.length).attr("height",N*s.length).style("fill","url(#gradient)");var B=(d3.max(l,function(t){return t.hours}),d3.scale.linear().range([N*s.length,0]));T=d3.min(l,function(t){return t.hours}),S=d3.max(l,function(t){return t.hours}),B.domain([S,T]);var X=d3.svg.axis().scale(B).orient("right").ticks(4).tickSize(5,0);R.append("g").attr("class","y axis").call(X).selectAll("text").style("text-anchor","right").attr("x",g-.09*g).attr("y",G.top).attr("dx","0.0em").attr("dy","0.0em").attr("transform",function(){return"rotate(0)"}),R.selectAll("line").style("display","none"),R.append("g").append("svg:image").attr("id","img").attr("xlink:href","http://stocinn.github.io/stocweb/img/pointer.png").attr("width",g/30).attr("height",g/30).style("display","none"),u(p),c(p)}},se={drawScatterPlotChart:function(t,e){function n(t,e,n,l){"circle"==e.shape?r(t,o(e),n,l,e):"square"==e.shape?a(t,o(e),n,l,e):i(t,o(e),n,l,e)}function r(t,e,n,r,a){t.selectAll("."+r+" dot").data(e.coordinates).enter().append("circle").attr("class",r+" dot").on("mousemove",function(t,e){var n=[{headingName:a.name+" "+h,headingVal:t.y}];H.showToolTip(d3.event,t.yVal,y+" "+f[e],!1,n,.95*d3.event.pageY)}).on("mouseout",function(){H.hideTooTip()}).attr("cx",function(){return 0}).attr("cy",function(){return 0}).transition().duration(1e3).attr("cx",function(t,e){return S(e)-2.5}).attr("cy",function(t){return L(t.y)}).attr("r",function(){return 5}).style("fill",function(t){return t.color})}function a(t,e,n,r,a){t.selectAll("."+r+" dot").data(e.coordinates).enter().append("rect").attr("class",r+" dot").on("mousemove",function(t,e){var n=[{headingName:a.name+" "+h,headingVal:t.y}];H.showToolTip(d3.event,t.yVal,y+" "+f[e],!1,n,.95*d3.event.pageY)}).on("mouseout",function(){H.hideTooTip()}).attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("x",function(t,e){return S(e)}).attr("y",function(t){return L(t.y)}).attr("width",10).attr("height",10).attr("fill",function(t){return t.color})}function i(t,e,n,r,a){t.selectAll(r+" dot").data(e.coordinates).enter().append("path").on("mousemove",function(t){var e=[{headingName:a.name+" "+h,headingVal:t.y}];H.showToolTip(d3.event,t.yVal,y+" "+f[U],!1,e,.95*d3.event.pageY)}).on("mouseout",function(){H.hideTooTip()}).attr("class",r+" dot").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(t,e){return"translate("+S(e)+","+L(t.y)+")"}).attr("fill",function(t){return t.color})}function o(t){var e={},n=[];for(e.coordinates=n,j=0;j<t.data.length;j++){var r={color:t.color,name:t.name,x:j,y:t.data[j]};e.coordinates.push(r)}return e}var l={padding:e.padding,toolTipLabel:"Population"};g=.9*g,v=.9*v;var s,d,f=e.xAxisTickArray,h=e.yIndicationLabel,y=e.xIndicationLabel,x=e.chartTitle,b=0,A=0,M=e.yAixsData;for(U=0;U<M.length;U++)s=d3.max(M[U].data,function(t){return t}),d=d3.max(M[U].data,function(t){return t}),s>b&&(b=s),d>A&&(A=d),M[U].legendName="legend-"+U;{var w=10,C=0;d3.scale.category20()}b=f.length-1;var T;T=40>.08*g?40:.08*g;var S=d3.scale.linear().domain([0,b]).range([T,g-.05*g]),L=d3.scale.linear().domain([0,1.5*A]).range([v-2*l.padding,l.padding]),D=(d3.scale.linear().domain([10,A]).range([5,10]),d3.format(".1%"),d3.svg.axis().scale(S).orient("bottom").ticks(5)),N=d3.svg.axis().scale(L).orient("left").ticks(5),_=p.append("g").attr("transform","translate("+T+","+C+")");for(W.init(_,v,g,.8*T,C+5,m.gridLineColor),iVal=0;iVal<M.length;iVal++)n(_,M[iVal],M[iVal].color,M[iVal].legendName);for(var P=f[0].toString().length,I=0;I<f.length;I++){var V=f[I].toString().length;V>P&&(P=V)}var F=X.getXTickArray(0,f.length,P,g-2*l.padding-l.padding);D.tickValues(F);var z=_.append("g").attr("class","axis").attr("transform","translate(0,"+(v-l.padding)+")").call(D);z.selectAll("text").text(function(t){return f[t]});for(var E=_.append("g").attr("class","axis").attr("transform","translate("+w+",0)").call(N),G=_.append("g").attr("class","legend").attr("width",g).attr("height",v).attr("transform","translate("+g/10+",50)"),O=10,B=10,q=[],U=0;U<M.length;U++)q.push(M[U].name);var $=Y.getLegendPositionArray(q,.98*g,v);for(k=0;k<M.length;k++)"square"==M[k].shape?(G.selectAll("rect").data([M[k]]).enter().append("rect").attr("x",function(){return $[k].x}).attr("y",function(){return $[k].y}).attr("width",B).attr("height",O).style("fill",function(t){return t.color}).on("click",function(t){var e=p.selectAll("."+t.legendName+".dot").style("display");if("none"==e)p.selectAll("."+t.legendName+".dot").style("display","block"),p.select(".rectLegend."+t.name).style("text-decoration","none");else{{p.selectAll("."+t.legendName+"line")}p.selectAll("."+t.legendName+".dot").style("display","none"),p.select(".rectLegend."+t.name).style("text-decoration","line-through")}}),G.selectAll(".rectLegend").data([M[k]]).enter().append("text").attr("class",function(t){return"rectLegend "+t.name}).attr("x",function(){return $[k].textPos}).attr("y",$[k].y+O/2).attr("width",M.length/300*g).attr("height",M.length/300*g).attr("font-size",.02*(g+v)/2).attr("dy",".50em").text(function(t){return t.name})):"circle"==M[k].shape?(G.selectAll("circle").data([M[k]]).enter().append("circle").attr("cx",$[k].x).attr("cy",$[k].y+O/2).attr("r",function(){return B/2}).style("fill",function(t){return t.color}).on("click",function(t){var e=p.selectAll("."+t.legendName+".dot").style("display");if("none"==e)p.selectAll("."+t.legendName+".dot").style("display","block"),p.select(".circleLegend."+t.name).style("text-decoration","none");else{{p.selectAll("."+t.legendName+"line")}p.selectAll("."+t.legendName+".dot").style("display","none"),p.select(".circleLegend."+t.name).style("text-decoration","line-through")}}),G.selectAll("text1").data([M[k]]).enter().append("text").attr("class",function(t){return"circleLegend "+t.name}).attr("x",function(){return $[k].textPos}).attr("y",$[k].y+O/2).attr("font-size",.02*(g+v)/2).attr("dy","0.50em").text(function(t){return t.name})):"triangle"==M[k].shape&&(G.selectAll("triangle").data([M[k]]).enter().append("path").attr("x",function(){return $[k].x}).attr("y",$[k].y).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(){return"translate("+$[k].x+","+($[k].y+O/2)+")"}).style("fill",function(t){return t.color}).on("click",function(t){var e=p.selectAll("."+t.legendName+".dot").style("display");if("none"==e)p.selectAll("."+t.legendName+".dot").style("display","block"),p.select(".triangleLegend."+t.name).style("text-decoration","none");else{{p.selectAll("."+t.legendName+".line")}p.selectAll("."+t.legendName+".dot").style("display","none"),p.select(".triangleLegend."+t.name).style("text-decoration","line-through")}}),G.selectAll("text2").data([M[k]]).enter().append("text").attr("class",function(t){return"triangleLegend "+t.name}).attr("x",function(){return $[k].textPos}).attr("y",$[k].y+O/2).attr("font-size",.02*(g+v)/2).attr("dy",".50em").text(function(t){return t.name}));var J=8,Z=h.toString().length*J,K=v/2+Z/2;R.appendLabel(h,.9*-T,K,-90,E,m.yLabelColor,600);var Q=y.toString().length*J,te=g/2-Q/2;R.appendLabel(y,te,.15*v,0,z,m.xLabelColor,600);var J=9,ee=g/1.6-x.length*J/2,ne=p.append("g").attr("class","title");R.appendLabel(x,ee,.06*v,0,ne,m.chartTitleColor,800),u(p),c(p)}},ue={drawThreeDBarChart:function(e){function n(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}var r,a=e.yAxisData,i=e.xAxisData,o=e.yAxisUnit,l=e.yAxisLabel,s=e.xAxisLabel,d=e.title,h=e.barColor,y=B.leftMarginController(a),x={left:y,right:.05*g,bottom:45,top:.2*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},b=g-x.left-x.right,A=v-x.top-x.bottom,M=t(f).offset().left,k=b/(1.8*i.length);r=k>60?.3*k:.4*k;for(var w=[],C=[],T=12,S="calibri",L=[],D=0;D<i.length;D++)L[D]=D;var N=p.append("g").attr("class","main-group").attr("transform","translate("+x.left+","+x.top+")"),_=7,P=g/2-d.length*_/2,I=p.append("g").attr("class","title");R.appendLabel(d,P,x.top/2,0,I,m.chartTitleColor,800);var _=7,V=l.toString().length*_,F=A/2+V/2,z=-x.left+15;R.appendLabel(l,z,F,-90,N,m.yLabelColor,600);var E=s.toString().length*_,G=A+(x.bottom-5),Y=b/2-E/2;R.appendLabel(s,Y,G,0,N,m.xLabelColor,600);for(var q=(parseInt(A/k),d3.scale.linear().domain([0,i.length-1]).range([.8*k,b-.8*k])),U=O.getMin(a),j=O.getMax(a),W=d3.scale.linear().domain([U,j]).range([A,0]),$=0,D=0;D<i.length;D++)$<i[D].toString().length&&($=i[D].toString().length);var J=d3.svg.axis().scale(q).orient("bottom").tickValues(X.getXTickArray(0,i.length,$,b)),Z=N.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+A+")").call(J);Z.selectAll("text").text(function(t){return i[t]});var K=X.getTickArray(U,j,8),Q=d3.svg.axis().scale(W).orient("left").tickValues(K);N.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(Q).selectAll("text").style("font-size",T).style("font-family",S).attr("fill","black");for(var te,ee=d3.svg.line().x(function(t){return t}).y(function(t,e){return C[e]}),ne=d3.svg.line().x(function(t){return t}).y(function(){return A}),re=0;re<K.length;re++){w[0]=0,C[0]=W(K[re]),w[1]=r,C[1]=W(K[re])-20,w[2]=b,C[2]=C[1],te=N.selectAll(".path").data([w]).enter().append("path").attr("d",ee).attr("class","horizontalGridLine").attr("fill","none").attr("stroke",m.gridLineColor);var ae=te.node().getTotalLength();te.attr("stroke-dasharray",function(){return ae+","+ae}).attr("stroke-dashoffset",ae).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var ie=n(h,-.11),oe=n(h,-.1),D=0;D<a.length;D++){w[0]=q(D)-.8*k,C[0]=W(a[D])+r,w[1]=w[0]+.25*k,C[1]=C[0]-r,w[2]=w[1]+k,C[2]=C[1],w[3]=w[0]+k,C[3]=C[0];var le=N.append("svg:defs").append("svg:linearGradient").attr("id","upperGradient").attr("x1",w[0]).attr("y1",C[0]).attr("x2",w[3]).attr("y2",C[3]).attr("gradientUnits","userSpaceOnUse");le.append("svg:stop").attr("offset","0%").attr("stop-color",n(ie,-.4)).attr("stop-opacity",1),le.append("svg:stop").attr("offset","100%").attr("stop-color",n(ie,.4)).attr("stop-opacity",1),te=N.selectAll(".path").data([w]).enter().append("path").attr("class","pathClass").attr("d",ne).attr("fill","url(#upperGradient)"),te.transition().duration(2e3).ease("elastic").attr("d",ee),w[0]=w[3],C[0]=W(U),w[1]=w[3],C[1]=C[3],w[3]=w[3]+.25*k,C[3]=W(U)-r;var se=N.append("svg:defs").append("svg:linearGradient").attr("id","rightGradient").attr("x1",w[0]).attr("y1",C[0]).attr("x2",w[3]).attr("y2",C[3]+r).attr("gradientUnits","userSpaceOnUse");se.append("svg:stop").attr("offset","0%").attr("stop-color",n(oe,.6)).attr("stop-opacity",1),se.append("svg:stop").attr("offset","100%").attr("stop-color",n(oe,-.4)).attr("stop-opacity",1),te=N.selectAll(".path").data([w]).enter().append("path").attr("class","pathClass").attr("d",ne).attr("fill","url(#rightGradient)"),te.transition().duration(2e3).ease("elastic").attr("d",ee),w[0]=q(D)-.8*k,C[0]=W(U),w[1]=w[0],C[1]=W(a[D])+r,w[2]=w[1]+k,C[2]=C[1],w[3]=w[2],C[3]=C[0];var ue=N.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1",w[0]).attr("y1",C[0]).attr("x2",w[3]).attr("y2",C[3]).attr("gradientUnits","userSpaceOnUse");ue.append("svg:stop").attr("offset","0%").attr("stop-color",n(h,-.4)).attr("stop-opacity",1),ue.append("svg:stop").attr("offset","100%").attr("stop-color",n(h,.4)).attr("stop-opacity",1),te=N.selectAll(".path").data([w]).enter().append("path").attr("class","pathClass").attr("d",ne).attr("fill","url(#gradient)"),te.transition().duration(2e3).ease("elastic").attr("d",ee)}d3.selectAll(".pathClass").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=M+x.left,t=Math.round(q.invert(t));var e=i[t],n=a[t]+" "+o,r=[{headingName:l,headingVal:n}];H.showToolTip(d3.event,"",e,!1,r,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}),u(p),c(p)}},ce={drawBasicLineChart:function(t,e){function n(t,e,n){"circle"==e.Shape?r(t,e,n,e.legendName):"square"==e.Shape?a(t,e,n,e.legendName):i(t,e,n,e.legendName)}function r(t,e,n,r){var a=[e.data],i=t.selectAll("svg").data(a).enter().append("g").attr("transform","translate("+w.left+","+w.top+")"),o=i.append("path").attr("class",r+"line "+e.legendName).attr("d",D).attr("fill","none").style("stroke",n).style("stroke-width",y),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll("."+r+"dot").data(function(t){return t}).enter().append("circle").attr("xVal",function(t,e){return d[e]}).attr("yVal",function(t){return t}).on("mousemove",function(t,n){d3.select(this).attr("stroke","white").attr("stroke-width","3px");var r=[{headingName:e.Name,headingVal:t}];H.showToolTip(d3.event,t.yVal,d[n],!1,r,.95*d3.event.pageY)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px");d3.select(this);H.hideTooTip()}).attr("class",r+"dot circle").attr("x",0).attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("y",0).transition().duration(2e3).attr("cx",D.x()).attr("cy",D.y()).attr("r",5).attr("fill",n)}function a(t,e,n,r){var a=[e.data],i=t.selectAll("svg").data(a).enter().append("g").attr("transform","translate("+w.left+","+w.top+")"),o=i.append("path").attr("class",function(){return r+"line "+e.legendName}).attr("d",D).attr("fill","none").style("stroke",n).style("stroke-width",y),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll("."+r+"dot").data(function(t){return t}).enter().append("rect").attr("xVal",function(t,e){return d[e]}).attr("yVal",function(t){return t}).on("mousemove",function(t,n){d3.select(this).attr("stroke","white").attr("stroke-width","3px");var r=[{headingName:e.Name,headingVal:t}];H.showToolTip(d3.event,t.yVal,d[n],!1,r,.95*d3.event.pageY)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px"),H.hideTooTip()}).attr("class",r+"dot square").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("x",N.x()).attr("y",N.y()).attr("width",8).attr("height",8).attr("fill",n)}function i(t,e,n,r){var a=[e.data],i=t.selectAll("svg").data(a).enter().append("g").attr("transform","translate("+w.left+","+w.top+")"),o=i.append("path").attr("class",r+"line "+e.legendName).attr("d",D).attr("fill","none").style("stroke",n).style("stroke-width",y),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll(r+"dot").data(function(t){return t}).enter().append("path").attr("xVal",function(t,e){return d[e]}).attr("yVal",function(t){return t}).on("mousemove",function(t,n){d3.select(this).attr("stroke","white").attr("stroke-width","2px");var r=[{headingName:e.Name,headingVal:t}];H.showToolTip(d3.event,t.yVal,d[n],!1,r,.95*d3.event.pageY)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px");d3.select(this);H.hideTooTip()}).attr("class",r+"dot triangle").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(t,e){return"translate("+T(e)+","+S(t)+")"}).attr("fill",n)}var o,l,s={padding:e.padding,yAxisfactor:e.yAxisfactor,yLabelColor:e.yLabelColor,xAxisfactor:e.xAxisfactor,xLabelColor:e.xLabelColor},d=e.xAxisTickArray,f=0,h=999999,y=e.lineStrokeWidth,x=e.yAxisData,M=x[0].data;for(z=0;z<x.length;z++)o=d3.max(x[z].data,function(t,e){return t.xVal=d[e],t.timeIndex=e,t.shape=x[z].shape,t}),l=d3.min(x[z].data),o>f&&(f=o),h>l&&(h=l),x[z].legendName="legend-"+z;0==h?h-=2:h=0>h?1.5*h:.3*h,0==f?f+=2:f=f>0?1.5*f:.7*f;var k=B.leftMarginController(M),w={top:.025*v,right:40,bottom:45,left:k};g=g-w.left-w.right,v=v-w.top-w.bottom;var C=d.length-1,T=d3.scale.linear().domain([0,C]).range([.02*g,g]),S=d3.scale.linear().domain([h,f]).range([v,0]);A=d3.svg.axis().scale(T).orient("bottom"),b=d3.svg.axis().scale(S).tickValues(X.getTickArray(h,f,6)).orient("left");var L=(s.yAxisfactor,p.append("g").attr("transform","translate(0,0)"));W.init(L,v,g,w.left,w.top,m.gridLineColor);{var D=d3.svg.line().x(function(t,e){return T(e)}).y(function(t){return S(t)}).interpolate("cardinal"),N=d3.svg.line().x(function(t,e){return T(e)-3}).y(function(t){return S(t)-3}).interpolate("cardinal");d3.svg.line().x(function(t,e){return T(e)-3}).y(function(t){return S(t)-3}).interpolate("cardinal"),d3.svg.area().x(D.x()).y1(D.y()).y0(S(0))}for(iVal=0;iVal<x.length;iVal++)n(L,x[iVal],x[iVal].color,x[iVal].Name);for(var _=L.append("g").attr("class","legend").attr("transform","translate("+w.left+",0)"),P=25,I=8,V=1.3*w.top,F=[],z=0;z<x.length;z++)F.push(x[z].Name);for(var E=Y.showHorizontalLegend(g,V,F,P,I),G=(_.selectAll(".rect").data(x).enter().append("rect").attr("width",P).attr("height",I).attr("x",function(t,e){return E[e].x}).attr("y",function(t,e){return E[e].y}).attr("rx",4).attr("ry",4).style("fill",function(t){return t.color}).on("click",function(t){var e=p.selectAll("."+t.legendName+"dot").style("display");if("none"==e){var n=p.selectAll("."+t.legendName+"line");n.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0),p.selectAll("."+t.legendName+"dot."+t.Shape).style("display","block"),console.log(t.legendName+"dot"+t.Shape),p.select("#"+t.legendName+"text").style("text-decoration","none")}else{var n=p.selectAll("."+t.legendName+"line"),r=n.node().getTotalLength();n.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",r),p.selectAll("."+t.legendName+"dot."+t.Shape).style("display","none"),console.log(t.legendName+"dot"+t.Shape),p.select("#"+t.legendName+"text").style("text-decoration","line-through")}}),_.selectAll(".text").data(x).enter().append("text").attr("id",function(t){return t.legendName+"text"}).attr("x",function(t,e){return E[e].textXPos}).attr("y",function(t,e){return E[e].y+I}).text(function(t){return t.Name}),d[0].toString().length),O=0;O<d.length;O++){var q=d[O].toString().length;q>G&&(G=q)}var U=X.getXTickArray(0,d.length,G,g-.02*g);A.tickValues(U);var j=L.append("g").attr("class","x axis").attr("transform","translate("+w.left+","+(v+w.top)+")").call(A);j.selectAll("text").text(function(t){var e="";return e=d[t]});var $=L.append("g").attr("class","y axis").attr("transform","translate("+w.left+","+w.top+")").call(b),J=v/2+s.yAxisfactor.length/2*5,Z=-w.left+15;R.appendLabel(s.yAxisfactor,Z,J,-90,$,m.yLabelColor,600);var K=w.bottom-5,Q=g/2-s.xAxisfactor.length/2*5;R.appendLabel(s.xAxisfactor,Q,K,0,j,m.xLabelColor,600),u(p),c(p)}},de={drawStackedAreaChart:function(t,e,n){var r={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),yAxisTootltipLabel:"Cost(in Crores): "};if("undefined"!=typeof n)for(var a in n)"undefined"!=typeof n[a]&&(r[a]=n[a]);var i=e,o={top:20,right:30,bottom:30,left:40};g=g-o.left-o.right,v=v-o.top-o.bottom;var l=d3.scale.ordinal().rangePoints([0,g]),s=d3.scale.linear().range([v,0]),d=d3.scale.category20(),f=d3.svg.axis().scale(l).orient("bottom"),h=d3.svg.axis().scale(s).orient("left"),y=d3.layout.stack().offset("zero").values(function(t){return t.values
}).x(function(t){return t}).y(function(t){return t.y}),m=d3.nest().key(function(t){return t.name}),x=d3.svg.area().x(function(t){return l(t.category)}).y0(function(t){return s(t.y0)}).y1(function(t){return s(t.y0+t.y)}),b=p.append("svg").attr("width",g+o.left+o.right).attr("height",v+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")");i.forEach(function(t){t.value=+t.value});var A=y(m.entries(i));l.domain(["Dec","Jan","Feb"]),s.domain([0,d3.max(i,function(t){return t.y0+t.y})]);var M=b.selectAll(".layer").data(A).enter().append("g");M.append("path").attr("class","area").attr("d",function(t){return x(t.values)}).style("fill",function(){return"white"}).on("mousemove",function(t){var e=[{headingName:r.yAxisTootltipLabel+" "+t.values[0].name,headingVal:t.values[0].y}];H.showToolTip(d3.event,"",r.xLabel,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).transition().delay(function(t,e){return 500*e}).ease("back").style("fill",function(t,e){return d(e)}),M.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").transition().duration(2e3).call(f),M.append("g").attr("class","y axis").transition().duration(2e3).call(h),u(p),c(p)}},fe={drawFunnelChart:function(t){function e(t){return t*(Math.PI/180)}for(var n,r,a,i=t.funnelData,o=t.funnelKey,l=t.colorArray,s=t.unit,u=t.label,d={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:10,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},f=g-d.left-d.right,h=v-d.top-d.bottom,y=.035*h,m=p.append("g").attr("class","main-group").attr("transform","translate("+d.left+","+d.top+")"),x=d3.svg.line().x(function(t,e){return C[e]}).y(function(t,e){return T[e]}).interpolate("basis-closed"),b=d3.svg.line().x(function(t,e){return C[e]}).y(function(t,e){return T[e]}),A=d3.svg.line().x(function(t,e){return z[e]}).y(function(t,e){return E[e]}),M=d3.svg.line().x(function(t,e){return S[e]}).y(function(t,e){return L[e]}).interpolate("basis-closed"),k=0,w=0,C=[],T=[],S=[],L=[],D=0,N=0;N<o.length;N++)D<o[N].toString().length&&(D=o[N].toString().length);D=5.5*D;for(var _,P=f-D,I=.95*P,V=P/2-I/2,F=0,z=[P/2,P/2,P/2,P/2],E=[h+40,h+40,h+40,h+40],G=0;G<i.length;G++)k+=i[G];for(var Y=h+i.length*d.chartSeparator,R=Y/(I/2),O=Math.atan(R)*(180/Math.PI),B=Math.tan(e(O)),X={},q={},U=0;U<i.length;U++){C=[],T=[],S=[],L=[],w=i[U]/k;var j;j=Math.abs(U!=i.length-1?Y*w/B:Y*w/2/B),_=2*(P/2-V)+V,C.push(V),C.push(V+j),C.push(_-(C[1]-V)),C.push(_),T.push(F),U!=i.length-1?(T.push(F+h*w),T.push(F+h*w)):(T.push(F+h*w/2),T.push(F+h*w/2)),T.push(F),m.append("linearGradient").attr("id","gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",C[0]).attr("y1",T[0]).attr("x2",C[3]).attr("y2",T[2]).selectAll("stop").data([{offset:"15%",color:l[U]},{offset:"62%",color:"#eaeaea"},{offset:"85%",color:l[U]}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color});var W=m.selectAll(".path").data([z]).enter().append("path").attr("d",A).attr("value",U).attr("stroke-width",1).attr("fill","url(#gradient)").on("mousemove",function(){for(var t=d3.select(this).attr("value"),e=0,n=0;n<i.length;n++)e+=i[n];var r=Math.round(i[t]/e*100),a=[{headingName:u,headingVal:r+" "+s}];H.showToolTip(d3.event,"",o[t],!1,a,.9*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});W.transition().duration(1e3).ease("linear").attr("d",b(C)),m.append("line").attr("class","horizontalLine").attr("x1",function(){return(C[3]+C[2])/2+5}).attr("y1",function(){return U!=i.length-1?(T[3]+T[2])/2:T[2]}).attr("x2",function(){return P/2+I/2}).attr("y2",function(){return U!=i.length-1?(T[3]+T[2])/2:T[2]}).style("stroke","#a7a7a7");var $=p.append("g").attr("class","legend").attr("transform","translate("+d.left+","+d.top+")");$.append("text").attr("class","text").attr("x",function(){return P/2+I/2+5}).attr("y",function(){return U!=i.length-1?(T[3]+T[2])/2+3:T[2]+3}).text(o[U]).style("font-family","calibri"),V=C[1]+2,F=T[1]+d.chartSeparator,S[0]=C[1],S[2]=C[2],S[1]=(C[1]+C[2])/2,S[3]=S[1];var J=(S[1]-S[0])/2;S[0]=S[0]-J,S[2]=S[2]+J,L[0]=T[1],L[1]=L[0]-y,L[2]=T[1],L[3]=L[0]+y,X[U]=S,q[U]=L,n=C[1],r=T[1],a=C[2]-C[1],C[2]=C[3],C[1]=(C[0]+C[2])/2,C[3]=C[1];var Z=(C[1]-C[0])/2;C[0]=C[0]-Z,C[2]=C[2]+Z,T[1]=T[0]-y,T[2]=T[0],T[3]=T[0]+y;{m.selectAll(".path").data([C]).enter().append("path").attr("d",x).attr("stroke-width",1).attr("fill",function(){return l[U]})}}for(var U=0;U<i.length;U++)if(S=X[U],L=q[U],m.append("linearGradient").attr("id","gradient1").attr("gradientUnits","userSpaceOnUse").attr("x1",S[0]).attr("y1",L[1]).attr("x2",S[2]).attr("y2",L[3]).selectAll("stop").data([{offset:"15%",color:l[U]},{offset:"62%",color:"#eaeaea"},{offset:"85%",color:l[U]}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),U!=i.length-1){m.selectAll(".path").data([S]).enter().append("path").attr("d",M).attr("stroke-width",0).attr("fill","url(#gradient1)")}m.append("rect").attr("x",n).attr("y",r).attr("width",a).attr("height",Y*w/2).attr("fill",l[U-1]),c(p)}},he={gaugeGraph:function(t){var e=t.data,n=t.colorArray,r=t.meterLabel,a=e[0].valAchieve,i=e[0].totalValue-e[0].valAchieve,o=[a,i],l=t.toolTipMsg,s={left:.002*g,right:.002*g,bottom:.002*v,top:.002*v},d=g-s.left-s.right,f=v-s.top-s.bottom,h=(Math.PI/180,p.append("g").attr("class","main-group").attr("transform","translate("+s.left+","+s.top+")")),y=h.append("g").attr("class","centerArcGroup").attr("transform","translate("+.5*d+","+.85*f+")"),x=h.append("g").attr("class","label").attr("transform","translate("+.5*d+","+.85*f+")"),b=.5*d>.75*f?.75*f:.5*d;b=b;var A=Math.PI,M=-90,w=90;start=-90;for(var C=d3.svg.arc().innerRadius(.5*b).outerRadius(b).startAngle(M*A/180).endAngle(w*A/180),T=(y.append("path").attr("d",C).attr("value",o[0]).attr("fill",function(){return n[1]}).on("mousemove",function(){U.hideTooTip();var t=l,e=d3.select(this).attr("value");U.showToolTip(d3.event,g,t,e,n[1])}).on("mouseleave",function(){U.hideTooTip()}),o[0]+o[1]),S=0,L=0;L<o.length-1;L++){var D=o[L]/T*(w-M);for(anglePartForTransition=D/10,console.log(start+" "+D),k=0;k<10;k++){var N=d3.svg.arc().innerRadius(.5*b).outerRadius(b).startAngle(start*A/180).endAngle((start+anglePartForTransition)*A/180),_=d3.svg.arc().innerRadius(.5*b).outerRadius(b).startAngle(start*A/180).endAngle(start*A/180),P=y.append("path").attr("d",_).attr("fill",function(){return n[0]}).attr("value",o[L]).attr("color",n[L]).on("mousemove",function(){U.hideTooTip();var t=l,e=d3.select(this).attr("value");U.showToolTip(d3.event,g,t,e,d3.select(this).attr("color"))}).on("mouseleave",function(){U.hideTooTip()});if(P.transition().duration(100).delay(S).ease("linear").attr("d",N),S+=100,9==k){var I=(D+-90-5)*A/180;if(0>D+-90){center=b-.5*(b-.4*b)+7*o[L].toString().length/2;var V=Math.sin(I)*center,F=-Math.cos(I)*center,z=y.append("g").attr("class","valGroup").attr("transform","translate("+V+","+F+") rotate("+(180*I/Math.PI+90)+")")}else{center=b-.5*(b-.4*b)-7*o[L].toString().length/2;var V=Math.sin(I)*center,F=-Math.cos(I)*center,z=y.append("g").attr("class","valGroup").attr("transform","translate("+V+","+F+") rotate("+(180*I/Math.PI-90)+")")}z.append("text").attr("x",0).attr("y",0).attr("fill",m["font-color"]).text(function(){return 0==L?o[L].toFixed(2):void 0})}start+=anglePartForTransition}x.append("text").attr("x",function(){return-(b-.5*(b-.5*b))-7*r[L].toString().length/2}).attr("y",20).text(r[L]).attr("font-size",14).attr("font-family","calibri").attr("fill",m.legendTextColor),x.append("text").attr("x",function(){return b-.5*(b-.5*b)-7*r[L].toString().length/2}).attr("y",20).text(r[L]).attr("font-size",14).attr("font-family","calibri").attr("fill",m.legendTextColor)}u(p),c(p)}},pe=!1,ge={areaChart:function(e){var e=t.extend({color:"url(#gradient123)",axisColor:"blue",data:[],attachBrushEvent:!1,xAxisIndicationLabel:"",yAxisIndicationLabel:"",xFieldName:"",yFieldName:""},e);data=e.data;var n=50;if(d3.select(".resetAreaBtn").empty()){var r=70,a=30,i=d3.select("#"+h).append("div").style("left",.8*g+"px").style("top",.1*v+"px").attr("class","resetAreaBtn").on("mouseover",function(){d3.select(".resetAreaBtn").style("background","#7F7FFF")}).on("mouseout",function(){d3.select(this).style("background","#19a586")}).style("width",r+"px").style("height",a+"px").style("background","#19a586").style("display","inline-block").style("z-index","999").style("position","absolute").style("line-height",a+"px").style("color","#FFFFFF").style("text-align","center").style("border-radius","3px").style("cursor","pointer");i.html("Reset")}if(d3.selectAll(".resetAreaBtn").on("click",function(){C.domain(d3.extent(L,function(t,e){return e})),pe=!0,t(f).find("svg g").empty(),t(f).find(".brushedArea").remove(),ge.areaChart({xFieldName:N,yFieldName:_,axisColor:"#222222",attachBrushEvent:!0,title:e.title,xAxisIndicationLabel:e.xAxisIndicationLabel,yAxisIndicationLabel:e.yAxisIndicationLabel,data:L}),Q.circleChart({color:"#fff953",r:3,data:L})}),!pe){N=e.xFieldName,_=e.yFieldName,L=data,D=e,g=t(f).width()-n,v=t(f).height()-n;{t(f).attr("id")}p=p,C=d3.scale.linear().range([0,g-I.scale]),M=d3.scale.linear().range([v-I.scale,0]);for(var o=[],l=0;l<data.length;l++)o.push(data[l].id);T=O.getMin(o),S=O.getMax(o),C.domain(d3.extent(data,function(t,e){return e})),M.domain([T,S]),A=d3.svg.axis().scale(C).orient("bottom"),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0),p=p.append("g").attr("transform","translate("+I.left+","+I.top+")").attr("class","grouping")}C.range([I.areaLeft,g-I.scale]),data=0==e.data.length?L:e.data;var s=t(f).attr("id"),d=s+"_area",y=d3.svg.area().x(function(t,e){return C(e)}).y0(v-I.scale).y1(function(t){return M(t[_])}),x=p.append("svg:defs").append("svg:linearGradient").attr("id","gradient123").attr("x1","0%").attr("y1",M(S/1.5)).attr("x2","0%").attr("y2",M(T)).attr("gradientUnits","userSpaceOnUse"),k="#5db6e0";x.append("stop").attr("offset","0%").attr("stop-color",k),x.append("stop").attr("offset","0.25").attr("stop-color","#82c8e8"),x.append("stop").attr("offset","0.5").attr("stop-color","#9ed4ec"),x.append("stop").attr("offset",".75").attr("stop-color","#c9e7f4"),x.append("stop").attr("offset","100%").attr("stop-color","#f0f8fc");for(var w,P,V=(p.append("path").datum(data).attr("class",d).attr("d",y).attr("fill",e.color).on("mousemove",function(){}).on("mouseleave",function(){try{}catch(t){}}),0),F=[],z=0;z<data.length;z++)F[z]=data[z][N],V<F[z].toString().length&&(V=F[z].toString().length);if(A.tickValues(X.getXTickArray(0,F.length,V,g-I.scale)),0==t(f).find(".axis").length){w=p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-I.scale+7)+")").attr("fill",e.axisColor).attr("fill","none").call(A),w.selectAll("text").text(function(t){return F[t]}).attr("fill","black"),b.orient("left"),P=p.append("g").attr("class","y axis").attr("transform","translate("+I.areaLeft+",3)").attr("fill",e.axisColor).attr("fill","none").call(b);var E=8,G=(g+n)/2-e.title.length*E/2,Y=p.append("g").attr("class","title");R.appendLabel(e.title,G,.06*v,0,Y,m.chartTitleColor,800);var E=6,B=e.xAxisIndicationLabel.toString().length*E,q=.13*v,U=g/2-B/2;R.appendLabel(e.xAxisIndicationLabel,U,q,0,w,m.xLabelColor,600);var j=e.xAxisIndicationLabel.toString().length*E,H=v/2+j/2,W=-I.areaLeft/1.3;R.appendLabel(e.yAxisIndicationLabel,W,H,-90,P,m.yLabelColor,600)}J.drawBrushing(function(n){pe=!0,C.domain(d3.extent(n,function(t,e){return e})),t(f).find("svg .grouping").empty(),t(f).find(".brushedArea").remove(),ge.areaChart({axisColor:"#222222",attachBrushEvent:!0,data:n,xAxisIndicationLabel:e.xAxisIndicationLabel,yAxisIndicationLabel:e.yAxisIndicationLabel,title:e.title}),Q.circleChart({color:"#frf953",r:3,data:n})}),u(p),c(p)}},ve={image:"",needle:"",plot:"",arc:"",prevdata:90,text:"",meterChartTest:function(){var t=p,e=g/3,n=e/2;ve.arc=d3.svg.arc().innerRadius(n).outerRadius(e).startAngle(120*(Math.PI/180)).endAngle(240*(Math.PI/180));var r=(t.append("g").attr("class","arc"),t.append("g").attr("transform","translate( "+(g/2-e)+" , "+v/4+")"));ve.image=r.append("svg:image").attr("x",0).attr("y",0).attr("width",2*e).attr("height",n).attr("xlink:href","gauge_skin.jpg").attr("id","fillImage"),ve.text=t.append("svg:text").attr("transform","translate( "+.5112*g+" , "+.878*v+")").attr("text-anchor","middle").text(""),console.log("height of meter: "+v),console.log("width of meter "+g);{var a=n/2;I.top+4}ve.needle=r.append("path").attr("class","tri").attr("d","M"+(a+2)+" 130 L"+a+" 0 L"+(a-3)+" 130 C"+(a-3)+" 140 "+(a+3)+" 140 "+(a+3)+" 130 Z").attr("transform","translate("+(e-n)+","+n+") rotate(-90) ")},turnNeedle:function(t){function e(){return d3.interpolateString("rotate("+n+", 150, 130)","rotate("+r+", 150, 130)")}0>t?ve.text.transition().attr("stroke","red").text(t):ve.text.transition().attr("stroke","green").text(t),ve.needle.transition().duration(1e3).attrTween("transform",e);var n=ve.getAngleFromCoordinate(ve.getCoordinateFromData(ve.prevdata)),r=ve.getAngleFromCoordinate(ve.getCoordinateFromData(ve.getPercentFromAngle(ve.getAngleForProfitAndLoss(t))))},getPercentFromAngle:function(t){return 0>t&&t>=-180?-(5*t/9):5*t/9},getAngleFromCoordinate:function(t){var e=0,n=90;return e+=n*t},getCoordinateFromData:function(t){return coordinate=t/100-(1-t/100),coordinate},getRadianFromData:function(t){return coordinate=t/57.2958,coordinate},callTurnNeedle:function(){var t=100*Math.random();meterChart.turnNeedle(t),meterChart.prevdata=t},getAngleForProfitAndLoss:function(t){var e;return e=t>0&&100>=t?90+.9*t:90+.9*t}},ye={drawThreeDStackedBarChart:function(e,n,r,a,i,o){function s(t,e,n,r,a){r=G(r),e=G(e);var i=[];for(l=0;l<3;l++)0==l?(x=t-.07*z,y=e-a+.03*g):1==l?(x=t-20,y=e-a):2==l&&(x=z,y=e-a),i.push(JSON.parse('{"x":'+x+',"y":'+y+"}"));return i}function d(t,e,n,r,a,i){r=G(0)-G(r);var o=[];if(1==a)for(var l=parseInt(.33*n)+1,s=0;5>s;s++){0==s?e=e:1==s?e-=r:2==s?t+=n:3==s?e+=r:4==s&&(t-=n);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(2==a)for(var l=parseInt(.33*n)+1,s=0;4>s;s++){0==s?e=e:1==s?(t-=l,e-=l):2==s?e-=r:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(3==a)for(var l=parseInt(.33*n)+1,s=0;4>s;s++){0==s?(re=e+r,e-=r):1==s?(t-=l,e-=l):2==s?t+=n:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}return o}var f={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:20,color:d3.scale.category20(),toolTipLabelForYAxis:"Profit(in Crores)",axisTextColor:"black",legendTextColor:"black"};if("undefined"!=typeof r)for(var b in r)"undefined"!=typeof r[b]&&(f[b]=r[b]);{var A=.9*g/(2*n[0].data.length),M=10,k=5;.3*g/n.length}M=.6*A;var w=g/(2*n[0].data.length);A=w;for(var C=w+M,T=[],S=0,L=[],D={},N=0;N<n.length;N++){var _=d3.max(n[N].data,function(t){return t});S+=_,T.push(_),L.push(n[N].key),D[n[N].key]="legend-"+N}var P=S,I=0,V=(B.leftMarginController(6*P.toString().length),1);for(N=0;N<(""+P).length-1;N++)V+="0";for(var F=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear"),z=n[0].data.length*C+A/2,E=d3.scale.linear().domain([0,n[0].data.length]).range([A/1.5,z]),G=d3.scale.linear().domain([0,1.55*P]).range([v-.15*v,0]),O=d3.svg.axis().scale(E).orient("bottom").tickFormat(U).tickSize(0),q=d3.svg.axis().scale(G).orient("left").tickSize(0),U=d3.format("1"),W=0,$=0;$<o.length;$++)W<o[$].toString().length&&(W=o[$].toString().length);O.tickValues(X.getXTickArray(0,o.length,W,z-A/1.5)),q.tickValues(d3.range(0,1.5*P,1.5*P/10));var J,Z=(P+100*(""+P).length,G(1.5*P));J=400>g?50:.02*z,p=p.append("g").attr("transform","translate("+J+",0)"),z+=.1*z;var K=g-.89*g,Q=v-.9*v,te=p.append("g").attr("transform","translate("+.04*g+",0)");for(j=0;j<10;j++){var ee=te.append("path").attr("d",F(s(K,Q,A,P,Z))).attr("class","horizontalGridLine").attr("stroke",m.gridLineColor).attr("stroke-width",.5).attr("fill","none"),ne=ee.node().getTotalLength();ee.attr("stroke-dasharray",ne+" "+ne).attr("stroke-dashoffset",ne).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",1).attr("stroke",m.gridLineColor).attr("stroke-width",.5).attr("fill","none"),Z+=G(0)-G(1.5*P/10)}for(var K=g-.89*g,Q=G(0),re=0,ae=n[0].data.length,ie=n.length,oe=0;ae>oe;oe++){for(var le=G(0),se=0,ue=0;ie>ue;ue++){{var ce=n[ue].data;te.append("path").attr("class","lineGraphClass "+D[n[ue].key]).attr("d",F(d(K+I,le,A,ce[oe],1,ce[oe],1))).attr("val",function(){var t=d(K+I,le,A,ce[oe],1,ce[oe],1);return t[0].height}).attr("stroke","grey").attr("fill",a[ue]).attr("xVal",n[ue].key).on("mousemove",function(){var t=[{headingName:f.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).style("display","none"),te.append("path").attr("class","lineGraphClass "+D[n[ue].key]).attr("d",F(d(K+I,le,A,ce[oe],2,ce[oe],1))).attr("val",function(){var t=d(K+I,le,A,ce[oe],2,ce[oe],1);return t[0].height}).attr("stroke","white").attr("fill",a[ue]).attr("stroke","grey").attr("xVal",n[ue].key).on("mousemove",function(){var t=[{headingName:f.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).style("display","none"),te.append("path").attr("class","lineGraphClass "+D[n[ue].key]).attr("d",F(d(K+I,le,A,ce[oe],3,ce[oe],1))).attr("val",function(){var t=d(K+I,le,A,ce[oe],3,ce[oe],1);return t[0].height}).attr("stroke","grey").attr("fill",a[ue]).attr("xVal",n[ue].key).on("mousemove",function(){var t=[{headingName:f.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).style("display","none")}se+=ce[oe],le=G(se)-k*(ue+1)}I+=C,le=G(0)}for(var de=t(".lineGraphClass").hide(),fe=0;fe<de.length;fe++)t(de[fe]).slideUp(100*fe).delay(40*fe).fadeIn();u(p);var he=te.append("g").attr("class","axis").attr("transform","translate("+K+","+(v-.15*v+G(1.5*P))+")").call(O);he.selectAll("text").text(function(t,e){return o[e]}).style("fill",i+" !important");var pe=p.append("g").attr("class","axis").attr("transform","translate("+.1*g+","+G(1.5*P)+")").call(q),ge=6,ve=(pe.attr("transform").indexOf("(")+1,pe.attr("transform").indexOf(","),f.yLabel.toString().length*ge),ye=v/2+ve/2,me=.04*-g;R.appendLabel(f.yLabel,me,ye,-90,te,m.yLabelColor,600);var xe=f.xLabel.toString().length*ge,be=z/2-xe,Ae=.1*v;R.appendLabel(f.xLabel,be,Ae,0,he,m.xLabelColor,600);var ge=8,Me=g/2-f.title.length*ge/2,ke=p.append("g").attr("class","title");R.appendLabel(f.title,Me,.05*v,0,ke,m.chartTitleColor,800);var we=te.append("g").attr("class","legend").attr("width",g).attr("height",v).attr("transform","translate("+K+","+.08*v+")"),Ce=0,Te=0;g>300?(Ce=12,Te=12):(Ce=10,Te=10);var Se=(d3.max(n,function(t){return t.key.length}),Y.getLegendPositionArray(L,g,.25*P));we.selectAll("rect").data(L).enter().append("rect").attr("x",function(t,e){return Se[e].x}).attr("y",function(t,e){return Se[e].y}).attr("width",Ce).attr("height",Te).style("fill",function(t,e){return a[e]}).on("click",function(e){var n=p.selectAll("."+D[e]).style("display");if("none"==n)t("#"+h).find("path."+D[e]).slideUp(400).delay(400).fadeIn(),p.selectAll(".legend-text."+D[e]).style("text-decoration","none");else{{p.selectAll("."+D[e])}t("#"+h).find("path."+D[e]).slideDown(400).delay(400).fadeOut(),p.selectAll(".legend-text."+D[e]).style("text-decoration","line-through")}}),we.selectAll("text").data(L).enter().append("text").attr("class",function(t){return"legend-text "+D[t]}).attr("x",function(t,e){return Se[e].textPos}).attr("y",function(t,e){return Se[e].y+Te}).attr("width",Ce).attr("height",Te).attr("font-size",12).attr("dy",".08em").text(function(t){return t}),c(p)}},me={globChartAnalysis:function(t){var e=t.data.nodesArray,n=t.data.cordArray,r=t.data.nodesColor,a=t.data.Data,i=(t.data.titleColor,t.data.titleSize,t.data.title),o=t.data.backGroundImage,l=12,s="gray",u=4,d="calibri";p.style("background","url("+o+") no-repeat").style("background-size","100% 100%");for(var f=p.append("g").attr("class","glob-main-group").attr("transform","translate(0,0)"),h=[],y=[],x=0,b=0;b<n.length;b++)for(var A=0;2>A;A++)0==A?h[x]=n[b][A]:y[x++]=n[b][A];var M=8,k=g/2-i.length*M/2,w=p.append("g").attr("class","title");R.appendLabel(i,k,.06*v,0,w,m.chartTitleColor,800);var C=d3.scale.linear().domain([0,100]).range([v,0]),T=d3.svg.axis().scale(C).orient("left"),S=(f.append("g").attr("class","y-axis").attr("transform","translate(30,10)").attr("fill","none").style("display","none").call(T),d3.scale.linear().domain([0,100]).range([0,g-20])),L=d3.svg.axis().scale(S).orient("bottom"),D=(f.append("g").attr("class","x-axis").attr("transform","translate(10,"+(v-30)+")").attr("fill","none").style("display","none").call(L),f.append("g").attr("class","show-nodes").attr("transform","translate(0,0)"));D.selectAll("circle").data(e).enter().append("circle").attr("value",function(t,e){return e}).attr("cx",function(t,e){return S(h[e])}).attr("cy",function(t,e){return C(y[e])}).attr("r",u).attr("fill",function(t,e){return r[e]}).on("mouseover",function(){d3.select(this).attr("r",u+3);var t=d3.select(this).attr("value"),n=e[t];d3.select("#"+n.replace(/ /g,"")).attr("font-size",l+2).attr("fill","black"),d3.selectAll("."+n.replace(/ /g,"")).style("display","none");for(var r,i=0;i<a.length;i++)if(n==a[i].node){r=i;break}for(var o=0;o<a[r].connectedNodes.length;o++){var s=a[r].connectedNodes[o],c=e.indexOf(s);d3.select("#"+s.replace(/ /g,"")).attr("font-size",l+2).attr("fill","black"),d3.select("#"+(n+s).replace(/ /g,"")).attr("font-size",l+1).attr("fill","black");var d=f.append("line").attr("class","dotedLine").attr("x1",function(){return S(h[t])}).attr("y1",function(){return C(y[t])}).attr("x2",function(){return S(h[t])}).attr("y2",function(){return C(y[t])});d.transition().duration(1500).attr("x2",function(){return S(h[c])}).attr("y2",function(){return C(y[c])}).style("stroke","red").style("stroke-dasharray","5, 5")}}).on("mouseout",function(){d3.select(this).attr("r",u);var t=d3.select(this).attr("value"),n=e[t];d3.selectAll("."+n.replace(/ /g,"")).style("display","block"),d3.selectAll(".dotedLine").style("display","none"),d3.select("#"+n.replace(/ /g,"")).attr("font-size",l).attr("fill",s);for(var r,i=0;i<a.length;i++)if(n==a[i].node){r=i;break}for(var o=0;o<a[r].connectedNodes.length;o++){var c=a[r].connectedNodes[o];d3.select("#"+c.replace(/ /g,"")).attr("font-size",l).attr("fill",s),d3.select("#"+(n+c).replace(/ /g,"")).attr("font-size",l-1).attr("fill",s)}});var N=f.append("g").attr("class","show-nodes-text").attr("transform","translate(0,0)");N.selectAll("text").data(e).enter().append("text").attr("id",function(t){return t.replace(/ /g,"")}).attr("x",function(t,e){return S(h[e])-t.length*l/2.5}).attr("y",function(t,e){return C(y[e])-8}).attr("font-size",l).attr("font-family",d).attr("fill",s).text(function(t){return t});for(var _=0;_<a.length;_++)for(var P=a[_].node,I=e.indexOf(P),V=0;V<a[_].connectedNodes.length;V++){var F=a[_].connectedNodes[V],z=e.indexOf(F),E=Math.abs(S(h[z])-S(h[I])),G=Math.abs(C(y[z])-C(y[I])),Y=Math.atan2(G,E),O=Y*(180/Math.PI);f.append("text").attr("id",(P+F).replace(/ /g,"")).attr("transform","translate("+(S(h[z])+S(h[I]))/2+","+(C(y[z])+C(y[I]))/2+")rotate("+O+")").attr("font-size",l-1).attr("font-family",d).attr("fill",s).text(a[_].pathTexts[V]);var B=f.append("line").attr("class",P.replace(/ /g,"")).attr("x1",function(){return S(h[I])}).attr("y1",function(){return C(y[I])}).attr("x2",function(){return S(h[I])}).attr("y2",function(){return C(y[I])});B.transition().delay(200).duration(1500).attr("x2",function(){return S(h[z])}).attr("y2",function(){return C(y[z])}).style("stroke",function(){return a[_].pathColor})}c(p)}},xe={treeChart:function(t){function e(t){var n=0;return t.SubRoot&&t.SubRoot.forEach(function(t){var r=e(t);r>n&&(n=r)}),1+n}function n(t){var n=f.nodes(s).reverse(),a=f.links(n);n.forEach(function(t){t.y=t.depth*((g-20)/e(s))});var l=y.selectAll("g.node").data(n,function(t){return t.ids||(t.ids=++u)}),c=l.enter().append("g").attr("class","node legend").attr("transform",function(){return"translate("+t.y0+","+t.x0+")"}).on("click",r);c.append("circle").attr("r",1e-6).style("fill",function(){return o}).style("stroke","lightsteelblue").on("mouseover",function(){d3.select(this).style("stroke-width","2")}).on("mouseleave",function(){d3.select(this).style("stroke-width","1")}),c.append("text").attr("x",function(t){return t._children1||t._children1?-10:10}).attr("dy",".35em").attr("text-anchor",function(t){return t._children1||t._children1?"end":"start"}).text(function(t){return t.Element||t.Element||t.Root}).style("fill-opacity",1e-6);var p=l.transition().duration(d).attr("transform",function(t){return"translate("+t.y+","+t.x+")"});p.select("circle").attr("r",4.5).style("fill",function(){return o}).style("stroke","lightsteelblue"),p.select("text").style("fill-opacity",1);var v=l.exit().transition().duration(d).attr("transform",function(){return"translate("+t.y+","+t.x+")"}).remove();v.select("circle").attr("r",1e-6),v.select("text").style("fill-opacity",1e-6);var m=y.selectAll("path.link").data(a,function(t){return t.target.ids});m.enter().insert("path","g").attr("class","link").attr("d",function(){var e={x:t.x0,y:t.y0};return h({source:e,target:e})}).style("stroke",i).style("fill","none"),m.transition().duration(d).attr("d",h),m.exit().transition().duration(d).attr("d",function(){var e={x:t.x,y:t.y};return h({source:e,target:e})}).remove(),n.forEach(function(t){t.x0=t.x,t.y0=t.y})}function r(t){t.SubRoot?(t._children1=t.SubRoot,t.SubRoot=null):(t.SubRoot=t._children1,t._children1=null),n(t),c(p)}var a=t.data,i=t["link-color"],o=t["node-color"],l={top:.1*v,right:.1*g,bottom:.1*v,left:.1*g};g=g-l.right-l.left,v=v-l.top-l.bottom;var s,u=0,d=750,f=d3.layout.tree().size([v,g]).children(function(t){return t.SubRoot}),h=d3.svg.diagonal().projection(function(t){return[t.y,t.x]}),y=p.append("g").attr("transform","translate("+l.left+","+l.top+")");s=a,s.x0=v/2,s.y0=0,n(s);console.log("Get of depth : "+e(s)),c(p)}},be={areaChartWithNegativeValueAnalysis:function(e){for(var n=e.data.title,r=e.data.yAxisArray,a=e.data.xAxisArray,i=e.data.xAxisLabel,o=e.data.yAxisLabel,l=e.data.midPoint,s=e.data.midPointLabel,d=e.data.conditionArrayAboveMidPoint,h=e.data.conditionArrayBelowMidPoint,y=s.split(" "),x=0,b=0;b<y.length;b++)x<y[b].toString().length&&(x=y[b].toString().length);x=7*x;for(var A=B.leftMarginController(r),M={left:A,right:x,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},k=g-M.left-M.right,w=v-M.top-M.bottom,C=12,T="calibri",S=[],L=0;L<a.length;L++)S[L]=L;W.init(p,w,k,M.left,M.top,m.gridLineColor);var D=t(f).offset().left,N=p.append("g").attr("class","main-group").attr("transform","translate("+M.left+","+M.top+")"),_=7,P=g/2-n.length*_/2,I=p.append("g").attr("class","title");R.appendLabel(n,P,M.top/2,0,I,m.chartTitleColor,800);for(var V=d3.scale.linear().domain([0,a.length-1]).range([0,k]),F=O.getMin(r),z=O.getMax(r),E=d3.scale.linear().domain([F,z]).range([w,0]),G=0,L=0;L<a.length;L++)G<a[L].toString().length&&(G=a[L].toString().length);var Y=d3.svg.axis().scale(V).orient("bottom").tickValues(X.getXTickArray(0,a.length,G,k)),q=N.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+w+")").call(Y);q.selectAll("text").text(function(t){return a[t]}).style("font-size",C).attr("font-family",T).attr("fill","black");var _=6,U=i.toString().length*_,j=w+(M.bottom-5),$=k/2-U/2;R.appendLabel(i,$,j,0,N,m.xLabelColor,600);var J=d3.svg.axis().scale(E).orient("left").tickValues(X.getTickArray(F,z,10));N.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("font-size",C).attr("font-family",T).attr("transform","translate(0,0)").call(J).selectAll("text").attr("font-size",C).attr("font-family",T).attr("fill","black");var Z=o.toString().length*_,K=w/2+Z/2,Q=-M.left+15;R.appendLabel(o,Q,K,-90,N,m.yLabelColor,600);var y=s.split(" ");y.push(l);for(var te=parseInt(y.length/2),b=0;b<y.length;b++)R.appendLabel(y[b],k+2,E(l)-te*C+b*C,0,N,m.yLabelColor,600);var ee=t.extend({color:"url(#gradientAboveMid)"},ee),ne=[],re=[];for(b in d)for(key in d[b])ne.push(key),re.push(d[b][key]);var ae=(N.append("svg:defs").append("svg:linearGradient").attr("id","gradientAboveMid").attr("x1","0%").attr("y1",E(l)).attr("x2","0%").attr("y2",E(z)).attr("gradientUnits","userSpaceOnUse").selectAll("stop").data(ne).enter().append("stop").attr("offset",function(t){return""+(t-l)/z*100+"%"}).attr("stop-color",function(t,e){return re[e]}),t.extend({color:"url(#gradientBelowMid)"},ae)),ie=[],oe=[];for(b in h)for(key in h[b])ie.push(key),oe.push(h[b][key]);for(var le=(N.append("svg:defs").append("svg:linearGradient").attr("id","gradientBelowMid").attr("x1","0%").attr("y1",E(F)).attr("x2","0%").attr("y2",E(l)).attr("gradientUnits","userSpaceOnUse").attr("gradientUnits","userSpaceOnUse").selectAll("stop").data(ie).enter().append("stop").attr("offset",function(t){return""+(l-t)/(l-F)*100+"%"}).attr("stop-color",function(t,e){return oe[oe.length-1-e]}),[]),se=0,ue=1,ce=-1,de=-1,b=0;b<r.length;b++){if(le=[],r[b]>=l){ue=1,le.push(l);for(var fe=b;fe<r.length;fe++){if(r[fe]<l){le.push(l);break}le.push(r[fe])}2==le.length&&b==r.length-1&&(le=[],le.push(l),le.push(r[r.length-1]),le.push(l))}else{ue=0,le.push(l);for(var fe=b;fe<r.length;fe++){if(r[fe]>=l){le.push(l);break}le.push(r[fe])}2==le.length&&b==r.length-1&&(le=[],le.push(l),le.push(r[r.length-1]))}ce=b,0==ce&&le.splice(0,1),fe==r.length&&(de=0),b=fe-1;var he=d3.svg.area().x(function(){return 0}).y0(E(l)).y1(function(t,e){return E(le[e])}).interpolate("cardinal"),pe=N.append("path").datum(le).attr("class","spyCloseprice").attr("d",he(le)).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=D+M.left,t=Math.round(V.invert(t));var e=a[t],n=r[t],l=i+" "+e,s=[{headingName:o,headingVal:n}];H.showToolTip(d3.event,"",l,!1,s,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}),ge=d3.svg.area().x(function(t,e){return 0==ce?(ce=1,V(se++)):0==de&&e==le.length-1?(de=1,V(se)):V(0==e?se-.5:e==le.length-1?se-.5:S[se++])}).y0(E(l)).y1(function(t,e){return E(le[e])}).interpolate("cardinal");pe.transition().duration(2e3).attr("d",ge(le)).attr("fill",function(){return 1==ue?ee.color:ae.color})}var ve=N.selectAll("circle").data(S).enter().append("circle").attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("r",4).attr("fill",function(t,e){return r[e]>l?re[re.length-1]:oe[oe.length-1]});ve.transition().duration(2e3).attr("cx",function(t,e){return V(S[e])}).attr("cy",function(t,e){return E(r[e])}),u(p),c(p)}},Ae={areaChartWithVaryColorAnalysis:function(e){for(var n=e.data.title,r=e.data.yAxisArray,a=e.data.xAxisArray,i=e.data.xAxisLabel,o=e.data.yAxisLabel,l=e.data.midPoint,s=e.data.midPointLabel,d=s.split(" "),h=0,y=0;y<d.length;y++)h<d[y].toString().length&&(h=d[y].toString().length);h=7*h;for(var x=B.leftMarginController(r),b={left:x,right:h,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},A=g-b.left-b.right,M=v-b.top-b.bottom,k=14,w="calibri",C=[],T=0;T<a.length;T++)C[T]=T;W.init(p,M,A,b.left,b.top,m.gridLineColor);var S=t(f).offset().left,L=p.append("g").attr("class","main-group").attr("transform","translate("+b.left+","+b.top+")"),D=7,N=g/2-n.length*D/2,_=p.append("g").attr("class","title");R.appendLabel(n,N,b.top/2,0,_,m.chartTitleColor,800);for(var P=d3.scale.linear().domain([0,a.length-1]).range([0,A]),I=O.getMin(r),V=O.getMax(r),F=d3.scale.linear().domain([I,V]).range([M,0]),z=0,T=0;T<a.length;T++)z<a[T].toString().length&&(z=a[T].toString().length);var E=d3.svg.axis().scale(P).orient("bottom").tickValues(X.getXTickArray(0,a.length,z,A)),G=L.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+M+")").call(E);
G.selectAll("text").text(function(t){return a[t]}).style("font-size",k).attr("font-family",w);var D=6,Y=i.toString().length*D,q=M+(b.bottom-5),U=A/2-Y/2;R.appendLabel(i,U,q,0,L,m.xLabelColor,600);var j=d3.svg.axis().scale(F).orient("left").tickValues(X.getTickArray(I,V,10));L.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("font-size",12).attr("transform","translate(0,0)").call(j).selectAll("text").attr("font-size",k).attr("font-family",w);var $=(o.toString().length*D,-b.left+15);R.appendLabel(o,$,M/1.5,-90,L,m.yLabelColor,600);var d=s.split(" ");d.push(l);for(var J=parseInt(d.length/2),y=0;y<d.length;y++)R.appendLabel(d[y],A+2,F(l)-J*k+y*k,0,L,m.yLabelColor,600);for(var Z=[],K=-.5,Q=0,y=0;y<r.length;){Z=[],0==Q?(Q=1,Z.push(r[y]),y+1<r.length&&Z.push((r[y+1]+r[y])/2)):(Q=0,y+1<r.length&&Z.push((r[y+1]+r[y])/2),Z.push(r[y+1]),y++),y=y,K+=.5;var te=d3.svg.area().x(function(t,e){return P(0==e?K:K+.5)}).y0(F(l)).y1(function(t,e){return F(Z[e])});L.append("path").datum(Z).attr("class","spyCloseprice").attr("fill",function(){return 0==Q?"#1abc9c":"#d7dcde"}).attr("d",te(Z)).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=S+b.left,t=Math.round(P.invert(t));var e=a[t],n=r[t],l=i+" "+e,s=[{headingName:o,headingVal:n}];H.showToolTip(d3.event,"",l,!1,s,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()})}var ee=L.selectAll("circle").data(C).enter().append("circle").attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("r",4).attr("fill","#47A3FF");ee.transition().duration(2e3).attr("cx",function(t,e){return P(C[e])}).attr("cy",function(t,e){return F(r[e])}),u(p),c(p)}},Me={comparisonAnalysis:function(e){for(var n=e.data.yAxisEstimateData,r=e.data.yAxisActualData,a=e.data.xAxisData,i=e.data.yAxisUnit,o=e.data.yAxisLabel,l=e.data.xAxisLabel,s=e.data.title,d=(e.data.titleColor,e.data.yAxisEstimateDataUnit),h=e.data.yAxisActualDataUnit,y=B.leftMarginController(n),x={left:y,right:.05*g,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},b=g-x.left-x.right,A=v-x.top-x.bottom,M=b/(1.5*a.length),k=12,w="calibri",C=[],T=0;T<a.length;T++)C[T]=T;W.init(p,A,b,x.left-M/2,x.top,m.gridLineColor);var S=t(f).offset().left,L=p.append("g").attr("class","main-group").attr("transform","translate("+x.left+","+x.top+")"),D=7,N=g/2-s.length*D/2,_=p.append("g").attr("class","title");R.appendLabel(s,N,x.top/2,0,_,m.chartTitleColor,800);var P,I=d3.scale.linear().domain([0,a.length-1]).range([.5*M,b-.5*M]);P=d3.min(n)<d3.min(r)?n:r;var V=O.getMin(P);P=d3.max(n)>d3.max(r)?n:r;for(var F=O.getMax(P),z=d3.scale.linear().domain([V,F]).range([A,0]),E=0,T=0;T<a.length;T++)E<a[T].toString().length&&(E=a[T].toString().length);var G=d3.svg.axis().scale(I).orient("bottom").tickValues(X.getXTickArray(0,a.length,E,b)),Y=L.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+A+")").call(G);Y.selectAll("text").text(function(t){return a[t]}).style("font-size",k).attr("font-family",w).attr("fill","black");var D=6,q=l.toString().length*D,U=A+(x.bottom-5),j=b/2-q/2;R.appendLabel(l,j,U,0,L,m.xLabelColor,600);var $=d3.svg.axis().scale(z).orient("left").tickValues(X.getTickArray(V,F,8));L.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call($).selectAll("text").style("font-size",k).style("font-family",w).attr("fill","black");var J=o.toString().length*D,Z=A/2+J/2,K=-x.left+15;R.appendLabel(o,K,Z,-90,L,m.yLabelColor,600);var Q=L.selectAll(".rect").data(n).enter().append("rect").attr("width",M).attr("height",0).attr("x",function(t,e){return I(e)-M/2}).attr("y",A).attr("fill","#000000").attr("opacity",.2).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=S+x.left,t=Math.round(I.invert(t));var e=a[t],l=n[t]+" "+i,s=r[t]+" "+i,u=[{headingName:d+" "+o,headingVal:l},{headingName:h+" "+o,headingVal:s}];H.showToolTip(d3.event,"",e,!1,u,.9*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});Q.transition().duration(1500).attr("height",function(t){return z(V)-z(t)}).attr("y",function(t){return z(t)});var te=L.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");te.append("svg:stop").attr("offset","0%").attr("stop-color","#bfefee").attr("stop-opacity",1),te.append("svg:stop").attr("offset","50%").attr("stop-color","#79d1cf").attr("stop-opacity",1),te.append("svg:stop").attr("offset","100%").attr("stop-color","#bfefee").attr("stop-opacity",1);var ee=b/(3*a.length),ne=L.selectAll(".rect").data(r).enter().append("rect").attr("width",ee).attr("height",0).attr("x",function(t,e){return I(e)-ee/2}).attr("y",A).attr("fill","url(#gradient)").on("mouseover",function(){d3.select(this).attr("fill","#3e9ad9")}).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=S+x.left,t=Math.round(I.invert(t));var e=a[t],l=n[t]+" "+i,s=r[t]+" "+i,u=[{headingName:d+" "+o,headingVal:l},{headingName:h+" "+o,headingVal:s}];H.showToolTip(d3.event,"",e,!1,u,.9*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip(),d3.select(this).attr("fill","url(#gradient)")});ne.transition().duration(1500).attr("height",function(t){return z(V)-z(t)}).attr("y",function(t){return z(t)}),u(p),c(p)}},ke={musicSpikesAnalysis:function(e){for(var n=e.data.title,r=(e.data.titleColor,e.data.yAxisData),a=e.data.xAxisData,i=e.data.yAxisLabel,o=e.data.xAxisLabel,l=e.data.yAxisUnit,s=B.leftMarginController(r),d={left:s,right:.05*g,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},h=g-d.left-d.right,y=v-d.top-d.bottom,x=h/(2*r.length),b=12,A="calibri",M=[],k=0;k<a.length;k++)M[k]=k;var w=t(f).offset().left,C=p.append("g").attr("class","main-group").attr("transform","translate("+d.left+","+d.top+")").on("mouseover",function(){{var t=d3.event.pageX;d3.event.pageY}if(t-=w+d.left,t=Math.round(D.invert(t)),t>=0&&t<a.length){var e=a[t],n=r[t]+" "+l,o=[{headingName:i,headingVal:n}];H.showToolTip(d3.event,"",e,!1,o,.9*d3.event.pageY)}}).on("mouseleave",function(){H.hideTooTip()}),T=8,S=g/2-n.length*T/2,L=p.append("g").attr("class","title");R.appendLabel(n,S,d.top/2,0,L,m.chartTitleColor,800);for(var D=d3.scale.linear().domain([0,a.length-1]).range([.5*x,h-.5*x]),N=O.getMin(r),_=O.getMax(r),P=d3.scale.linear().domain([N,_]).range([y,0]),I=0,k=0;k<a.length;k++)I<a[k].toString().length&&(I=a[k].toString().length);var V=d3.svg.axis().scale(D).orient("bottom").tickValues(X.getXTickArray(0,a.length,I,h)),F=C.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+y+")").call(V);F.selectAll("text").text(function(t){return a[t]}).style("font-size",b).attr("font-family",A).attr("fill","black");var T=6,z=o.toString().length*T,E=y+(d.bottom-5),G=h/2-z/2;R.appendLabel(o,G,E,0,C,m.xLabelColor,600);var Y=d3.svg.axis().scale(P).orient("left").tickValues(X.getTickArray(N,_,10));C.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(Y).selectAll("text").style("font-size",b).style("font-family",A).attr("fill","black");var q=i.toString().length*T,U=y/2+q/2,j=-d.left+15;R.appendLabel(i,j,U,-90,C,m.yLabelColor,600);for(var x=h/(2*r.length),W=[],$=0;$<r.length;$++){var J=P(.5*d3.min(r))-P(r[$]);J=Math.round(J/7);for(var Z=0;J>Z;Z++)W.push(0==Z?"newRectangle":"oldRectangle")}var K=-1,Q=-1,te=0,ee=-1,ne=0,re=C.selectAll("rect").data(W).enter().append("rect").attr("x",function(t){return"newRectangle"==t&&K++,D(K)-x/2}).attr("y",function(){return y}).attr("width",x).attr("height",function(){return 4}).attr("fill",function(t){"newRectangle"==t&&(ne=0,ee++);var e=P.invert(P(r[ee])+7*ne++);return e<.33*d3.max(r)?"#1fb5ad":e<.66*d3.max(r)?"#5cb85c":"#ff7878"});re.transition().duration(1e3).attr("y",function(t){return"newRectangle"==t&&(te=0,Q++),P(r[Q])+7*te++}),u(p),c(p)}},we={drawThreeDGroupedBarChart:function(e,n,r,a){function i(t,e,n,r,a,i){r=z(0)-z(r);var o=[];if(1==a)for(var l=parseInt(.33*n)+1,s=0;5>s;s++){0==s?e=z(0):1==s?e-=r:2==s?t+=n:3==s?e+=r:4==s&&(t-=n);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(2==a){var l=parseInt(.33*n)+1;e=z(e);for(var s=0;4>s;s++){0==s?e=z(0):1==s?(t-=l,e-=l):2==s?e-=r:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}}else if(3==a)for(var l=parseInt(.33*n)+1,s=0;4>s;s++){0==s?e=z(0)-r:1==s?(t-=l,e-=l):2==s?t+=n:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}return o}function o(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}var l={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,colorArray:[],toolTipLabelForYAxis:"Profit(in Crores)"};if("undefined"!=typeof a)for(var s in a)"undefined"!=typeof a[s]&&(l[s]=a[s]);var u,d=a.lagendArray,f=d3.max(n)>d3.max(r)?n:r,h=d3.min(n)<d3.min(r)?n:r,y=B.leftMarginController(f),u={top:.1*v,right:.05*g,bottom:45,left:y},x=a.xAxisTickArray,b=g-u.left-u.right,A=v-u.top-u.bottom,M=.9*g/(2*n.length),w=.9*g/(1.5*(n.length+r.length)),C=d3.max(n,function(t){return t}),T=d3.max(r,function(t){return t}),S=C>T?C:T,L=O.getMin(h),D=O.getMax(f),N=w,_=1;for(k=0;k<(""+S).length-1;k++)_+="0";{var P=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear"),I=(n.length+r.length)*w+M*r.length,V=g-.9*g,F=d3.scale.linear().domain([0,n.length-1]).range([1.5*w,b-.5*w]),z=d3.scale.linear().domain([L,D]).range([A,0]),E=d3.svg.axis().scale(F).orient("bottom"),G=X.getTickArray(L,D,8),q=d3.svg.axis().scale(z).orient("left").tickValues(G);S+100*(""+S).length,z(D)}p=p.append("g").attr("transform","translate("+u.left+","+u.top+")"),I+=.15*I;for(var U,j=z(D),W=p,$=[],J=[],Z=d3.svg.line().x(function(t){return t}).y(function(t,e){return J[e]}),s=0;s<G.length-1;s++){$[0]=0,J[0]=z(G[s]),$[1]=20,J[1]=z(G[s])-20,$[2]=b,J[2]=J[1],U=p.selectAll(".path").data([$]).enter().append("path").attr("class","groupedBarChartGrid").attr("d",Z).attr("fill","none").attr("stroke",m.gridLineColor);var K=U.node().getTotalLength();U.attr("stroke-dasharray",function(){return K+","+K}).attr("stroke-dashoffset",K).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var j=v-.9*v,Q=(a.colorArray,0);Q<n.length;Q++){W.append("path").attr("class","threeDGroupedBarChart "+Q).attr("d",P(i(F(Q),j,w,r[Q],1,r[Q]))).attr("val",function(){var t=i(F(Q),j,w,r[Q],1,r[Q]);return t[0].height}).attr("xVal",x[Q]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).attr("fill",function(){return o(l.barColorArray[0],.1)}),W.append("path").attr("class","threeDGroupedBarChart "+Q).attr("d",P(i(F(Q),j,w,r[Q],2,r[Q]))).attr("val",function(){var t=i(F(Q),j,w,r[Q],2,r[Q]);return t[0].height}).attr("xVal",x[Q]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).attr("fill",function(){return o(l.barColorArray[0],-.2)}),W.append("path").attr("class","threeDGroupedBarChart "+Q).attr("d",P(i(F(Q),j,w,r[Q],3,r[Q]))).attr("val",function(){var t=i(F(Q),j,w,r[Q],3,r[Q]);return t[0].height}).attr("xVal",x[Q]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).attr("fill",function(){return o(l.barColorArray[0],-.4)}),W.append("path").attr("class","threeDGroupedBarChart "+Q).attr("d",P(i(F(Q)-w,j,w,n[Q],1,n[Q]))).attr("val",function(){var t=i(F(Q)-w,j,w,n[Q],1,n[Q]);return t[0].height}).attr("xVal",x[Q]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).attr("fill",function(){return o(l.barColorArray[1],.1)}),W.append("path").attr("class","threeDGroupedBarChart "+Q).attr("d",P(i(F(Q)-w,j,w,n[Q],2,n[Q]))).attr("val",function(){var t=i(F(Q)-w,j,w,n[Q],2,n[Q]);return t[0].height}).attr("xVal",x[Q]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).attr("fill",function(){return o(l.barColorArray[1],-.2)}),W.append("path").attr("class","threeDGroupedBarChart "+Q).attr("d",P(i(F(Q)-w,j,w,n[Q],3,n[Q]))).attr("val",function(){var t=i(F(Q)-w,j,w,n[Q],3,n[Q]);return t[0].height}).attr("xVal",x[Q]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];H.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);H.hideTooTip()}).attr("fill",function(){return o(l.barColorArray[1],-.4)})}for(var te=t(".threeDGroupedBarChart").hide(),ee=0;ee<te.length;ee++)t(te[ee]).slideUp(300*ee).delay(100*ee).fadeIn();for(var ne=0,re=0;re<x.length;re++)ne<x[re].toString().length&&(ne=x[re].toString().length);E.tickValues(X.getXTickArray(0,x.length,ne+1,g-(V+N)));var ae=W.append("g").attr("class","axis").attr("fill","none").attr("transform","translate(0,"+A+")").call(E);ae.selectAll("text").text(function(t){return x[t]});var ie=p.append("g").attr("class","axis").attr("transform","translate(0,0)").call(q);ie.selectAll("line").style("display","none"),ie.selectAll("path").style("display","none");var oe=(ie.attr("transform").indexOf("(")+1,ie.attr("transform").indexOf(","),6),le=l.yLabel.toString().length*oe,se=A/2+le/2,ue=-u.left+15;R.appendLabel(l.yLabel,ue,se,-90,p,m.yLabelColor,600);var ce=l.xLabel.toString().length*oe,de=A+(u.bottom-5),fe=b/2-ce/2;R.appendLabel(l.xLabel,fe,de,0,p,m.xLabelColor,600);var oe=8,he=b/2-l.title.length*oe/2,pe=p.append("g").attr("class","title");R.appendLabel(l.title,he,.7*-u.top,0,pe,m.chartTitleColor,800);{var ge=1,ve=10,ye=10,me=Y.showHorizontalLegend(b,.3*-u.top,d,ve,ye),xe=p.append("g").attr("class","legendGroup");xe.selectAll(".rect").data(me).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("width",ve).attr("height",ye).attr("x",function(t,e){return me[e].x}).attr("y",function(t,e){return me[e].y}).attr("fill",function(){return l.barColorArray[ge--]}),xe.selectAll(".text").data(me).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return me[e].textXPos}).attr("y",function(t,e){return me[e].y}).text(function(t,e){return d[e]}).attr("dy",".7em").attr("fill",m.legendTextColor)}c(p)}},Ce={barWithLabelAnalysis:function(e){var n=e.yAxisData,r=e.xAxisData,a=e.colorArray,i=e.averageValue,o=e.unit,l=e.title;yAxisDataUnit=e.yAxisDataUnit;{var s=B.leftMarginController(n),d={left:s,right:.05*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},h=g-d.left-d.right,y=v-d.top-d.bottom,x=10,b=t(f).offset().left;t(f).offset().top}W.init(p,y,h,d.left,d.top,m.gridLineColor);for(var A=h/(2*r.length),M=[],k=0;k<r.length;k++)M[k]=k;var w=p.append("g").attr("class","barMainGroup").attr("transform","translate("+d.left+","+d.top+")"),C=7,T=g/2-l.length*C/2,S=p.append("g").attr("class","title");R.appendLabel(l,T,d.top/2,0,S,m.chartTitleColor,800);var L=d3.scale.linear().domain([0,r.length-1]).range([.5*A,h-.5*A]),D=O.getMin(n),N=O.getMax(n),_=d3.scale.linear().domain([D,N]).range([y,0]),P=d3.svg.axis().scale(_).orient("left"),I=(w.append("g").attr("class","y axis").attr("transform","translate(-15,0)").attr("fill","none").call(P).selectAll("text").attr("fill","black"),w.selectAll(".rect").data(n).enter().append("rect").attr("width",A).attr("height",0).attr("x",function(t,e){return L(e)-A/2}).attr("y",_(i)).attr("fill",function(t,e){return a[e]}).on("mousemove",function(t){{var e=d3.event.pageX;d3.event.pageY}e-=b+d.left,e=Math.round(L.invert(e));var n;n=t>i?"+"+t+" "+o:t+" "+o;var a=r[e],l=[{headingName:yAxisDataUnit,headingVal:n}];H.showToolTip(d3.event,"",a,!1,l,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}));I.transition().duration(1500).attr("height",function(t){return t>i?_(i)-_(t):_(t)-_(i)}).attr("y",function(t){return _(t>i?t:i)});{var V=(w.selectAll(".text").data(n).enter().append("text").attr("x",function(t,e){var n="+"+t+" "+o,r=7*n.length;return L(e)-r/2}).attr("y",function(t){return t>i?_(t)-5:_(t)+15}).attr("fill","white").text(function(t){return t>i?"+"+t+" "+o:t+" "+o}),p.append("g").attr("class","legend").attr("transform","translate("+d.left+","+d.top+")")),F=y+.02*y,z=Y.showHorizontalLegend(h,F,r,x,x);V.selectAll(".rect").data(z).enter().append("rect").attr("width",x).attr("height",x).attr("x",function(t,e){return z[e].x}).attr("y",function(t,e){return z[e].y}).attr("fill",function(t,e){return a[e]}),V.selectAll(".text").data(z).enter().append("text").attr("x",function(t,e){return z[e].textXPos}).attr("y",function(t,e){return z[e].y+x}).attr("font-family","calibri").text(function(t,e){return r[e]})}c(p),u()}},Te={logoChart:function(e){function n(t,e,n){var r=e.append("g").attr("class",""+t.profileImageName).attr("transform","translate(0,0)"),a=t.y+.5,i=t.x+.5,o=t.arcRadius,s=1.2*t.arcRadius,u=t.imageFrameColor,c=t.profileImageName,f=t.imageWidth,p=t.imageHeight,g=r.append("defs").attr("id","imgdefs"),v=g.append("pattern").attr("id","imagePattern").attr("height",1).attr("width",1).attr("viewBox","0 0 "+f+" "+p).attr("preserveAspectRatio","none");if(v.append("image").attr("preserveAspectRatio","none").attr("height",p).attr("width",f).attr("xlink:href",c),r.append("circle").attr("r",o).attr("value",n).attr("transform",function(){return"translate("+C(i)+","+M(a)+")"}).attr("stroke",u).attr("stroke-width",k).attr("fill","url(#imagePattern)").on("mousemove",function(){var t,e=d3.select(this).attr("value"),r=y[e]+"("+x[e]+")";t=l[e]>0?"+"+l[e]+" "+A:l[e]+" "+A,headingName=l[n]>0?d[2]:d[3];var a=[{headingName:headingName,headingVal:t}];H.showToolTip(d3.event,"",r,!1,a,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}),l[n]>0)var m=C(i)-(s+o)/2,w=M(a)-2.2*(s-o),T=C(i)-((s+o)/2-1.5*(s-o)),S=M(a),L=C(i)-((s+o)/2+1.5*(s-o)),D=M(a);else var m=C(i)+(s+o)/2,w=M(a)+2.2*(s-o),T=C(i)+((s+o)/2-1.5*(s-o)),S=M(a),L=C(i)+((s+o)/2+1.5*(s-o)),D=M(a);var N=r.append("polygon").attr("class","triangle-value-indicator").style("stroke","white").style("stroke-width",2).style("fill",function(){return l[n]>=0?h[2]:h[3]}).attr("points",function(){return l[n]>=0?""+m+","+(M(a-.5)-15)+","+T+","+M(a-.5)+","+L+","+M(a-.5):""+m+","+(M(a+.5)+15)+","+T+","+M(a+.5)+","+L+","+M(a+.5)});N.transition().duration(2e3).attr("points",""+m+","+w+","+T+","+S+","+L+","+D);var _=t.text.toString(),P=8,I=8;_=_+" "+A;var V=C(i)-_.length/2*P,F=M(a)+s+I;r.append("text").attr("x",V).attr("y",F).attr("dx",".2em").attr("dy",".25em").attr("text-anchor","start").attr("fill",function(){return l[n]>0?b[0]:b[1]}).text(function(){return l[n]>0?"+"+_:_})}g=.98*t(f).width(),v=.98*t(f).height();var r={left:.05*g,right:.05*g,bottom:.1*v,top:.05*v,chartSeparator:5},a=g-r.left-r.right,i=v-r.top-r.bottom,o=e.title,l=e.textArray,s=e.imageArray,u=e.imageFrameColor,d=e.legendArray,h=e.legendImageArray,y=e.nameArray,x=e.classArray,b=e.textColor,A=e.unit,k=e.circleStrokeWidth,w=3,T=Math.ceil(s.length/w),S=8,L=g/2-o.length*S/2,D=p.append("g").attr("class","title");R.appendLabel(o,L,r.top,0,D,m.chartTitleColor,800);var N=p.append("g").attr("transform","translate("+r.left+","+r.top+")");C=d3.scale.linear().range([0,a-r.right]);s.length-1;M=d3.scale.linear().range([i-r.top,r.bottom]);var _;_=g>400?4:3,T=s.length>_?_:s.length,w=Math.ceil(s.length/_),M.domain([0,w]),C.domain([0,T]);for(var P=[],I=w-1,V=0,F=0,z=0;z<s.length;z++){F++,console.log("counter "+F+"  "+(F>T)),F>T&&(I--,V=0,F=1);var E={x:V,y:I,index:z};P.push(E),console.log("x "+E.x+"  y"+E.y+" row "+T+" c"+F),V++}var G,O;G=P[1]?(C(P[1].x)-C(P[0].x))/2:C(P[0].x+.5),O=w>1?(M(P[_].y)-M(P[0].y))/2:M(P[0].y+.5);var B=0;B=O>G?G:O,B=1.1*Math.abs(B);for(var X=B,q=.5*B,z=0;z<P.length;z++)P[z].imageWidth=X,P[z].imageHeight=X,P[z].arcRadius=q,P[z].profileImageName=s[z],P[z].imageFrameColor=u[z],P[z].text=l[z],n(P[z],N,z);var U=p.append("g").attr("class","legend").attr("transform","translate("+r.left+","+r.top+")"),j=5,W=i,$=Y.showHorizontalLegend(a,W,d,1.5*j,1.5*j),J=[];J.push($[0]),J.push($[1]);U.selectAll(".circle").data(J).enter().append("circle").attr("class","legend").attr("r",j).attr("cx",function(t,e){return J[e].x}).attr("cy",function(t,e){return J[e].y}).attr("fill",function(t,e){return h[e]});J=[],J.push($[2]),J.push($[3]),U.selectAll(".polygon").data(J).enter().append("polygon").attr("class","legend").style("fill",function(t,e){return h[e]}).attr("points",function(t,e){var n=J[e].x,r=J[e].y;return""+(n-2)+","+(r-j/2)+","+(n-9)+","+(r+8)+","+(n+5)+","+(r+8)});U.selectAll(".text").data($).enter().append("text").attr("x",function(t,e){return $[e].textXPos}).attr("y",function(t,e){return $[e].y+j}).attr("font-family","calibri").attr("font-size","11px","important").text(function(t,e){return d[e]});c(p)}},Se={multiAxisChartAnalysis:function(e){var n=e.yObject,r=e.xAxisData,a=e.legendColor,i=e.legend,o=e.title,l=e.xAxisLabel,s={left:20,right:.05*g,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},u=g-s.left-s.right,d=v-s.top-s.bottom,h=8,y=g/2-o.length*h/2,x=p.append("g").attr("class","title");R.appendLabel(o,y,s.top/2,0,x,m.chartTitleColor,800);var b=t(f).offset().left,A=p.append("g").attr("class","scoredMainGroup").attr("transform","translate("+s.left+","+s.top+")").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}if(t-=b+s.left,t=Math.round(E.invert(t)),t>=0&&t<r.length){console.log(t);var e=r[t],a=[{headingName:i[0],headingVal:n[0].yAxisData[t]},{headingName:i[1],headingVal:n[0].yAixsAvgData[t]},{headingName:i[2],headingVal:n[1].yAxisData[t]},{headingName:i[3],headingVal:n[1].yAixsAvgData[t]},{headingName:i[4],headingVal:n[2].yAxisData[t]},{headingName:i[5],headingVal:n[2].yAixsAvgData[t]}];H.showToolTip(d3.event,"",e,!1,a,.95*d3.event.pageY)}C.attr("display","block").attr("x1",E(t)).attr("x2",E(t))}).on("mouseleave",function(){C.attr("display","none"),H.hideTooTip()}),h=6,M=l.toString().length*h,k=d+(s.bottom-5),w=u/2-M/2;R.appendLabel(l,w,k,0,A,m.xLabelColor,600);for(var C=A.append("line").attr("y1",s.top).attr("y2",d).attr("stroke","#a7a7a7").attr("display","none"),T=[],S=0,L=u,D=11,N=0,_=0;_<n.length;_++){for(var P=0,I=0;I<n[_].yAxisData.length;I++)P<n[_].yAxisData[I].toString().length&&(P=n[_].yAxisData[I].toString().length),P<n[_].yAixsAvgData[I].toString().length&&(P=n[_].yAixsAvgData[I].toString().length);P*=D;var V;if(V=d3.min(n[_].yAxisData)<d3.min(n[_].yAixsAvgData)?n[_].yAxisData:n[_].yAixsAvgData,yMin=O.getMin(V),V=d3.max(n[_].yAxisData)>d3.max(n[_].yAixsAvgData)?n[_].yAxisData:n[_].yAixsAvgData,yMax=O.getMax(V),T[_]=d3.scale.linear().domain([yMin,yMax]).range([d,0]),_%2==0){S+=P;var F=d3.svg.axis().scale(T[_]).orient("left").tickValues(function(){return 0==N?X.getTickArray(yMin,yMax,6):X.getTickArray(yMin,yMax,5)});A.append("g").attr("class","y axis").attr("transform","translate("+S+",0)").attr("fill","none").style("stroke-width",.3).style("stroke",n[_].yAxisColor).call(F).selectAll("text").attr("fill",n[_].yAxisColor)}else{var F=d3.svg.axis().scale(T[_]).orient("left").tickValues(function(){return 0==N?(N=1,X.getTickArray(yMin,yMax,6)):(N=0,X.getTickArray(yMin,yMax,5))});A.append("g").attr("class","y axis").attr("transform","translate("+L+",0)").attr("fill","none").style("stroke-width",.3).style("stroke",n[_].yAxisColor).call(F).selectAll("text").attr("fill",n[_].yAxisColor),L-=P}}for(var z=[],_=0;_<r.length;_++)z[_]=_;for(var E=d3.scale.linear().domain([0,r.length-1]).range([S,L-.01*L]),P=0,_=0;_<r.length;_++)P<r[_].toString().length&&(P=r[_].toString().length);for(var G=d3.svg.axis().scale(E).orient("bottom").tickValues(X.getXTickArray(0,r.length,P,L-S)),B=(A.append("g").attr("class","x axis").attr("transform","translate(0,"+(d-5)+")").attr("fill","none").call(G).selectAll("text").text(function(t){return r[t]}),A.append("g").attr("class","legend").attr("transform","translate("+S+",0)")),q=15,U=3,j=0,W=Y.showHorizontalLegend(L-S,j,i,q,q),_=(B.selectAll(".line").data(W).enter().append("line").attr("x1",function(t,e){return W[e].x}).attr("y1",function(t,e){return W[e].y}).attr("x2",function(t,e){return W[e].x+q}).attr("y2",function(t,e){return W[e].y}).attr("stroke",function(t,e){return a[e]}).attr("stroke-width",function(t,e){return e%2==0?U:1.5}).style("stroke-dasharray",function(t,e){return e%2==0?"0, 0":"2, 2"}),B.selectAll(".text").data(W).enter().append("text").attr("x",function(t,e){return W[e].textXPos}).attr("y",function(t,e){return W[e].y+U}).attr("font-family","calibri").text(function(t,e){return i[e]}),0);_<n.length;_++){var $=d3.svg.line().x(function(t,e){return E(z[e])}).y(function(t,e){return T[_](n[_].yAxisData[e])}),J=A.selectAll(".path").data([r]).enter().append("path").attr("d",$).attr("stroke",n[_].yAxisColor).attr("stroke-width",3).attr("fill","none"),Z=J.node().getTotalLength();J.attr("stroke-dasharray",function(){return Z+","+Z}).attr("stroke-dashoffset",Z).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var K=d3.svg.line().x(function(t,e){return E(z[e])}).y(function(t,e){return T[_](n[_].yAixsAvgData[e])}),Q=A.selectAll(".path").data([r]).enter().append("path").attr("d",K).attr("stroke",n[_].yAxisColor).attr("stroke-width",1.5).attr("fill","none"),te=Q.node().getTotalLength();Q.attr("stroke-dasharray",function(){for(var t=3,e=2*t,n=t;te>e;)n+=","+t+","+t,e+=2*t;return n+","+te}).attr("stroke-dashoffset",te).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var ee=A.selectAll(".circle").data(r).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",3).attr("stroke",n[_].yAxisColor).attr("fill","white");ee.transition().duration(2500).attr("cx",function(t,e){return E(z[e])}).attr("cy",function(t,e){return T[_](n[_].yAxisData[e])});var ne=A.selectAll(".circle").data(r).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",3).attr("stroke",n[_].yAxisColor).attr("fill","white");ne.transition().duration(2500).attr("cx",function(t,e){return E(z[e])}).attr("cy",function(t,e){return T[_](n[_].yAixsAvgData[e])})}c(p)}},Le={threeDPieChartAnalysis:function(t){function e(t,e,n,r){if(t.endAngle-t.startAngle==0)return"M 0 0";var a=e*Math.cos(t.startAngle),i=n*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=n*Math.sin(t.endAngle),s=[];return s.push("M",a,i,"A",e,n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",r*o,r*l),s.push("A",r*e,r*n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",r*a,r*i,"z"),s.join(" ")}function n(t,e,n,r){var a=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(a),l=n*Math.sin(a),s=e*Math.cos(i),u=n*Math.sin(i),c=[];return c.push("M",o,r+l,"A",e,n,"0 0 1",s,r+u,"L",s,u,"A",e,n,"0 0 0",o,l,"z"),c.join(" ")}function r(t,e,n,r,a){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=a*e*Math.cos(i),s=a*n*Math.sin(i),u=a*e*Math.cos(o),c=a*n*Math.sin(o),d=[];return d.push("M",l,s,"A",a*e,a*n,"0 0 1",u,c,"L",u,r+c,"A",a*e,a*n,"0 0 0",l,r+s,"z"),d.join(" ")}function a(t,e){return t.endAngle-t.startAngle>.2?Math.round(h[e]/S*100)+x:""}function i(t){return Math.round(h[t]/S*100)+x}function o(t){var e=d3.interpolate({startAngle:-180*C,endAngle:-180*C},t);return function(t){return r(e(t),D,N,_,P)}}function l(t){var n=d3.interpolate({startAngle:-180*C,endAngle:-180*C},t);return function(t){return e(n(t),D,N,P)}}function s(t){var e=d3.interpolate({startAngle:-180*C,endAngle:-180*C},t);return function(t){return n(e(t),D,N,_)}}var u,d,f,h=t.dountData,y=t.dountKey,m=t.colorArray,x=t.unit,b=t.factor;500>g?(f=5.5,d=10,u={left:60,right:60,bottom:35,top:35,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g}):(f=7,d=12,u={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g});for(var A=g-u.left-u.right,M=v-u.top-u.bottom,k=p.append("g").attr("class","main-group").attr("transform","translate("+u.left+","+u.top+")"),w=k.append("g").attr("class","dountPie").attr("transform","translate("+A/2+","+M/2+")"),C=Math.PI/180,T=0,S=0,L=0;L<h.length;L++)S+=h[L];var D=A>M?M:A;D=.45*D;var N=.75*D,_=25,P=0,I=d3.layout.pie().sort(null).value(function(t){return t});w.selectAll(".innerSlice").data(I(h)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return m[e]}).attr("d",function(t){return r(t,D,N,_,P)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*T,n=Math.sin(t.midAngle)*T;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",o),w.selectAll(".topSlice").data(I(h)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){return m[e]}).style("stroke",function(t,e){return m[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return e(t,D,N,P)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*T,n=Math.sin(t.midAngle)*T;return"translate("+e+","+n+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=p.select("#text"+t).attr("x");p.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=p.select("#text"+t).attr("x");p.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=y[t],n=i(t),r=[{headingName:b,headingVal:n}];H.showToolTip(d3.event,"",e,!1,r,.96*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).transition().duration(1500).attrTween("d",l),w.selectAll(".outerSlice").data(I(h)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){return m[e]}).attr("d",function(t){return n(t,D,N,_)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*T,n=Math.sin(t.midAngle)*T;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",s),w.selectAll(".percent").data(I(h)).enter().append("text").attr("class","percent").attr("x",function(t){return.6*D*Math.cos(.5*(t.startAngle+t.endAngle))}).attr("y",function(t){return.6*N*Math.sin(.5*(t.startAngle+t.endAngle))}).text(function(t,e){return a(t,e)});for(var V,F,z=d3.svg.line().x(function(t,e){return E[e]}).y(function(t,e){return G[e]}),E=[],G=[],Y=0,L=0;L<h.length;L++)V=h[L]/S*360,F=Y,Y+=V,F=(F+Y)/2,E[0]=.98*D*Math.cos(F*(Math.PI/180)),G[0]=.98*N*Math.sin(F*(Math.PI/180)),E[1]=1.2*D*Math.cos(F*(Math.PI/180)),G[1]=1.2*N*Math.sin(F*(Math.PI/180)),E[2]=E[1]+.15*D*Math.cos(F*(Math.PI/180)),G[2]=G[1],w.selectAll(".path").data([E]).enter().append("path").attr("d",z).attr("stroke-width",1).attr("fill","none").attr("stroke",m[L]),w.append("text").attr("id",function(){return"text"+L}).attr("x",function(){return E[2]>0?E[2]:E[2]-y[L].length*f}).attr("y",G[2]+3).attr("fill",m[L]).style("font-size",d+"px").text(function(){return y[L]
});c(p)}},De={threeDPieChartWithLegendAnalysis:function(t){function e(t,e,n,r){if(t.endAngle-t.startAngle==0)return"M 0 0";var a=e*Math.cos(t.startAngle),i=n*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=n*Math.sin(t.endAngle),s=[];return s.push("M",a,i,"A",e,n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",r*o,r*l),s.push("A",r*e,r*n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",r*a,r*i,"z"),s.join(" ")}function n(t,e,n,r){var a=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(a),l=n*Math.sin(a),s=e*Math.cos(i),u=n*Math.sin(i),c=[];return c.push("M",o,r+l,"A",e,n,"0 0 1",s,r+u,"L",s,u,"A",e,n,"0 0 0",o,l,"z"),c.join(" ")}function r(t,e,n,r,a){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=a*e*Math.cos(i),s=a*n*Math.sin(i),u=a*e*Math.cos(o),c=a*n*Math.sin(o),d=[];return d.push("M",l,s,"A",a*e,a*n,"0 0 1",u,c,"L",u,r+c,"A",a*e,a*n,"0 0 0",l,r+s,"z"),d.join(" ")}function a(t,e){return t.endAngle-t.startAngle>.2?Math.round(y[e]/T*100)+b:""}function i(t){return Math.round(y[t]/T*100)+b}function o(t){var e=d3.interpolate({startAngle:-180*w,endAngle:-180*w},t);return function(t){return r(e(t),V,F,E,G)}}function l(t){var n=d3.interpolate({startAngle:-180*w,endAngle:-180*w},t);return function(t){return e(n(t),V,F,G)}}function s(t){var e=d3.interpolate({startAngle:-180*w,endAngle:-180*w},t);return function(t){return n(e(t),V,F,E)}}function u(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}var d,f,h,y=t.dountData,m=t.dountKey,x=t.colorArray,b=t.unit,A=t.factor;500>g?(h=5.5,f=10,d={left:5,right:5,bottom:5,top:5,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g}):(h=7,f=12,d={left:.07*g,right:.07*g,bottom:.05*v,top:.05*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g});for(var M=g-d.left-d.right,k=v-d.top-d.bottom,w=Math.PI/180,C=0,T=0,S=0,L=5,D=10,N=10,_=0;_<y.length;_++)S<m[_].length&&(S=m[_].length),T+=y[_];totalLagendLength=D+L+S*h+5,scaleWidthPie=M-totalLagendLength;var P=p.append("g").attr("class","main-group").attr("transform","translate("+d.left+","+d.top+")"),I=P.append("g").attr("class","dountPie").attr("transform","translate("+scaleWidthPie/2+","+k/2+")").style("webkit-transform","rotateX(0deg)"),V=k/2<scaleWidthPie/2?k/2:scaleWidthPie/2,F=.7*V,z=P.append("g").attr("class","legend").attr("transform","translate("+(scaleWidthPie+3)+",0)"),E=12,G=0,Y=d3.layout.pie().sort(null).value(function(t){return t});I.selectAll(".innerSlice").data(Y(y)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return x[e]}).attr("d",function(t){return r(t,V,F,E,G)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*C,n=Math.sin(t.midAngle)*C;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",o),I.selectAll(".topSlice").data(Y(y)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=I.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("x1",0).attr("y1",0).attr("x2",V*Math.cos(t.midAngle)).attr("y2",F*Math.sin(t.midAngle)).attr("gradientUnits","userSpaceOnUse").attr("gradientTransform","rotate(0)");return n.append("stop").attr("offset","0").attr("stop-color",function(){return u(x[e],.5)}),n.append("stop").attr("offset","1").attr("stop-color",function(){return u(x[e],-.2)}),"url(#rectangleGradient"+e+")"}).style("stroke",function(t,e){return x[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return e(t,V,F,G)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*C,n=Math.sin(t.midAngle)*C;return"translate("+e+","+n+")"}).on("mouseover",function(){d3.select(this).attr("value")}).on("mouseout",function(){d3.select(this).attr("value")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=m[t],n=i(t),r=[{headingName:A,headingVal:n}];H.showToolTip(d3.event,"",e,!1,r,.96*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).transition().duration(1500).attrTween("d",l),I.selectAll(".outerSlice").data(Y(y)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){var n=I.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return n.append("stop").attr("offset","0").attr("stop-color",function(){return u(x[e],.3)}),n.append("stop").attr("offset","1").attr("stop-color",function(){return u(x[e],-.7)}),"url(#rectangleGradient"+e+")"}).attr("d",function(t){return n(t,V,F,E)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*C,n=Math.sin(t.midAngle)*C;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",s),I.selectAll(".percent").data(Y(y)).enter().append("text").attr("class","percent").attr("x",function(t){return.6*V*Math.cos(.5*(t.startAngle+t.endAngle))}).attr("y",function(t){return.6*F*Math.sin(.5*(t.startAngle+t.endAngle))}).text(function(t,e){return a(t,e)});for(var R=(d3.svg.line().x(function(t,e){return xCoordinate[e]}).y(function(t,e){return yCoordinate[e]}),0),O=0;O<m.length;O++)z.append("rect").attr("x",0).attr("y",function(){return R}).attr("width",D).attr("height",N).attr("fill",function(){return x[O]}),z.append("text").attr("x",D+L).attr("y",R).text(function(){return m[O]}).attr("dy",".7em").style("font-family","calibri").style("font-size",f,"important"),R+=2*N;c(p)}},Ne={threeDDountChartWithLegendAnalysis:function(t){function e(t,e,n,r){if(t.endAngle-t.startAngle==0)return"M 0 0";var a=e*Math.cos(t.startAngle),i=n*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=n*Math.sin(t.endAngle),s=[];return s.push("M",a,i,"A",e,n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",r*o,r*l),s.push("A",r*e,r*n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",r*a,r*i,"z"),s.join(" ")}function n(t,e,n,r){var a=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(a),l=n*Math.sin(a),s=e*Math.cos(i),u=n*Math.sin(i),c=[];return c.push("M",o,r+l,"A",e,n,"0 0 1",s,r+u,"L",s,u,"A",e,n,"0 0 0",o,l,"z"),c.join(" ")}function r(t,e,n,r,a){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=a*e*Math.cos(i),s=a*n*Math.sin(i),u=a*e*Math.cos(o),c=a*n*Math.sin(o),d=[];return d.push("M",l,s,"A",a*e,a*n,"0 0 1",u,c,"L",u,r+c,"A",a*e,a*n,"0 0 0",l,r+s,"z"),d.join(" ")}function a(t){return Math.round(h[t]/C*100)+x}function i(t){var e=d3.interpolate({startAngle:-180*k,endAngle:-180*k},t);return function(t){return r(e(t),I,V,z,E)}}function o(t){var n=d3.interpolate({startAngle:-180*k,endAngle:-180*k},t);return function(t){return e(n(t),I,V,E)}}function l(t){var e=d3.interpolate({startAngle:-180*k,endAngle:-180*k},t);return function(t){return n(e(t),I,V,z)}}function s(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}var u,d,f,h=t.dountData,y=t.dountKey,m=t.colorArray,x=t.unit,b=t.factor;500>g?(f=5.5,d=10,u={left:5,right:5,bottom:5,top:5,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g}):(f=7,d=12,u={left:.07*g,right:.07*g,bottom:.05*v,top:.05*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g});for(var A=g-u.left-u.right,M=v-u.top-u.bottom,k=Math.PI/180,w=0,C=0,T=0,S=5,L=10,D=10,N=0;N<h.length;N++)T<y[N].length&&(T=y[N].length),C+=h[N];totalLagendLength=L+S+T*f+5,scaleWidthPie=A-totalLagendLength;var _=p.append("g").attr("class","main-group").attr("transform","translate("+u.left+","+u.top+")"),P=_.append("g").attr("class","dountPie").attr("transform","translate("+scaleWidthPie/2+","+M/2+")"),I=M/2<scaleWidthPie/2?M/2:scaleWidthPie/2,V=.7*I,F=_.append("g").attr("class","legend").attr("transform","translate("+(scaleWidthPie+5)+",0)"),z=12,E=.6,G=d3.layout.pie().sort(null).value(function(t){return t});P.selectAll(".innerSlice").data(G(h)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){var n=P.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return n.append("stop").attr("offset","0").attr("stop-color",function(){return s(m[e],.3)}),n.append("stop").attr("offset","1").attr("stop-color",function(){return s(m[e],-.3)}),"url(#rectangleGradient"+e+")"}).attr("d",function(t){return r(t,I,V,z,E)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,n=Math.sin(t.midAngle)*w;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",i),P.selectAll(".topSlice").data(G(h)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=P.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("x1",0).attr("y1",0).attr("x2",I*Math.cos(t.midAngle)).attr("y2",V*Math.sin(t.midAngle)).attr("gradientUnits","userSpaceOnUse").attr("gradientTransform","rotate(0)");return n.append("stop").attr("offset","0").attr("stop-color",function(){return s(m[e],.5)}),n.append("stop").attr("offset","1").attr("stop-color",function(){return s(m[e],-.5)}),"url(#rectangleGradient"+e+")"}).style("stroke",function(t,e){return m[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return e(t,I,V,E)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,n=Math.sin(t.midAngle)*w;return"translate("+e+","+n+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");p.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");p.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=y[t],n=a(t),r=[{headingName:b,headingVal:n}];H.showToolTip(d3.event,"",e,!1,r,.96*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).transition().duration(1500).attrTween("d",o),P.selectAll(".outerSlice").data(G(h)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){var n=P.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return n.append("stop").attr("offset","0").attr("stop-color",function(){return s(m[e],.3)}),n.append("stop").attr("offset","1").attr("stop-color",function(){return s(m[e],-.7)}),"url(#rectangleGradient"+e+")"}).attr("d",function(t){return n(t,I,V,z)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,n=Math.sin(t.midAngle)*w;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",l);for(var Y=(d3.svg.line().x(function(t,e){return xCoordinate[e]}).y(function(t,e){return yCoordinate[e]}),0),R=0;R<y.length;R++)F.append("rect").attr("x",0).attr("y",function(){return Y}).attr("width",L).attr("height",D).attr("fill",function(){return m[R]}),F.append("text").attr("x",L+S).attr("y",Y).text(function(){return y[R]}).attr("dy",".7em").style("font-family","calibri").style("font-size",d,"important"),Y+=2*D;c(p)}},_e={drillDownDountChartAnalysis:function(t){function e(t,e,r){var a=[],i=[];u[u.length-1]!=t&&u.push(t);for(var o in t)a.push(t[o].data),i.push(t[o].color);n(t,a,i,e,r)}function n(n,a,o,u,c){function f(t){var e=d3.interpolate({startAngle:-180*y,endAngle:-180*y},t);return function(t){return x(e(t))}}var h=[],g=[],v=0;p.select("#donutGroup").remove(),p.select("#arcGroup").remove();var y=Math.PI/180,m=d.append("g").attr("id","donutGroup").attr("transform","translate("+.5*l+","+.5*s+")"),x=d3.svg.arc().innerRadius(u).outerRadius(c),b=d3.layout.pie().value(function(t){return t}),A=m.selectAll(".arc").data(b(a)).enter().append("g").attr("class",function(t,e){h[v]=t.startAngle,g[v]=t.endAngle,v++;var r=0;for(var a in n){if(e==r)return a;r++}}).attr("keyname",function(t,e){var r=0;for(var a in n){if(e==r)return n[a].data;r++}}).on("click",function(){var t=d3.select(this).attr("class");for(var r in n)for(var a in n[r].key)r==t&&(p.select("#arcGroup").remove(),e(n[r].key,u,c))}).on("mousemove",function(){var e=d3.select(this).attr("class"),n=d3.select(this).attr("keyname"),r=[{headingName:t.factor,headingVal:n+t.unit}];H.showToolTip(d3.event,"",e,!1,r,.9*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});A.append("path").attr("d",x).style("fill",function(t,e){return o[e]}).transition().duration(2e3).attrTween("d",f);var M=0;p.select("#arcGroup").remove();for(var k in n){var w=[],C=[];for(var T in n[k].key)w.push(n[k].key[T].data),C.push(n[k].key[T].color);w.length>0&&r(n[k].key,c,3*i,h[M],g[M],w,C),M++}}function r(e,n,r,a,i,o,u){function c(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}for(var f=(Math.PI/180,a),h=d.append("g").attr("id","arcGroup").attr("transform","translate("+.5*l+","+.5*s+")"),p=(d3.layout.pie().value(function(t){return t}),c(o)),g=0;g<o.length;g++){var v=o[g]/p*(i-a),y=d3.svg.arc().innerRadius(n).outerRadius(r).startAngle(f).endAngle(f+v),m=d3.svg.arc().innerRadius(n).outerRadius(r).startAngle(f).endAngle(f),x=h.append("path").attr("d",m).attr("fill",function(){return u[g]}).attr("class",function(){var t=0;for(var n in e){if(g==t)return n;t++}}).attr("keyname",function(){var t=0;for(var n in e){if(g==t)return e[n].data;t++}}).on("mousemove",function(){var e=d3.select(this).attr("class"),n=d3.select(this).attr("keyname"),r=[{headingName:t.factor,headingVal:n+t.unit}];H.showToolTip(d3.event,"",e,!1,r,.9*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});x.transition().duration(1e3).attr("d",y),f+=v}}var a,i,o,l,s,u=[],c={leftMargin:.1*g,rightMargin:.1*g,bottomMargin:.1*v,topMargin:.1*v};l=g-c.leftMargin-c.rightMargin,s=v-c.topMargin-c.bottomMargin;var d;d=p.append("g").attr("id","mainGroup").attr("transform","translate("+c.leftMargin+","+c.topMargin+")");p.append("g").attr("id","resetGroup").attr("transform","translate("+c.leftMargin+","+c.topMargin+")");s>l?(i=l/6,a=2*i):(i=s/6,a=2*i),o=i,u.push(t);var f=p.append("g").attr("id","imageGroup").attr("transform","translate("+(c.leftMargin+.5*l)+","+(c.topMargin+.5*s)+")");f.append("svg:image").attr("xlink:href","img/per.png").attr("x",-i/3).attr("y",-i/3).attr("width",2*i/3).attr("height",2*i/3).on("click",function(){u.length>2&&(p.select("#donutGroup").remove(),p.select("#arcGroup").remove(),p.select("#mainGroup").remove(),d=p.append("g").attr("id","mainGroup").attr("transform","translate("+c.leftMargin+","+c.topMargin+")"),u.pop(),e(u[u.length-1],o,a))}),e(t.key,o,a)}},Pe={treeMapChartAnalysis:function(t,e){function n(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}var r={left:.05*g,right:.05*g,bottom:.1*v,top:.05*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},a=g-r.left-r.right,i=v-r.top-r.bottom,o=p.append("g").attr("class","main-group").attr("transform","translate("+r.left+","+r.top+")"),l=o.append("g").attr("class","legend").attr("transform","translate("+.1*a+","+(i+10)+")"),s=d3.min(t.children,function(t){return t.size}),u=d3.max(t.children,function(t){return t.size}),d=d3.scale.linear().domain([s,u]).range([0,.78*a]),f=d3.scale.linear().domain([s,(s+u)/2,u]).range([e.colorLow,e.colorMed,e.colorHigh]),h=d3.layout.treemap().size([a,i]).sticky(!0).value(function(t){return t.size}),y=o.datum(t).selectAll(".rect").data(h.nodes).enter().append("rect").attr("class","treeMapNode").attr("value",function(t){return t.size}).attr("id",function(t){return t.portfolioId}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",0).attr("height",0).attr("fill",function(t,e){if("tree"==t.name)return"none";var r=o.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return r.append("stop").attr("offset","0").attr("stop-color",function(){return n(f(t.size),-.2)}),r.append("stop").attr("offset",".05").attr("stop-color",function(){return n(f(t.size),.2)}),r.append("stop").attr("offset",".95").attr("stop-color",function(){return n(f(t.size),.2)}),r.append("stop").attr("offset","1").attr("stop-color",function(){return n(f(t.size),-.2)}),"url(#rectangleGradient"+e+")"}).on("mousemove",function(e){var n=parseInt(d3.select(this).attr("value"));p.select(".gradientRepresentIcon").attr("display","block").transition().duration(1e3).attr("x",d(n));var r=[{headingName:t.factor,headingVal:e.size+t.unit}],a=e.name;H.showToolTip(d3.event,"",a,!1,r,.95*d3.event.pageY)}).on("mouseleave",function(){p.select(".gradientRepresentIcon").attr("display","none"),H.hideTooTip()});y.transition().duration(2e3).attr("width",function(t){return Math.max(0,t.dx-1)}).attr("height",function(t){return Math.max(0,t.dy-1)});var m=o.datum(t).selectAll(".text").data(h.nodes).enter().append("text").attr("x",function(t){return t.x+3}).attr("y",function(t){var e=Math.min(16,.1*Math.sqrt(t.area));return t.y+2*e}).attr("fill","black").style("font-size",function(t){return console.log(.18*Math.max(0,t.dx-1)+"           "+t.name),parseInt(Math.min(14,.18*Math.max(0,t.dx-1)))+"px"}).text("");m.transition().delay(1500).text(function(t){return 0==t.size?"":t.children?null:t.name});var x=(s+u)/2,b=[];b.push(s);var A=(s+x)/2;b.push(A),b.push(x);var A=(u+x)/2;b.push(A),b.push(u);var M=[],k=t.range[0],w=t.range[1],C=(k+w)/2;M.push(k+"%"),M.push(.5*(C+k)+"%"),M.push(C+"%"),M.push(.5*(C+w)+"%"),M.push(w+"%");var T=.8*a,S=.2*r.bottom,L=l.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1",0).attr("y1",0).attr("x2",.8*a).attr("y2",S).attr("gradientUnits","userSpaceOnUse");L.append("svg:stop").attr("offset","0%").attr("stop-color",f(b[0])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","25%").attr("stop-color",f(b[1])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","50%").attr("stop-color",f(b[2])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","75%").attr("stop-color",f(b[3])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","100%").attr("stop-color",f(b[4])).attr("stop-opacity",1),l.append("rect").attr("width",.8*a).attr("height",S).style("fill","url(#gradient)"),l.selectAll(".text").data(M).enter().append("text").attr("x",function(t,e){var n=3.5*t.toString().length;return.25*e*T-n}).attr("y",function(){return S}).attr("dy",function(){return"1em"}).attr("width",T).attr("height",S).attr("fill","black").text(function(t){return t}),l.append("svg:image").attr("class","gradientRepresentIcon").attr("xlink:href",function(){return"arrow-up.png"}).attr("y",S).attr("width",15).attr("height",15).attr("display","none"),c(p)}},Ie={activeAreaChartAnalysis:function(e){var n=e.yAxisData,r=e.xAxisData,a=e.xAxisLabel,i=e.yAxisLabel,o=e.title,l=e.lineStrokeColor,s=e.areaColor,d=t(f).offset().left,h=(t(f).offset().top,B.leftMarginController(n),{left:B.leftMarginController(n),right:.1*g,bottom:45,top:.1*v}),y=g-h.left-h.right,x=v-h.top-h.bottom,b=[],A=0,M=y/(1.5*r.length);W.init(p,x,y+h.left,h.left-M/2,h.top,m.gridLineColor);for(var k=p.append("g").attr("class","mainGroup").attr("transform","translate("+h.left+","+h.top+")"),w=O.getMin(n),C=O.getMax(n),T=0;T<e.xAxisData.length;T++)b[T]=T,A<r[T].length&&(A=r[T].length);var S=d3.scale.linear().domain([0,b.length-1]).range([2,y]),L=d3.scale.linear().domain([w,C]).range([x,0]),D=d3.svg.axis().scale(S).orient("bottom").tickValues(X.getXTickArray(0,b.length-1,A,y)),N=d3.svg.axis().scale(L).orient("left").ticks(6),_=(k.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+x+")").attr("fill","none").call(D).selectAll("text").attr("fill","black").text(function(t){return r[t]}),k.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(N).attr("fill","none").selectAll("text").attr("fill","black"),d3.svg.line().x(function(t,e){return S(e)}).y(function(t){return L(t)}).interpolate("cardinal")),P=k.append("path").attr("d",_(n)).attr("class","lineGraph").attr("stroke",l).attr("stroke-width",4).attr("fill","none"),I=P.node().getTotalLength();P.attr("stroke-dasharray",function(){return I+","+I}).attr("stroke-dashoffset",I).transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0);var V=d3.svg.area().interpolate("cardinal").x(function(t){return S(t)}).y0(x).y1(function(t,e){return L(n[e])}),F=d3.svg.area().interpolate("cardinal").x(function(t,e){return S(e)}).y0(x).y1(function(){return x}),z=k.append("path").attr("d",F(b)).attr("id","areaChart").attr("stroke-width",2).attr("fill",s).style("opacity",.3).attr("display","block");z.transition().delay(600).duration(1e3).attr("d",V(b)),z.on("mousemove",function(){var t=r[Math.round(S.invert(d3.event.pageX-d-h.left))],e=[{headingName:i,headingVal:n[Math.round(S.invert(d3.event.pageX-d-h.left))]}];H.showToolTip(d3.event,"",t,!1,e,.9*d3.event.pageY)}).on("mouseout",function(){H.hideTooTip()}).on("mouseleave",function(){H.hideTooTip()});var E=4,G=k.selectAll(".circle").data(n).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",E).attr("fill",l);G.transition().delay(600).duration(1e3).attr("cx",function(t,e){return S(e)}).attr("cy",function(t){return L(t)}),G.on("mouseover",function(){var t=d3.select(this).attr("cy"),e=d3.select(this).attr("cx"),n=(k.append("circle").attr("id","outerCircle").attr("cx",e).attr("cy",t).attr("r",E+3).attr("fill","none").attr("stroke-width",2).attr("stroke",l),r[Math.round(S.invert(d3.event.pageX-d))]),a=[{headingName:i,headingVal:Math.round(L.invert(t))}];H.showToolTip(d3.event,"",n,!1,a,.9*d3.event.pageY)}).on("mouseout",function(){d3.select("#outerCircle").remove(),H.hideTooTip()}).on("mouseleave",function(){H.hideTooTip()});var Y=p.append("g").attr("class","label").attr("transform","translate(0,"+(h.top+x)+")"),q=6,U=a.toString().length*q,j=h.bottom-5,$=g/2-U/2;R.appendLabel(a,$,j,0,Y,m.xLabelColor,600);var J=p.append("g").attr("class","label"),Z=e.yAxisLabel.toString().length*q,K=v/2+Z/2,Q=10;R.appendLabel(e.yAxisLabel,Q,K,-90,J,m.xLabelColor,600);var te=g/2-o.length*q/2,ee=p.append("g").attr("class","title");R.appendLabel(o,te,h.top/2,0,ee,m.xLabelColor,800),u(p),c(p)}},Ve={smoothLineChartAnalysis:function(e){function n(t,n){j+=300;var r=S.append("path").attr("d",U(t)).attr("class","lineGraph").attr("stroke",function(){return 1==n?e.lineColor[0]:e.lineColor[1]}).attr("stroke-width",2).attr("fill","none"),a=r.node().getTotalLength();r.attr("stroke-dasharray",function(){return a+","+a}).attr("stroke-dashoffset",a).transition().delay(j).duration(300).ease("linear").attr("stroke-dashoffset",0)}for(var r=e.average,a=[],i=[],o=0,l=[],s=0,d=[],h=[],y=e.yAxisData,x=e.xAxisData,b=e.title,A={leftMargin:B.leftMarginController(y),rightMargin:.1*g,bottomMargin:45,topMargin:.15*v},M=g-A.leftMargin-A.rightMargin,k=v-A.topMargin-A.bottomMargin,w=0;w<y.length;w++)o<y[w]&&(o=y[w]);o=o.toString().length+1;var C=t(f).offset().left,T=t(f).offset().top;p.on("mousemove",function(){d3.select(".lineMove").remove(),d3.select(".lineDiv").remove(),d3.select(".lineDiv1").remove(),d3.select(".divText").remove(),d3.select(".divText2").remove(),d3.select(".rectangle").remove();var t=d3.event.pageY-T,n=7;i[0]=t,i[1]=t-n,i[2]=t-2*n,i[3]=t-2*n,i[4]=t+2*n,i[5]=t+2*n,i[6]=t+n,i[7]=t;var r=10;a[0]=A.leftMargin,a[1]=A.leftMargin-r,a[2]=A.leftMargin-r,a[3]=A.leftMargin-15*o,a[4]=A.leftMargin-15*o,a[5]=A.leftMargin-r,a[6]=A.leftMargin-r,a[7]=A.leftMargin;var l=d3.event.pageX-A.leftMargin-C;if(l=P.invert(l),l>=0&&l<x.length-1&&t>A.topMargin&&t<=A.bottomMargin+k+10){var s=(p.append("line").attr("class","lineMove").attr("x1",A.leftMargin).attr("y1",t-1).attr("x2",M+A.leftMargin).attr("y2",t-1).attr("stroke","black").attr("stroke-width",.5).attr("fill","none"),d3.svg.line().x(function(t,e){return a[e]}).y(function(t){return t}).interpolate("closed"));p.append("path").attr("d",s(i)).attr("class","lineDiv").attr("stroke","black").attr("stroke-width",2).attr("fill","black").style("opacity",.8),p.append("text").attr("x",A.leftMargin-11*o).attr("y",t).text(function(){return Math.round(I.invert(t-A.topMargin))}).attr("class","divText").attr("dy",".4em").attr("fill","white");var u=x[Math.round(P.invert(d3.event.pageX-A.leftMargin-C))];textLength=7*u.length;var c=30,f=10*u.length,g=d3.event.pageX-C,v=k+A.topMargin-5;d[0]=g,d[1]=g-7,d[2]=g-f/2,d[3]=g-f/2,d[4]=g+f/2,d[5]=g+f/2,d[6]=g+7,h[0]=v,h[1]=v+.4*c,h[2]=v+.4*c,h[3]=v+c,h[4]=v+c,h[5]=v+.4*c,h[6]=v+.4*c;var y=d3.svg.line().x(function(t,e){return d[e]}).y(function(t){return t}).interpolate("closed");p.append("path").attr("d",y(h)).attr("class","lineDiv1").attr("stroke","black").attr("stroke-width",2).attr("fill","black").style("opacity",.8),p.append("text").attr("x",d3.event.pageX-textLength/2-C).attr("y",k+A.topMargin+15).text(function(){return u}).attr("class","divText2").attr("dy",".4em").attr("fill","white");var m=x[Math.round(P.invert(d3.event.pageX-A.leftMargin-C))],b=[{headingName:e.yAxisLabel,headingVal:Math.round(I.invert(t-A.topMargin))}];H.showToolTip(d3.event,"",m,!1,b,.9*d3.event.pageY)}else H.hideTooTip()}).on("mouseleave",function(){H.hideTooTip()}).on("mouseout",function(){H.hideTooTip()});for(var S=p.append("g").attr("class","mainGroup").attr("transform","translate("+A.leftMargin+","+A.topMargin+")"),L=O.getMin(y),D=O.getMax(y),N=0;N<e.xAxisData.length;N++)l[N]=N,s<e.xAxisData[N].length&&(s=e.xAxisData[N].length);for(var _,P=d3.scale.linear().domain([0,l.length-1]).range([2,M-2]),I=d3.scale.linear().domain([L,D]).range([k,0]),V=d3.svg.axis().scale(P).tickValues(X.getXTickArray(0,l.length-1,s+1,M)),F=d3.svg.axis().scale(I).ticks(10).orient("left"),w=(S.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+k+")").call(V).attr("fill","none").selectAll("text").attr("fill","black").text(function(t){return e.xAxisData[t]}),S.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(F).attr("fill","none").selectAll("text").attr("fill","black"),0),z=[],E=[],G=0,Y=0,q=0,U=d3.svg.line().x(function(t,e){return P(z[e])}).y(function(t){return I(t)}).interpolate("cardinal"),j=0,W=!1,N=0;N<y.length;N++)if(y[N]<=r){if(y[N]<r){for(var $=N;y[$]<r&&$<y.length;$++)z[q]=$,E[q++]=y[$];N=$}if(y[N]==r&&(z[q]=N,E[q++]=y[$],W=!0),1==W)0!=N&&n(E,!0),z=[],E=[],q=0,z[q]=N,E[q++]=y[N],W=!1;else{if(N==y.length){n(E,!0);break}_=(y[N]-y[N-1])/(N-z[q-1]),temp1=y[N-1]-_*z[q-1],Y=r,G=(Y-temp1)/_,E[q]=Y,z[q]=G,n(E,!0);var J=G;q=0,z=[],E=[],z[q]=J,E[q++]=Y,N--}}else{if(y[N]>r){for(var $=N;y[$]>r&&$<y.length;$++)z[q]=$,E[q++]=y[$];N=$}if(y[N]==r&&(z[q]=N,E[q++]=y[$],W=!0),1==W)0!=N&&n(E,!1),z=[],E=[],q=0,z[q]=N,E[q++]=y[N],W=!1;else{if(N==y.length){n(E,!1);break}_=(y[N]-y[N-1])/(N-z[q-1]),temp1=y[N-1]-_*z[q-1],Y=r,G=(Y-temp1)/_,E[q]=Y,z[q]=G,n(E,!1);var J=G;q=0,z=[],E=[],z[q]=J,E[q++]=Y,N--}}var Z=3,K=S.selectAll(".circle").data(y).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",Z).style("stroke",e.circleBoundaryColor).attr("fill",function(t){return r>=t?e.lineColor[0]:e.lineColor[1]});K.transition().duration(1500).attr("cx",function(t,e){return P(e)}).attr("cy",function(t){return I(t)}),K.on("mouseover",function(){d3.select(this).attr("r",Z+3)}).on("mouseout",function(){d3.select(this).attr("r",Z)}),S.append("line").attr("x1",0).attr("y1",I(r)).attr("x2",M).attr("y2",I(r)).attr("stroke","black").attr("stroke-width",1).attr("fill","none");var Q=p.append("g").attr("class","label").attr("transform","translate(0,"+(A.topMargin+k)+")"),te=6,ee=e.xAxisLabel.toString().length*te,ne=A.bottomMargin-10,re=g/2-ee/2;R.appendLabel(e.xAxisLabel,re,ne,0,Q,m.xLabelColor,600);var ae=p.append("g").attr("class","label"),ie=e.yAxisLabel.toString().length*te,oe=v/2+ie/2,le=A.leftMargin/3;R.appendLabel(e.yAxisLabel,le,oe,-90,ae,m.yLabelColor,600);var se=g/2-b.length*te/2,ue=p.append("g").attr("class","title");R.appendLabel(b,se,A.topMargin/2,0,ue,m.chartTitleColor,800),u(p),c(p)}},Fe={LineChartWithReverseYAxisAnalysis:function(t){var e,n,r=t.yAxisData,a=t.xAxisData,i=t.title,o=t.yAxisLabel,l=(t.xAxisLabel,t.lineStrokeWidth),s=t.circleRadius,d=[],d=[],f=0,h=[];d=r[0].data,n=d3.max(d);for(var y=0;y<r.length;y++)n<d3.max(r[y].data)&&(d=r[y].data,n=d3.max(d));yAxisDataMin=r[0].data,e=d3.min(yAxisDataMin);for(var y=0;y<r.length;y++)e>d3.min(r[y].data)&&(yAxisDataMin=r[y].data,e=d3.min(yAxisDataMin));var x={left:B.leftMarginController(d),right:.05*g,bottom:45,top:.15*v},b=g-x.left-x.right,A=v-x.top-x.bottom;W.init(p,A,b,x.left,x.top,m.gridLineColor);var M=p.append("g").attr("class","mainGroup").attr("transform","translate("+x.left+","+x.top+")");e=O.getMin(yAxisDataMin),n=O.getMax(d);for(var y=0;y<t.xAxisData.length;y++)h[y]=y,f<t.xAxisData[y].length&&(f=t.xAxisData[y].length);for(var k=d3.scale.linear().domain([0,h.length-1]).range([5,b]),w=d3.scale.linear().domain([e,n]).range([0,A]),C=d3.svg.axis().scale(k).tickValues(X.getXTickArray(0,h.length,f,b)),T=d3.svg.axis().scale(w).orient("left"),S=(M.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+A+")").call(C).attr("fill","none").selectAll("text").attr("fill","black").text(function(e){return t.xAxisData[e]}),M.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(T).attr("fill","none").selectAll("text").attr("fill","black"),d3.svg.line().x(function(t,e){return k(e)}).y(function(t){return w(t)}).interpolate("cardinal")),y=0;y<r.length;y++){var L=(M.append("path").attr("d",S(r[y].data)).attr("class","lineGraph").attr("stroke",r[y].color).attr("stroke-width",l).attr("fill","none"),M.selectAll(".circle").data(r[y].data).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",s).attr("fill",r[y].color));L.transition().duration(1500).attr("cx",function(t,e){return k(e)}).attr("cy",function(t){return w(t)}),L.on("mouseover",function(){d3.select(this).attr("r",s+2)}).on("mouseout",function(){d3.select(this).attr("r",s)}).on("mousemove",function(t,e){var n=a[e],r=[{headingName:o,headingVal:t}];H.showToolTip(d3.event,"",n,!1,r,.9*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()})}var D=p.append("g").attr("class","label").attr("transform","translate("+x.left+","+x.top+")"),N=6,_=t.xAxisLabel.toString().length*N,P=A+x.bottom-5,I=b/2-_/2;R.appendLabel(t.xAxisLabel,I,P,0,D,m.xLabelColor,600);var V=t.yAxisLabel.toString().length*N,F=A/2+V/2,z=-x.left+10;R.appendLabel(t.yAxisLabel,z,F,-90,D,m.yLabelColor,600);var E=g/2-i.length*N/2,G=p.append("g").attr("class","title");R.appendLabel(i,E,x.top/2,0,G,m.chartTitleColor,800),u(p),c(p)}},ze={horizontalStackedBarChartAnalysis:function(e){function n(t){for(var e=t;e<i.length;e++);}function r(){}for(var a=e.yAxisData,i=e.key,o=e.title,l=(e.xAxisLabel,e.yAxisLabel,t(f).offset().left,t(f).offset().top,[]),s=0,d=0,h=0,y=[],x=0,b=[],A=0;A<i.length;A++)I>d3.min(i[A].data)&&(I=d3.min(i[A].data)),V<d3.max(i[A].data)&&(V=d3.max(i[A].data)),y[A]=i[A].name,x<y[A].toString().length&&(x=y[A].toString().length),b[A]=1;for(var A=0;A<a.length;A++){h=0;for(var M=0;M<i.length;M++)h+=i[M].data[A];h>d&&(d=h)}for(var M=0;M<a.length;M++)l[M]=M,s<a[M].length&&(s=a[M].length);var k=B.leftMarginController(a);k=.7*k;var w={leftMargin:k,rightMargin:.05*g,bottomMargin:.2*v,topMargin:.05*v},C=g-w.leftMargin-w.rightMargin,T=v-w.topMargin-w.bottomMargin;
W.init(p,T,C,w.leftMargin,w.topMargin,m.gridLineColor);for(var S=T/(2*l.length),L=10,D=10,N=Y.showHorizontalLegend(C,T+w.topMargin+.6*w.bottomMargin,y,L+30,D),_=p.append("g").attr("class","legendGroup").attr("transform","translate("+w.leftMargin+",0)"),P=(_.selectAll(".rect").data(N).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("width",L).attr("height",D).attr("x",function(t,e){return N[e].x}).attr("y",function(t,e){return N[e].y}).attr("fill",function(t,e){return i[e].color}).on("click",function(){var t=d3.select(this).attr("value");1==b[t]?(n(1),b[t]=0):(b[t]=1,r())}),_.selectAll(".text").data(N).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return N[e].textXPos-20}).attr("y",function(t,e){return N[e].y}).text(function(t,e){return i[e].name}).attr("dy",".6em").attr("fill",m.legendTextColor),p.append("g").attr("class","mainGroup").attr("transform","translate("+w.leftMargin+","+w.topMargin+")")),I=d3.min(i[0].data),V=d3.max(i[0].data),F=d3.scale.linear().domain([0,1.2*d]).range([0,C]),z=d3.scale.linear().domain([0,l.length-1]).range([T-S,S]),E=d3.svg.axis().scale(F).tickValues(X.getXTickArray(0,1.2*d,d.toString().length,C)),G=d3.svg.axis().scale(z).orient("left").tickValues(l),O=(P.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+T+")").call(E).attr("fill","none").selectAll("text").attr("fill","black"),P.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(G).attr("fill","none").selectAll("text").attr("fill","black").text(function(t){return a[t]}).attr("transform","rotate(-30)"),P.append("line").attr("class","xTickLine").attr("x1",-1).attr("y1",0).attr("x2",-1).attr("y2",T).attr("stroke",m["tick-font-color"]).attr("stroke-width",1),0),A=0;A<=a.length;A++){{P.append("line").attr("class","tickLines").attr("x1",-10).attr("y1",O).attr("x2",-1).attr("y2",O).attr("stroke",m["tick-font-color"]).attr("stroke-width",1)}O+=2*S}for(var S=T/(2*l.length),q=0,j="interpolate",A=0;A<i.length;A++){A==i.length-1&&(j="bounce");for(var M=0;M<a.length;M++){P.append("rect").attr("class","rect"+i[A].name).attr("id","rect"+a[M]).attr("value",A).attr("key",M).attr("x",function(){if(0==A)return 0;for(var t=0,e=0;A>e;e++)t+=F(i[e].data[M]);return t}).attr("y",z(M)-S/2).attr("width",0).attr("height",S).attr("fill",i[A].color).on("mousemove",function(){U.hideTooTip();var t=d3.select(this).attr("value"),e=d3.select(this).attr("key"),n=i[t].name,r=i[t].data[e];U.showToolTip(d3.event,g,n,r,i[t].color);13*t.toString().length}).on("mouseleave",function(){U.hideTooTip()}).transition().duration(500).delay(q).attr("width",function(){return isNaN(F(i[A].data[M]))?0:F(i[A].data[M])})}q+=500}var H=p.append("g").attr("class","label").attr("transform","translate("+w.leftMargin+","+w.topMargin+")"),$=6,J=e.xAxisLabel.toString().length*$,Z=T+.5*w.bottomMargin,K=C/2-J/2;R.appendLabel(e.xAxisLabel,K,Z,0,H,m.xLabelColor,600);var Q=e.yAxisLabel.toString().length*$,te=T/2+Q/2,ee=-w.leftMargin+20;R.appendLabel(e.yAxisLabel,ee,te,-90,H,m.yLabelColor,600);var ne=C/2-o.length*$/2;R.appendLabel(o,ne,-w.topMargin+15,0,H,m.chartTitleColor,800),u(p),c(p)}},Ee={performanceChartAnalysis:function(t){function e(t,e){t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var n,r,a="#";for(r=0;3>r;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16),a+=("00"+n).substr(n.length);return a}for(var n=t.data,r=t.differentActivity,a=t.title,i=t.maxValue,o=t.minValue,l=t.lineColor,s=t.yLabel,d=(t.xLabel,t.lagendArray),f=t.lagendColor,h=[],y=[],x=0;x<n.length;x++)h[x]=n[x].class_name,y[x]=x;var b=B.leftMarginController(h),A={left:b,right:.05*g,bottom:.05*g,top:.1*v,chartSeparator:5},M=g-A.left-A.right,k=v-A.top-A.bottom,w=p.append("g").attr("class","main-group").attr("transform","translate("+A.left+","+A.top+")"),C=n.length,T=r.length,S=M/T>k/C?k/C:M/T;S=.4*S;var L=11,D=8,N=g/2-a.length*D/2,_=p.append("g").attr("class","title");R.appendLabel(a,N,A.top/2,0,_,m.chartTitleColor,800);var P=s.toString().length*D,I=k/2+P/2,V=-A.left+15;R.appendLabel(s,V,I,-90,w,m.yLabelColor,600);var F=d3.scale.linear().domain([o,i]).range([L,S]),z=d3.scale.linear().domain([0,T-1]).range([S,M-S]),E=d3.scale.linear().domain([0,C-1]).range([k-S,S]),G=w.selectAll(".line").data(h).enter().append("line").attr("x1",0).attr("y1",function(t,e){return E(e)}).attr("x2",0).attr("y2",function(t,e){return E(e)}).attr("stroke-width",2).attr("stroke",l);G.transition().duration(2e3).attr("x2",M);for(var O=0,x=0;x<r.length;x++)O<r[x].toString().length&&(O=r[x].toString().length);var q=d3.svg.axis().scale(z).orient("bottom").tickValues(X.getXTickArray(0,r.length,O,M)),U=w.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+.3*-A.top+")").call(q);U.selectAll("text").text(function(t){return r[t]});var j=d3.svg.axis().scale(E).orient("left").tickValues(y);w.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(j).selectAll("text").text(function(t){return h[t]});for(var W=0;W<r.length;W++){var $=w.selectAll(".circle").data(h).enter().append("circle").attr("cx",z(0)).attr("cy",function(t,e){return E(e)}).attr("r",function(t,e){return isNaN(F(n[e].xData[W]))?0:F(n[e].xData[W])}).attr("value",function(t,e){return n[e].xData[W]}).attr("toolTipMsg",function(t,e){return n[e].toolTipActivities[W]}).attr("yDataIndex",function(t,e){return e}).attr("xDataIndex",function(){return W}).attr("fill",function(t,r){var a=w.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+r+W).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return e(n[r].xDataColor[W],.5)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return e(n[r].xDataColor[W],-.5)}),"url(#rectangleGradient"+r+W+")"}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=parseInt(d3.select(this).attr("yDataIndex")),n=d3.select(this).attr("toolTipMsg"),r=[{headingName:h[e],headingVal:t}];H.showToolTip(d3.event,"",n,!1,r,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});$.transition().duration(2e3).attr("cx",z(W));var J=w.selectAll(".text").data(h).enter().append("text").attr("value",function(t,e){return n[e].xData[W]}).attr("toolTipMsg",function(t,e){return n[e].toolTipActivities[W]}).attr("yDataIndex",function(t,e){return e}).attr("xDataIndex",function(){return W}).attr("x",z(0)).attr("y",function(t,e){return E(e)+5}).text(function(t,e){return isNaN(n[e].xData[W])?"":n[e].xData[W]}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=parseInt(d3.select(this).attr("yDataIndex")),n=d3.select(this).attr("toolTipMsg"),r=[{headingName:h[e],headingVal:t}];H.showToolTip(d3.event,"",n,!1,r,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});J.transition().duration(2e3).attr("x",function(t,e){return z(W)-3.5*n[e].xData[W].toString().length})}{var Z=10,K=10,Q=Y.showHorizontalLegend(M,0,d,Z,K),te=p.append("g").attr("class","legendGroup").attr("transform","translate("+A.left+","+(k+A.top+10)+")");te.selectAll(".rect").data(Q).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("width",Z).attr("height",K).attr("x",function(t,e){return Q[e].x}).attr("y",function(t,e){return Q[e].y}).attr("fill",function(t,e){return f[e]}),te.selectAll(".text").data(Q).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return Q[e].textXPos}).attr("y",function(t,e){return Q[e].y}).text(function(t,e){return d[e]}).attr("dy",".7em").attr("fill",m.legendTextColor)}u(p),c(p)}},Ge={dountChartWithMappingAnalysis:function(t,e){function n(t,e,n,a){var i=0,o=0,l=[],u=[],c=d3.svg.arc().innerRadius(e).outerRadius(n),d=d3.layout.pie().value(function(t){return t}),f=k.selectAll(".arc").data(d(a)).enter().append("g").attr("class",function(e,n){l[o]=e.startAngle,u[o]=e.endAngle,o++;var r=0;for(var a in t){if(n==r)return a;r++}}),h=f.append("path").attr("d",c).attr("id",function(e,n){var r=0;for(var a in t){if(n==r)return a;r++}});h.attr("fill","none");for(var p in t){var g=[];for(var v in t[p])g.push(1);if(g.push(1),g.length>0){var y=p;r(t[p],e,n,l[i],u[i],g,s[0],y,i)}i++}}function r(t,n,r,i,o,l,u,f,h){var g,v=i,m=a(l),x=.3,b=10;c>=d?g=d/3:imgSige=c/3;for(var A=0;A<l.length-1;A++){var M=l[A]/m*(o-i),w=(M+v+v)/2,C=0,T=M*g,S=d3.svg.arc().innerRadius(n).outerRadius(r).startAngle(v).endAngle(v+M),L=d3.svg.arc().innerRadius(n).outerRadius(r).startAngle(v).endAngle(v),D=k.append("path").attr("d",L).attr("id",function(e){var n=0;for(var r in t){if(A==n){var e=r.replace(/ /g,"");return e}n++}}).attr("fill",function(){return u}).attr("stroke","black").attr("stroke-width",.3);if(D.transition().duration(2e3).attr("d",S),void 0!=e[f]){if(3.1>=w)var N=k.append("g").attr("id",function(){var e=0;for(var n in t){if(A==e)return n;e++}}).attr("transform","translate("+Math.sin(w)*n+","+-Math.cos(w)*n+") rotate("+(180*w/Math.PI-90)+")"),_=k.append("g").attr("id","imageGroup").attr("transform","translate("+Math.sin(v+M)*n+","+-Math.cos(v+M)*n+") rotate("+(180*w/Math.PI-90)+")");else var N=k.append("g").attr("id",function(){var e=0;for(var n in t){if(A==e)return n;e++}}).attr("transform","translate("+Math.sin(w)*r+","+-Math.cos(w)*r+") rotate("+(180*w/Math.PI+90)+")"),_=k.append("g").attr("id","imageGroup").attr("transform","translate("+Math.sin(v+M)*r+","+-Math.cos(v+M)*r+") rotate("+(180*w/Math.PI+90)+")");for(var P in e[f]){if(C==A){var I=P;break}C++}_.append("svg:image").attr("xlink:href",function(){return e[f][I]}).attr("x",0).attr("y",3).attr("width",30).attr("height",T),N.append("text").attr("x",40).attr("y",0).text(function(){var e=0;for(var n in t){if(A==e)return n;e++}}).style("font-family","calibri").style("font-size",M*g).attr("dy",".3em").attr("fill",e.textColor)}else{if(3.1>=w)var N=k.append("g").attr("id",function(){var e=0;for(var n in t){if(A==e)return n;e++}}).attr("transform","translate("+Math.sin(w)*n+","+-Math.cos(w)*n+") rotate("+(180*w/Math.PI-90)+")");else var N=k.append("g").attr("id",function(){var e=0;for(var n in t){if(A==e)return n;e++}}).attr("transform","translate("+Math.sin(w)*r+","+-Math.cos(w)*r+") rotate("+(180*w/Math.PI+90)+")");N.append("text").attr("x",10).attr("y",0).text(function(){var e=0;for(var n in t){if(A==e)return n;e++}}).style("font-family","calibri").style("font-size",M*g).attr("dy",".3em").attr("fill",e.textColor)}D.on("mouseover",function(){d3.select(this).style("fill-opacity",x);for(var e in t){var n=e.replace(/ /g,"");if(n==d3.select(this).attr("id"))for(var r in t[e])for(var a=0;a<t[e][r].length;a++){var i=t[e][r][a].replace(/ /g,"");p.select("#"+i).style("fill-opacity",x)}}}).on("mouseleave",function(){d3.select(this).style("fill-opacity",b);for(var e in t){var n=e.replace(/ /g,"");if(n==d3.select(this).attr("id"))for(var r in t[e])for(var a=0;a<t[e][r].length;a++){var i=t[e][r][a].replace(/ /g,"");p.select("#"+i).style("fill-opacity",b)}}}),v+=M}var V=d3.svg.arc().innerRadius(r).outerRadius(r+20).startAngle(i).endAngle(v),F=(k.append("path").attr("d",V).attr("id","path"+h).attr("fill",function(){return s[1]}).attr("stroke","black"),e.title[y++]),z=k.append("text").attr("dy",15);z.append("textPath").attr("xlink:href","#path"+h).attr("startOffset","20%").text(F).style("font-size",14).attr("fill","black")}function a(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function i(t){var e=d3.interpolate({startAngle:-180*h,endAngle:-180*h},t);return function(t){return w(e(t))}}var o,l,s=e.color,u={left:.1*g,right:.1*g,bottom:.1*v,top:.1*v},c=g-u.left-u.right,d=v-u.top-u.bottom,f=[],h=Math.PI/180,y=0,m=p.append("g").attr("class","mainGroup").attr("transform","translate("+u.left+","+u.top+")");o=d>c?c/2:d/2,l=o/2.2;var x=0,b=0;for(var A in t){b=0;for(var M in t[A])b++;f[x++]=b+1}var k=m.append("g").attr("id","donutGroup").attr("transform","translate("+.5*c+","+.5*d+")"),w=d3.svg.arc().innerRadius(l-30).outerRadius(l),C=d3.layout.pie().value(function(t){return t}),T=[];T[0]=1;k.selectAll(".arc").data(C(T)).enter().append("g").append("path").attr("d",w).attr("fill",function(){return s[1]}).transition().duration(2e3).attrTween("d",i).attr("stroke","black");n(t,l,o,f,s[1])}},Ye={threeDDountChartAnalysis:function(e){function n(t,e,n,r){if(t.endAngle-t.startAngle==0)return"M 0 0";var a=e*Math.cos(t.startAngle),i=n*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=n*Math.sin(t.endAngle),s=[];return s.push("M",a,i,"A",e,n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",r*o,r*l),s.push("A",r*e,r*n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",r*a,r*i,"z"),s.join(" ")}function r(t,e,n,r){var a=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(a),l=n*Math.sin(a),s=e*Math.cos(i),u=n*Math.sin(i),c=[];return c.push("M",o,r+l,"A",e,n,"0 0 1",s,r+u,"L",s,u,"A",e,n,"0 0 0",o,l,"z"),c.join(" ")}function a(t,e,n,r,a){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=a*e*Math.cos(i),s=a*n*Math.sin(i),u=a*e*Math.cos(o),c=a*n*Math.sin(o),d=[];return d.push("M",l,s,"A",a*e,a*n,"0 0 1",u,c,"L",u,r+c,"A",a*e,a*n,"0 0 0",l,r+s,"z"),d.join(" ")}function i(t){return Math.round(y[t]/L*100)+b}function o(t){var e=d3.interpolate({startAngle:-180*T,endAngle:-180*T},t);return function(t){return a(e(t),N,_,P,I)}}function l(t){var e=d3.interpolate({startAngle:-180*T,endAngle:-180*T},t);return function(t){return n(e(t),N,_,I)}}function s(t){var e=d3.interpolate({startAngle:-180*T,endAngle:-180*T},t);return function(t){return r(e(t),N,_,P)}}var u,d,h,y=e.dountData,m=e.dountKey,x=e.colorArray,b=e.unit,A=e.factor;500>g?(h=5.5,d=10,u={left:60,right:60,bottom:35,top:35,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g}):(h=7,d=12,u={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g});for(var M=g-u.left-u.right,k=v-u.top-u.bottom,w=p.append("g").attr("class","main-group").attr("transform","translate("+u.left+","+u.top+")"),C=w.append("g").attr("class","dountPie").attr("transform","translate("+M/2+","+k/2+")"),T=(t(f).offset().left,Math.PI/180),S=0,L=0,D=0;D<y.length;D++)L+=y[D];var N=M>k?k:M;N=.45*N;var _=.75*N,P=25,I=.75,V=d3.layout.pie().sort(null).value(function(t){return t});C.selectAll(".innerSlice").data(V(y)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return x[e]}).attr("d",function(t){return a(t,N,_,P,I)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*S,n=Math.sin(t.midAngle)*S;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",o),C.selectAll(".topSlice").data(V(y)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){return x[e]}).style("stroke",function(t,e){return x[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return n(t,N,_,I)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*S,n=Math.sin(t.midAngle)*S;return"translate("+e+","+n+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=p.select("#text"+t).attr("x");p.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=p.select("#text"+t).attr("x");p.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=m[t],n=i(t),r=[{headingName:A,headingVal:n}];H.showToolTip(d3.event,"",e,!1,r,.96*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).transition().duration(1500).attrTween("d",l),C.selectAll(".outerSlice").data(V(y)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){return x[e]}).attr("d",function(t){return r(t,N,_,P)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*S,n=Math.sin(t.midAngle)*S;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",s);for(var F,z,E=d3.svg.line().x(function(t,e){return G[e]}).y(function(t,e){return Y[e]}),G=[],Y=[],R=0,D=0;D<y.length;D++)F=y[D]/L*360,z=R,R+=F,z=(z+R)/2,G[0]=.98*N*Math.cos(z*(Math.PI/180)),Y[0]=.98*_*Math.sin(z*(Math.PI/180)),G[1]=1.2*N*Math.cos(z*(Math.PI/180)),Y[1]=1.2*_*Math.sin(z*(Math.PI/180)),G[2]=G[1]+.1*N*Math.cos(z*(Math.PI/180)),Y[2]=Y[1],C.selectAll(".path").data([G]).enter().append("path").attr("d",E).attr("stroke-width",1).attr("fill","none").attr("stroke",x[D]),C.append("text").attr("id",function(){return"text"+D}).attr("x",function(){return G[2]>0?G[2]:G[2]-(m[D].length+i(D).length+1)*h}).attr("y",Y[2]+3).attr("fill",x[D]).text(function(){return i(D)+" "+m[D]});c(p)}},Re={roundedThreeDBarAnalysis:function(e){for(var n=e.barData,r=e.xAxisLabel,a=e.yAxisLabel,i=e.title,o=e.unit,l=[],s=[],d=0;d<n.length;d++)l[d]=d,s[d]=n[d].visits;var h=B.leftMarginController(s),y={left:h,right:.05*g,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},x=g-y.left-y.right,b=v-y.top-y.bottom,A=x/(1.5*n.length),M=.15*A,k=p.append("g").attr("class","main-group").attr("transform","translate("+y.left+","+y.top+")"),w=8,C=g/2-i.length*w/2,T=p.append("g").attr("class","title");R.appendLabel(i,C,y.top/2,0,T,m.chartTitleColor,800);var w=7,S=r.toString().length*w,L=b+(y.bottom-5),D=x/2-S/2;R.appendLabel(r,D,L,0,k,m.xLabelColor,600);var N=a.toString().length*w,_=b/2+N/2,P=-y.left+15;R.appendLabel(a,P,_,-90,k,m.yLabelColor,600);for(var I=d3.scale.linear().domain([0,n.length-1]).range([.5*A,x-.5*A]),V=O.getMax(s),F=O.getMin(s),z=d3.scale.linear().domain([F,V]).range([b,0]),E=0,d=0;d<n.length;d++)E<n[d].country.toString().length&&(E=n[d].country.toString().length);var G=d3.svg.axis().scale(I).orient("bottom").tickValues(X.getXTickArray(0,n.length-1,E,x)),Y=k.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+b+")").call(G);Y.selectAll("text").text(function(t){return n[t].country});var q=d3.svg.axis().scale(z).orient("left").tickValues(X.getTickArray(F,V,9));k.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(q).selectAll("text");var U=t(f).offset().left,j=k.selectAll(".rect").data(s).enter().append("rect").attr("width",A).attr("height",0).attr("x",function(t,e){return I(e)-A/2}).attr("y",b-M).attr("fill",function(t,e){return n[e].color}).attr("opacity",.6).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=U+y.left,t=Math.round(I.invert(t));var e=n[t].country,r=s[t],i=[{headingName:a,headingVal:r+" "+o}];H.showToolTip(d3.event,"",e,!1,i,.96*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});j.transition().duration(1500).ease("bounce").attr("height",function(t){return z(F)-z(t)-2*M}).attr("y",function(t){return z(t)+M});var W=k.selectAll(".ellipse").data(s).enter().append("ellipse").attr("cx",function(t,e){return I(e)}).attr("cy",b-M).attr("rx",A/2).attr("ry",M).attr("fill",function(t,e){return n[e].color});W.transition().duration(1500).ease("bounce").attr("cy",function(t){return z(t)+M});k.selectAll(".ellipse").data(s).enter().append("ellipse").attr("cx",function(t,e){return I(e)}).attr("cy",b-M).attr("rx",A/2).attr("ry",M).attr("fill",function(t,e){return n[e].color});u(p),c(p)}},Oe={arcWithCylinderChartAnalysis:function(e){function n(t){d3.select("#bar-main-group").remove();for(var e=p.append("g").attr("id","bar-main-group").attr("transform","translate("+a.left+","+a.top+")"),n=d3.scale.linear().domain([0,D.length]).range([.55*s,s]),r=O.getMax(o[t].barData),l=O.getMin(o[t].barData),u=d3.scale.linear().domain([l,r]).range([d,0]),c=0,f=0;f<o[t].label.length;f++)c<o[t].label[f].toString().length&&(c=o[t].label[f].toString().length);var h=d3.svg.axis().scale(n).orient("bottom").tickValues(X.getXTickArray(0,o[t].label.length,c,.5*s)),g=e.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+d+")").call(h);g.selectAll("text").text(function(e){return o[t].label[e]}).attr("fill","#a7a7a7");var v=e.selectAll(".rect").data(o[t].barData).enter().append("rect").attr("class","cylinder"+t).attr("width",M).attr("height",0).attr("x",function(t,e){return n(e)-M/2}).attr("y",d-T).attr("fill",function(e,n){return i[o[t].label[n]]}).attr("opacity",.6);v.transition().duration(1500).ease("bounce").attr("height",function(t){return u(l)-u(t)-2*T}).attr("y",function(t){return u(t)+T});var y=e.selectAll(".ellipse").data(o[t].barData).enter().append("ellipse").attr("class","cylinder"+t).attr("cx",function(t,e){return n(e)}).attr("cy",d-T).attr("rx",M/2).attr("ry",T).attr("fill",function(e,n){return i[o[t].label[n]]});y.transition().duration(1500).ease("bounce").attr("cy",function(t){return u(t)+T});e.selectAll(".ellipse").data(o[t].barData).enter().append("ellipse").attr("class","cylinder"+t).attr("cx",function(t,e){return n(e)}).attr("cy",d-T).attr("rx",M/2).attr("ry",T).attr("fill",function(e,n){return i[o[t].label[n]]});d3.selectAll(".cylinder"+t).on("mousemove",function(){{var e=d3.event.pageX;d3.event.pageY}e-=L+a.left,e=Math.round(n.invert(e));var r=o[t].label[e],i=o[t].barData[e],l=[{headingName:o[t].key,headingVal:i}];H.showToolTip(d3.event,"",r,!1,l,.96*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});var x=(e.selectAll(".text").data(o[t].barData).enter().append("text").attr("x",function(t,e){return n(e)-7*t.toString().length/2}).attr("y",function(t){return u(t)+T-8}).text(function(t){return t}).attr("fill",m.yLabelColor),9),b=.7*s-o[t].key.toString().length*x/2;R.appendLabel(o[t].key,b,a.top/2,0,e,m.chartTitleColor,800)}function r(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}var a,i=e.color,o=e.subData,l=e.title;a=500>g?{left:50,right:50,bottom:35,top:35,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g}:{left:.1*g,right:.1*g,bottom:.1*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g};var s=g-a.left-a.right,d=v-a.top-a.bottom,h=p.append("g").attr("class","main-group").attr("transform","translate("+a.left+","+a.top+")"),y=9,x=s/1.7-l.length*y/2,b=p.append("g").attr("class","title");R.appendLabel(l,x,a.top/1.5,0,b,m.chartTitleColor,800);var A=h.append("g").attr("class","arc-main-group").attr("transform","translate("+(.5*s/2-.5*a.left)+","+d/2+")"),M=.45*s/(2*o[0].barData.length),k=.5*s>d?d:.5*s;k=.5*k;for(var w=.4*k,C=(k-w)/(2*o[0].barData.length),T=.2*M,S=Math.PI,L=(Math.PI/180,t(f).offset().left),D=[],N=0;N<o[0].barData.length;N++)D[N]=N;var _=(A.append("circle").attr("r",w).attr("fill","#454747").attr("opacity",.05).attr("stroke","#454747"),d3.svg.arc().innerRadius(w).outerRadius(k)),P=d3.layout.pie().sort(null).value(function(){return 1}),I=A.selectAll(".arc").data(P(o)).enter().append("g").attr("class","pie").attr("value",function(t,e){return e}).attr("startAngle",function(t,e){return e/o.length*360}).attr("endAngle",function(t,e){return(e+1)/o.length*360}).attr("fill",function(){return"#53565b"}).on("click",function(){p.selectAll(".pie").attr("fill","#53565b").attr("opacity",1),d3.select(this).attr("fill","lightsteelblue").attr("opacity",.5);{var t=d3.select(this).attr("startAngle");d3.select(this).attr("endAngle")}t=360-t,p.selectAll(".individualArc").transition().ease("bounce").duration(1500).attr("transform","rotate("+t+")"),p.selectAll(".pie").attr("transform","rotate("+t+")");var e=d3.select(this).attr("value");n(e)}).on("mouseover",function(){}).on("mouseleave",function(){});I.append("path").attr("d",_).attr("class",function(t,e){return"path"+e});for(var V,F=(I.append("text").attr("class","keyOfArc").attr("id",function(t,e){return"text"+e}),k),z=0,E=0;E<o.length;E++){F=k,theta=1/o.length*360,sum=r(o[E].barData);for(var G=0;G<o[E].barData.length;G++){var Y=o[E].barData[G]/sum*(360/o.length),B=d3.svg.arc().innerRadius(F-C).outerRadius(F).startAngle(z*(S/180)).endAngle((Y+z)*(S/180)),q=d3.svg.arc().innerRadius(F-C).outerRadius(F).startAngle(z*(S/180)).endAngle(z*(S/180)),U=A.append("path").attr("d",q).attr("class","individualArc").attr("fill",function(){return i[o[E].label[G]]}).attr("value",E+" "+G).on("mousemove",function(){var t=d3.select(this).attr("value"),e=t.split(" "),n=o[e[0]].label[e[1]],r=o[e[0]].barData[e[1]],a=[{headingName:o[e[0]].key,headingVal:r}];H.showToolTip(d3.event,"",n,!1,a,.96*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});U.transition().ease("bounce").duration(1500).attr("d",B);var j=(F-C)*Math.sin((Y+z)*(Math.PI/180)),W=-(F-C)*Math.cos((Y+z)*(Math.PI/180));I.append("text").attr("class","labelOfArc").attr("transform","translate("+j+","+W+")rotate("+(Y+z)+")").style("font-size",1.3*C+"px","important").text(function(){return o[E].barData[G]}).attr("fill",m.yLabelColor),F-=2*C}V=z,z+=theta,V=(V+z)/2;var $=1.1*k*Math.sin(V*(Math.PI/180)),J=-1.1*k*Math.cos(V*(Math.PI/180));d3.select("#text"+E).attr("transform","translate("+$+","+J+")rotate("+V+")").text(o[E].key).attr("fill",m.yLabelColor)}n(0),u(p),c(p)}},Be={comparisionAreaChartAnalysis:function(e){var n=e.title,r=e.xAxisData,a=e.xAxisLabel,i=e.yAxisLabel,o=e.yDataObj,l=B.leftMarginController(o[0].yAxisData),s={left:l,right:.025*g,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},d=g-s.left-s.right,h=v-s.top-s.bottom,y=(t(f).offset().left,{init:function(t,e,n,r,a,i){{var o=Math.ceil(.2*e),l=Math.ceil(.5*e),s=Math.ceil(e/o);Math.ceil(n/l)}t.selectAll(".hline").data(d3.range(s)).enter().append("line").attr("y1",function(t){return t*o+6}).attr("y2",function(t){return t*o+6}).attr("x1",function(){return 0}).attr("x2",function(){return n}).style("stroke",i).style("stroke-width",.3).attr("transform","translate("+r+","+a+")")}});y.init(p,h,d,s.left,s.top,m.gridLineColor);var x=p.append("g").attr("class","main-group").attr("transform","translate("+s.left+","+s.top+")"),b=7,A=g/2-n.length*b/2,M=p.append("g").attr("class","title");R.appendLabel(n,A,s.top/2,0,M,m.chartTitleColor,800);var b=7,k=i.toString().length*b,w=h/2+k/2,C=-s.left+15;R.appendLabel(i,C,w,-90,x,m.yLabelColor,600);var T=a.toString().length*b,S=h+(s.bottom-5),L=d/2-T/2;R.appendLabel(a,L,S,0,x,m.xLabelColor,600);for(var D=d3.scale.linear().domain([0,r.length-1]).range([0,d]),N=o[0].yAxisData,_=1;_<o.length;_++)d3.min(N)>d3.min(o[_].yAxisData)&&(N=o[_].yAxisData);var P=O.getMin(N);N=o[0].yAxisData;for(var _=1;_<o.length;_++)d3.max(N)<d3.max(o[_].yAxisData)&&(N=o[_].yAxisData);for(var I=O.getMax(N),V=d3.scale.linear().domain([P,I]).range([h,0]),F=0,z=0;z<r.length;z++)F<r[z].toString().length&&(F=r[z].toString().length);var E=d3.svg.axis().scale(D).orient("bottom").tickValues(X.getXTickArray(0,r.length,F,d)),G=x.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+h+")").call(E);G.selectAll("text").text(function(t){return r[t]});var q=X.getTickArray(P,I,8),U=d3.svg.axis().scale(V).orient("left").tickValues(q);x.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(U).selectAll("text").attr("fill","black");for(var j,H=d3.svg.area().x(function(t,e){return D(e)}).y0(h).y1(function(){return h}).interpolate("cardinal"),W=d3.svg.area().x(function(t,e){return D(e)}).y0(h).y1(function(t){return V(t)}).interpolate("cardinal"),$=1,_=0;_<o.length;_++)j=x.append("path").attr("d",H(o[_].yAxisData)).attr("class","path"+_).attr("fill",o[_].color).attr("opacity",$).attr("display","block"),$-=.1,j.transition().delay(1e3*_).duration(1500).ease("elastic").attr("d",W(o[_].yAxisData));for(var J=[],Z=[],_=0;_<o.length;_++)J.push(o[_].legend),Z.push(o[_].color);{var K=p.append("g").attr("class","legend").attr("transform","translate("+s.left+","+s.top+")"),Q=10,te=25,ee=0,ne=Y.showHorizontalLegend(d,ee,J,te,Q);K.selectAll(".line").data(ne).enter().append("rect").attr("id",function(t,e){return e}).attr("width",te).attr("height",Q).attr("x",function(t,e){return ne[e].x}).attr("y",function(t,e){return ne[e].y}).attr("rx",4).attr("ry",4).attr("fill",function(t,e){return Z[e]}).attr("opacity",.5).on("click",function(){var t=d3.select(this).attr("id");"none"==p.select(".path"+t).attr("display")?(p.select(".path"+t).attr("display","block"),p.select(".text"+t).style("text-decoration","none")):(p.select(".path"+t).attr("display","none"),p.select(".text"+t).style("text-decoration","line-through"))}),K.selectAll(".text").data(ne).enter().append("text").attr("class",function(t,e){return"text"+e}).attr("x",function(t,e){return ne[e].textXPos}).attr("y",function(t,e){return ne[e].y+Q}).attr("font-family","calibri").text(function(t,e){return J[e]})}u(p),c(p)}},Xe={angularMeterChartAnalysis:function(t){function e(){setInterval(function(){n()},2e3)}function n(){d3.select("#needle").remove(),d3.select("#needleText").remove();var t=Math.floor(Math.random()*(_-N+1)+N),e=t;t=P(t),b=(y-40)*Math.sin(t*(Math.PI/180)),M=-(y-40)*Math.cos(t*(Math.PI/180));(y-40)*Math.sin((t-5)*(Math.PI/180)),-(y-53)*Math.cos(t*(Math.PI/180)),(y-40)*Math.sin((t+5)*(Math.PI/180)),-(y-53)*Math.cos(t*(Math.PI/180)),f.append("line").attr("id","needle").attr("x1",0).attr("y1",0).attr("x2",b).attr("y2",M).attr("stroke","red").attr("stroke-width",3);E=b,G=M,Y=t,f.append("text").attr("id","needleText").attr("x",function(){var t=9*e.toString().length;return.5*-t}).attr("y",.7*h).text(e)}var r,a=t.data,i=t.colorArray,o=t.meterLabel,l={left:.1*g,right:.1*g,bottom:.1*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},s=g-l.left-l.right,u=v-l.top-l.bottom,c=[1,3,1],d=p.append("g").attr("class","main-group").attr("transform","translate("+l.left+","+l.top+")"),f=d.append("g").attr("class","arcGroup").attr("transform","translate("+.5*s+","+u/2+")"),h=(Math.PI/180,.5*s>.5*u?.5*u:.5*s);151>h&&(r=12);var y=.9*h;f.append("text").attr("x",function(){var t=9*o.toString().length;return.5*-t}).attr("y",.4*-h).text(o);for(var m,x,b,A,M,k=230,w=Math.PI,C=0;C<c.length;C++){{var T=c[C]/5*260,S=d3.svg.arc().innerRadius(y).outerRadius(h).startAngle(k*(w/180)).endAngle((T+k)*(w/180));f.append("path").attr("d",S).attr("class","individualArc").attr("fill",i[C])}k=T+k}var L=k;k=231;for(var D=230,N=d3.min(a),_=d3.max(a),P=d3.scale.linear().domain([N,_]).range([D+.5,L-.5]),I=0,V=((L-D)/a.length,0);V<a.length;V++){k=a[V],k=P(k),x=y*Math.sin(k*(Math.PI/180)),A=-y*Math.cos(k*(Math.PI/180)),b=(y-15)*Math.sin(k*(Math.PI/180)),M=-(y-15)*Math.cos(k*(Math.PI/180)),f.append("line").attr("x1",x).attr("y1",A).attr("x2",b).attr("y2",M).attr("stroke",function(){return D+52>k?i[0]:D+208>k?i[1]:i[2]}).attr("stroke-width",2),f.append("text").attr("x",function(){if(D+80>k)return b+3;if(D+160>k)return b-9;var t=8*a[I].toString().length;return b-t}).attr("y",function(){return D+80>k?M+4:D+160>k?M+13:M+4}).attr("fill",function(){return D+52>k?i[0]:D+208>k?i[1]:i[2]}).style("font-size",r,"important").text(a[I++]);var m,F=d3.scale.linear().domain([0,7]).range([P(a[V]),P(a[V+1])]);if(V<a.length-1)for(var z=0;7>z;z++)m=F(z),x=y*Math.sin(m*(Math.PI/180)),A=-y*Math.cos(m*(Math.PI/180)),b=(y-7)*Math.sin(m*(Math.PI/180)),M=-(y-7)*Math.cos(m*(Math.PI/180)),f.append("line").attr("x1",x).attr("y1",A).attr("x2",b).attr("y2",M).attr("stroke",function(){return D+52>m?i[0]:D+208>m?i[1]:i[2]})}var E=(y-40)*Math.sin(P(N)*(Math.PI/180)),G=-(y-40)*Math.cos(P(N)*(Math.PI/180)),Y=P(N);n(),e()}},qe={brushingChartAnalysis:function(e){function n(){var t=d3.scale.linear().domain([0,y.length-1]).range([0,L]),e=d3.svg.area().x(function(e,n){return t(n)}).y0(.08*D).y1(function(t){return Z(t)}).interpolate("cardinal");Z=d3.scale.linear().domain([ne,ee]).range([.08*D,0]);for(var n=(re.append("path").attr("class","spyCloseprice").attr("d",e(M)).attr("fill",w),0),r=0;r<y.length;r++)n<y[r].toString().length&&(n=y[r].toString().length);
var a=d3.svg.axis().scale(t).orient("bottom").tickValues(X.getXTickArray(0,y.length,n,L)),i=re.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+.08*D+")").call(a);i.selectAll("text").text(function(t){return y[t]}).attr("fill","black")}function r(t,e){d3.select(".rectChartGroup").remove(),j=p.append("g").attr("class","rectChartGroup").attr("transform","translate("+S.left+","+(S.top+.55*D)+")"),K=d3.scale.linear().domain([te,Q]).range([.25*D,0]);for(var n=[],r=t;e>=r;r++)n.push(k[r]);var a=j.selectAll(".rect").data(n).enter().append("rect").attr("width",d).attr("height",0).attr("x",function(e,n){return $(n+t)-d/2}).attr("y",function(){return.3*D}).attr("fill",w);a.transition().duration(1e3).attr("height",function(t){return K(te)-K(t)}).attr("y",function(t){return K(t)});var i=d3.svg.axis().scale(K).orient("left").tickValues(X.getTickArray(te,Q,5));j.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(i).selectAll("text").attr("fill","black"),u(p),c(p)}function a(t,e){var n=d3.svg.line().x(function(e,n){return $(n+t)}).y(function(t){return J(t)});J=d3.scale.linear().domain([ne,ee]).range([.45*D,0]);for(var r=[],a=t;e>=a;a++)r.push(M[a]);var i=W.append("path").data([r]).attr("class","line").attr("d",n).attr("stroke",w).attr("stroke-width",1).attr("fill","none"),o=i.node().getTotalLength();i.attr("stroke-dasharray",function(){return o+","+o}).attr("stroke-dashoffset",o).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0);var l=d3.svg.axis().scale(J).orient("left").tickValues(X.getTickArray(ne,ee,6));W.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(l).selectAll("text").attr("fill","black"),u(p),c(p)}function i(t,e){d3.select(".lineChartGroup").remove(),W=p.append("g").attr("class","lineChartGroup").attr("transform","translate("+S.left+","+S.top+")");for(var n=[],r=t;e>=r;r++)n.push(k[r]);d=L/(1.5*n.length),$=d3.scale.linear().domain([t,e]).range([.5*d,L-.5*d]);for(var a=0,i=t;e>=i;i++)a<y[i].toString().length&&(a=y[i].toString().length);var o=d3.svg.axis().scale($).orient("bottom").tickValues(X.getXTickArray(t,e,a,L)),l=W.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+.8*D+")").call(o);l.selectAll("text").text(function(t){return y[t]}).attr("fill","black"),u(p),c(p)}function o(t,e){for(var n=[],r=t;e>=r;r++)n.push(M[r]);ee=O.getMax(n),ne=O.getMin(n)}function l(t,e){for(var n=[],r=t;e>=r;r++)n.push(k[r]);Q=O.getMax(n),te=O.getMin(n)}function s(){{var t=d3.scale.linear().domain([0,y.length-1]).range([0,L]),e=p.append("g").attr("class","brushChartGroup").attr("transform","translate("+S.left+",0)"),n=.06*D;e.append("rect").attr("id","leftRect").attr("x",0).attr("y",S.top+.92*D).attr("width",.5*n).attr("height",.08*D).attr("fill","gray").attr("opacity",.5),e.append("rect").attr("id","rightRect").attr("x",L-.5*n).attr("y",S.top+.92*D).attr("width",.5*n).attr("height",.08*D).attr("fill","gray").attr("opacity",.5),e.append("image").attr("id","leftImage").attr("x",function(){return-2}).attr("y",function(){return S.top+.94*D}).attr("width",n).attr("height",n).attr("xlink:href","img/brush.png").on("mousedown",function(){d3.select(this).on("mousemove",function(){var t=d3.event.pageX;t=t-S.left-N;d3.event.pageY;t<p.select("#rightImage").attr("x")&&t>=0&&(d3.select(this).attr("x",t-15),p.select("#leftRect").attr("width",t))})}).on("mouseup",function(){d3.select(this).on("mousemove",null);var e=p.select("#rightImage").attr("x");e=Math.round(t.invert(e))+1;var n=d3.select(this).attr("x");n=Math.round(t.invert(n)),0>n&&(n=0),i(n,e),o(n,e),l(n,e),a(n,e),r(n,e)}),e.append("image").attr("id","rightImage").attr("x",function(){return L-n+2}).attr("y",function(){return S.top+.94*D}).attr("width",n).attr("height",n).attr("xlink:href","img/brush.png").on("mousedown",function(){d3.select(this).on("mousemove",function(){var t=d3.event.pageX;t=t-S.left-N;d3.event.pageY;t>p.select("#leftImage").attr("x")&&L>t&&(d3.select(this).attr("x",t-15),p.select("#rightRect").attr("x",t).attr("width",L-t))})}).on("mouseup",function(){d3.select(this).on("mousemove",null);var e=p.select("#leftImage").attr("x");e=Math.abs(Math.round(t.invert(e)));var n=d3.select(this).attr("x");n=Math.round(t.invert(n)),i(e,n),o(e,n),l(e,n),a(e,n),r(e,n)})}}var d,h=e.title,y=e.xAxisTickArray,x=e.yAxisLabel1,b=e.yAxisLabel2,A=e.xAxisLabel,M=e.yAxisData1,k=e.yAxisData2,w=e.dataColor,C=e.yAxisUnit,T=B.leftMarginController(M),S={left:T,right:.05*g,bottom:45,top:.075*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},L=g-S.left-S.right,D=v-S.top-S.bottom,N=t(f).offset().left,_=t(f).offset().top;p.on("mousemove",function(){d3.selectAll(".toolTip").remove();var t=d3.event.pageX,e=d3.event.pageY;if(t=t-N-S.left,t>=0&&L-.5*d>=t&&e>=S.top+_&&e<=.85*D+S.top+_){var n=[],r=[],a=[],i=[],o=d3.svg.line().x(function(t,e){return n[e]}).y(function(t,e){return r[e]}),l=d3.svg.line().x(function(t,e){return a[e]}).y(function(t,e){return i[e]});t=Math.round($.invert(t)),e=e-_-S.top;var s=y[t],u=M[t]+" "+C,c=k[t]+" "+C,f=[{headingName:x,headingVal:u},{headingName:b,headingVal:c}];H.showToolTip(d3.event,"",s,!1,f,.9*d3.event.pageY),W.append("line").attr("class","toolTip").attr("x1",0).attr("y1",J(M[t])).attr("x2",L).attr("y2",J(M[t])).attr("stroke","black").attr("opacity",.5),W.append("rect").attr("class","toolTip").attr("x",$(t)-.5*d).attr("y",0).attr("width",d).attr("height",.5*D).attr("fill","red").attr("opacity",.3),j.append("rect").attr("class","toolTip").attr("x",$(t)-.5*d).attr("y",0).attr("width",d).attr("height",.25*D).attr("fill","red").attr("opacity",.3);var h=6.5*y[t].toString().length+10,p=20,g=$(t),v=.82*D;n=[g-.5*h,g-7,g,g+7,g+.5*h,g+.5*h,g-.5*h],r=[v,v,v-7,v,v,v+p,v+p],W.append("path").data([n]).attr("class","toolTip").attr("d",o).attr("stroke","black").attr("stroke-width",1).attr("fill","black"),W.append("text").attr("class","toolTip").attr("x",$(t)-(.5*h-8)).attr("y",.82*D+13).attr("fill","white").style("font-size","10px","important").text(function(){parseInt($.invert(t));return y[t]});var h=T-10,v=J(M[t])-12.5;a=[-h,-10,-10,-3,-10,-10,-h],i=[v,v,v+9,v+12.5,v+16,v+25,v+25],W.append("path").data([n]).attr("class","toolTip").attr("d",l).attr("stroke","black").attr("stroke-width",1).attr("fill","black"),W.append("text").attr("class","toolTip").attr("x",-h+10).attr("y",v+15).attr("fill","white").style("font-size","10px","important").text(M[t]);var m=K(k[t])-12.5;i=[m,m,m+9,m+12.5,m+16,m+25,m+25],j.append("path").data([n]).attr("class","toolTip").attr("d",l).attr("stroke","black").attr("stroke-width",1).attr("fill","black"),j.append("text").attr("class","toolTip").attr("x",-h+10).attr("y",m+15).attr("fill","white").style("font-size","10px","important").text(k[t]),j.append("line").attr("class","toolTip").attr("x1",0).attr("y1",K(k[t])).attr("x2",L).attr("y2",K(k[t])).attr("stroke","black").attr("opacity",.5)}}).on("mouseleave",function(){H.hideTooTip()});var P=p.append("g").attr("class","labelGroup").attr("transform","translate("+S.left+","+S.top+")"),I=7,V=x.toString().length*I,F=.45*D/2+V/2,z=-S.left+15;R.appendLabel(x,z,F,-90,P,m.yLabelColor,600);var V=b.toString().length*I,F=.55*D+(.8*D-.55*D)/2+V/2,z=-S.left+15;R.appendLabel(b,z,F,-90,P,m.yLabelColor,600);var E=A.length*I,G=D+S.bottom-5,Y=L/2-E/2;R.appendLabel(A,Y,G,0,P,m.xLabelColor,600);var I=8,q=g/2-h.length*I/2,U=p.append("g").attr("class","title");R.appendLabel(h,q,.05*v,0,U,m.chartTitleColor,800);var j,W,$,J,Z,K,Q,te,ee,ne,re=p.append("g").attr("class","areaChartGroup").attr("transform","translate("+S.left+","+(S.top+.92*D)+")");i(0,y.length-1),o(0,y.length-1),l(0,y.length-1),r(0,y.length-1),a(0,y.length-1),n(),s(),u(p),c(p)}},Ue={ThreeDComparisionAnalysis:function(e){var n,r=e.yAxisEstimateData,a=e.yAxisActualData,i=e.xAxisData,o=e.yAxisUnit,l=e.yAxisLabel,s=e.xAxisLabel,d=e.title,h=e.yAxisActualDataUnit,y=e.yAxisEstimateDataUnit,x=e.legendArray,b=B.leftMarginController(r),A={left:b,right:.05*g,bottom:45,top:.2*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},M=g-A.left-A.right,k=v-A.top-A.bottom,w=t(f).offset().left,C=M/(1.8*i.length);n=C>60?.3*C:.4*C;for(var T=[],S=[],L=12,D="calibri",N=[],_=0;_<i.length;_++)N[_]=_;var P=p.append("g").attr("class","main-group").attr("transform","translate("+A.left+","+A.top+")"),I=7,V=g/2-d.length*I/2,F=p.append("g").attr("class","title");R.appendLabel(d,V,A.top/2,0,F,m.chartTitleColor,800);var I=7,z=l.toString().length*I,E=k/2+z/2,G=-A.left+15;R.appendLabel(l,G,E,-90,P,m.yLabelColor,600);var q=s.toString().length*I,U=k+(A.bottom-5),j=M/2-q/2;R.appendLabel(s,j,U,0,P,m.xLabelColor,600);for(var W=(parseInt(k/C),d3.scale.linear().domain([0,i.length-1]).range([.8*C,M-.8*C])),$=d3.min(r)<d3.min(a)?r:a,J=O.getMin($),$=d3.max(r)>d3.max(a)?r:a,Z=O.getMax($),K=d3.scale.linear().domain([J,Z]).range([k,0]),Q=0,_=0;_<i.length;_++)Q<i[_].toString().length&&(Q=i[_].toString().length);var te=d3.svg.axis().scale(W).orient("bottom").tickValues(X.getXTickArray(0,i.length,Q,M)),ee=P.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+k+")").call(te);ee.selectAll("text").text(function(t){return i[t]});var ne=X.getTickArray(J,Z,8),re=d3.svg.axis().scale(K).orient("left").tickValues(ne);P.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(re).selectAll("text").style("font-size",L).style("font-family",D).attr("fill","black");for(var ae,ie=d3.svg.line().x(function(t){return t}).y(function(t,e){return S[e]}),oe=d3.svg.line().x(function(t){return t}).y(function(){return k}),le=0;le<ne.length;le++){T[0]=0,S[0]=K(ne[le]),T[1]=n,S[1]=K(ne[le])-20,T[2]=M,S[2]=S[1],ae=P.selectAll(".path").data([T]).enter().append("path").attr("d",ie).attr("fill","none").attr("stroke","gray");var se=ae.node().getTotalLength();ae.attr("stroke-dasharray",function(){return se+","+se}).attr("stroke-dashoffset",se).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var _=0;_<r.length;_++)T[0]=W(_)-.55*C,S[0]=K(J)-n,T[1]=T[0],S[1]=K(r[_])+n,T[2]=T[1]+C,S[2]=S[1],T[3]=T[2],S[3]=S[0],ae=P.selectAll(".path").data([T]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#f6cd03"),ae.transition().duration(2e3).ease("elastic").attr("d",ie),T[0]=W(_)-.55*C,S[0]=K(r[_])+n,T[1]=T[0]+.25*C,S[1]=S[0]-n,T[2]=T[1]+C,S[2]=S[1],T[3]=T[0]+C,S[3]=S[0],ae=P.selectAll(".path").data([T]).enter().append("path").attr("d",oe).attr("class","pathClass").attr("fill","#f9f303"),ae.transition().duration(2e3).ease("elastic").attr("d",ie),T[0]=T[3],S[0]=K(J)-n,T[1]=T[3]+.25*C,S[1]=K(J)-2*n,ae=P.selectAll(".path").data([T]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#c9a703"),ae.transition().duration(2e3).ease("elastic").attr("d",ie);for(var _=0;_<a.length;_++)T[0]=W(_)-.8*C,S[0]=K(a[_])+n,T[1]=T[0]+.25*C,S[1]=S[0]-n,T[2]=T[1]+C,S[2]=S[1],T[3]=T[0]+C,S[3]=S[0],ae=P.selectAll(".path").data([T]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#fa7600"),ae.transition().duration(2e3).ease("elastic").attr("d",ie),T[0]=T[3],S[0]=K(J),T[1]=T[3]+.25*C,S[1]=K(J)-n,ae=P.selectAll(".path").data([T]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#cc5200"),ae.transition().duration(2e3).ease("elastic").attr("d",ie),T[0]=W(_)-.8*C,S[0]=K(J),T[1]=T[0],S[1]=K(a[_])+n,T[2]=T[1]+C,S[2]=S[1],T[3]=T[2],S[3]=S[0],ae=P.selectAll(".path").data([T]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#fa6400"),ae.transition().duration(2e3).ease("elastic").attr("d",ie);d3.selectAll(".pathClass").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=w+A.left,t=Math.round(W.invert(t));var e=i[t],n=r[t]+" "+o,s=a[t]+" "+o,u=[{headingName:y+" "+l,headingVal:n},{headingName:h+" "+l,headingVal:s}];H.showToolTip(d3.event,"",e,!1,u,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()});{var ue=10,ce=-5,de=Y.showHorizontalLegend(M,ce,x,ue,ue),fe=p.append("g").attr("class","legend").attr("transform","translate("+A.left+","+A.top+")");fe.selectAll(".rect").data(de).enter().append("rect").attr("width",ue).attr("height",ue).attr("x",function(t,e){return de[e].x}).attr("y",function(t,e){return de[e].y}).attr("fill",function(t,e){return 0==e?"#f6cd03":"#fa6400"}),fe.selectAll(".text").data(de).enter().append("text").attr("x",function(t,e){return de[e].textXPos}).attr("y",function(t,e){return de[e].y+ue}).style("font-family","calibri").text(function(t,e){return x[e]})}u(p),c(p)}},je={detailAnalysis:function(e){for(var n=e.data.leftYAxisData,r=e.data.rightYAxisData,a=e.data.xAxisData,i=e.data.topYSymbolArray,o=e.data.bottomYSymbolArray,l=e.data.title,s=(e.data.titleColor,e.data.titleSize,e.data.rightYAxisLabel),d=e.data.leftYAxisLabel,h=e.data.xAxisLabel,y=e.data.leftYAxisColor,x=e.data.rightYAxisColor,b=B.leftMarginController(n),A=B.leftMarginController(r),M={left:b,right:A,bottom:45,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},k=g-M.left-M.right,w=v-M.top-M.bottom,C=e.data.imageFolderPath,T=e.data.bottomYSymbolLabel,S=e.data.leftYAxisUnit,L=e.data.rightYAxisUnit,D=[],N=0;N<a.length;N++)D[N]=N;W.init(p,w,k,M.left,M.top,m.gridLineColor);var _=t(f).offset().left,P=p.append("g").attr("class","scoredMainGroup").attr("transform","translate("+M.left+","+M.top+")"),I=7.5,V=g/2-l.length*I/2,F=p.append("g").attr("class","title");R.appendLabel(l,V,M.top,0,F,m.chartTitleColor,800);var I=6,z=s.toString().length*I,E=w/2-z/2,G=k+A-15;R.appendLabel(s,G,E,90,P,m.yLabelColor,600);var z=d.toString().length*I,Y=w/2+z/2,q=-M.left+15;R.appendLabel(d,q,Y,-90,P,m.yLabelColor,600);var U=h.toString().length*I,j=w+(M.bottom-5),$=k/2-U/2;R.appendLabel(h,$,j,0,P,m.xLabelColor,600);for(var J=O.getMin(n),Z=O.getMax(n),K=d3.scale.linear().domain([J,Z]).range([w,0]),Q=d3.svg.axis().scale(K).orient("left"),te=(P.append("g").attr("class","y axis").attr("transform","translate(-5,0)").attr("fill","none").call(Q).selectAll("text").style("fill",y,"important"),O.getMin(r)),ee=O.getMax(r),ne=d3.scale.linear().domain([te,ee]).range([w,0]),re=d3.svg.axis().scale(ne).orient("left"),D=(P.append("g").attr("class","y axis").attr("transform","translate("+(k+A-20)+",0)").attr("fill","none").call(re).selectAll("text").style("fill",x,"important"),[]),N=0;N<a.length;N++)D[N]=N;for(var ae=d3.scale.linear().domain([0,a.length-1]).range([0,k]),ie=0,N=0;N<a.length;N++)ie<a[N].toString().length&&(ie=a[N].toString().length);var oe=d3.svg.axis().scale(ae).orient("bottom").tickValues(X.getXTickArray(0,a.length,ie,k)),le=(P.append("g").attr("class","x axis").attr("transform","translate(0,"+w+")").attr("fill","none").call(oe).selectAll("text").text(function(t){return a[t]}).attr("fill","black"),k/(2*o.length)),se=P.selectAll("img").data(o).enter().append("image").attr("class","detailChartObj").attr("x",function(){return 0}).attr("y",function(){return w-le}).attr("width",le).attr("height",le).attr("xlink:href",function(t){return C+""+t+".png"});se.transition().duration(2500).attr("x",function(t,e){return ae(D[e])-le/2});var ue=d3.svg.line().x(function(t,e){return ae(D[e])}).y(function(t,e){return ne(r[e])}).interpolate("cardinal"),ce=k/(2*i.length),de=P.selectAll(".path").data([r]).enter().append("path").attr("d",ue).attr("class","detailChartObj").attr("stroke",x).attr("stroke-width",1).attr("fill","none"),fe=de.node().getTotalLength();de.attr("stroke-dasharray",function(){return fe+","+fe}).attr("stroke-dashoffset",fe).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var he=P.selectAll("img").data(i).enter().append("image").attr("class","detailChartObj").attr("x",function(){return 0}).attr("y",function(){return 0}).attr("width",ce).attr("height",ce).attr("xlink:href",function(t){return C+""+t+".png"});he.transition().duration(2500).attr("x",function(t,e){return ae(D[e])-ce/2}).attr("y",function(t,e){return ne(r[e])-(ce+5)});var pe=d3.svg.line().x(function(t,e){return ae(D[e])}).y(function(t,e){return K(n[e])}).interpolate("cardinal"),ge=P.selectAll(".path").data([n]).enter().append("path").attr("d",pe).attr("class","detailChartObj").attr("stroke",y).attr("stroke-width",1).attr("fill","none"),ve=ge.node().getTotalLength();ge.attr("stroke-dasharray",function(){for(var t=3,e=2*t,n=t;ve>e;)n+=","+t+","+t,e+=2*t;return n+","+ve}).attr("stroke-dashoffset",ve).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0),p.selectAll(".detailChartObj").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=_+M.left,t=Math.round(ae.invert(t));var e=o[t],a=i[t],l=S,s=n[t],u=L,c=r[t],d=[{headingName:T,headingVal:e},{headingName:l,headingVal:s},{headingName:u,headingVal:c}];H.showToolTip(d3.event,"",a,!1,d,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}),u(p),c(p)}},He={threeDBubbleChart:function(t){function e(t){for(var e=0;e<t.length;e++){for(var n=[],r=0;r<t[e].data.length;r++){var a=t[e].data[r];n.push(JSON.parse('{"x":'+a[0]+',"y":'+a[1]+',"r":'+a[2]+"}"))}y.push(n)}return y}function n(t){var e=I(t);return.008*f>e&&(e=.008*f),e>.04*f&&(e=.04*f),e}function r(){return d3.svg.axis().scale(V).orient("bottom").ticks(10)}function a(){return d3.svg.axis().scale(F).orient("left").ticks(10)}var i=t.data.title,o=(t.data.titleColor,t.data.yAxisData,t.data.yAxisLabel),l=(t.data.xAxisData,t.data.xAxisLabel),s=t.data.series,d=t.data.legendArray;501>g?(titleFontSize=18,gridFactor=8,fontSize=11,rectangleSize=9,rectangleTextSize=9):(titleFontSize=20,gridFactor=12,fontSize=14,rectangleSize=10,rectangleTextSize=10);for(var f=v>g?g:v,h={top:.15*v,right:.15*g,bottom:.15*v,left:.15*g},y=[],x=e(s),b=d3.min(x[0],function(t){return t.x}),A=d3.max(x[0],function(t){return t.x}),M=d3.min(x[0],function(t){return t.y}),k=d3.max(x[0],function(t){return t.y}),w=d3.max(x[0],function(t){return t.r}),C=d3.min(x[0],function(t){return t.r}),T=0,S=0,L=0,D=0,N=0,_=0,P=1;P<x.length;P++)T=d3.max(x[P],function(t){return t.r}),S=d3.min(x[P],function(t){return t.r}),D=d3.max(x[P],function(t){return t.x}),L=d3.min(x[P],function(t){return t.x}),_=d3.max(x[P],function(t){return t.y}),N=d3.min(x[P],function(t){return t.y}),T>w&&(w=T),C>S&&(C=S),D>A&&(A=D),b>L&&(b=L),_>k&&(k=_),M>N&&(M=N);var I=d3.scale.linear().domain([0,w]).range([0,.1*f]),V=d3.scale.linear().range([h.left,g-h.right]).domain([0,1.1*A]),F=d3.scale.linear().range([v-h.top,h.bottom]).domain([M,1.2*k]),z=d3.svg.axis().scale(V).orient("bottom"),E=d3.svg.axis().scale(F).orient("left"),G=p.append("g").attr("class","bubble-main-group").attr("transform","translate(0,0)"),O=8,B=g/2-i.length*O/2,X=p.append("g").attr("class","title");R.appendLabel(i,B,h.top/2,0,X,m.chartTitleColor,800);var O=6,q=l.toString().length*O,U=v-h.top+.15*(v-h.top),j=(g-h.right)/2-q/2;R.appendLabel(l,j,U,0,G,m.xLabelColor,600);var W=o.toString().length*O,$=v/2+W/2,J=h.left/3;R.appendLabel(o,J,$,-90,G,m.yLabelColor,600);for(var Z=t.data.colorArray,K=0;K<x.length;K++){G.selectAll("circle.s"+K).data(x[K]).enter().insert("circle").attr("cx",function(t){return V(t.x)}).attr("cy",function(t){return F(t.y)}).attr("r",function(t){return n(t.r)}).on("mousemove",function(t){var e=[{headingName:o,headingVal:t.y}];H.showToolTip(d3.event,"",l+" "+t.x,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){H.hideTooTip()}).transition().duration(1e3).attr("opacity",.3).attr("class","s"+K).attr("fill",function(){return"url(#gradient"+K+")"});var Q=G.append("svg:defs").append("svg:linearGradient").attr("id","gradient"+K).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");Q.append("svg:stop").attr("offset","0%").attr("stop-color",Z[K]).attr("stop-opacity",1),Q.append("svg:stop").attr("offset","100%").attr("stop-color",Z[K]+1e3).attr("stop-opacity",1)}G.append("g").attr("class","xGrid").attr("transform","translate(0,"+(g-h.bottom)+")").call(r().tickSize(-g+h.bottom,0,0).tickFormat("")).attr("opacity","0.3"),G.append("g").attr("class","yGrid").attr("transform","translate("+h.left+",0)").call(a().tickSize(-v+2*h.bottom,0,0).tickFormat("")).attr("opacity","0.3"),G.append("svg:g").attr("class","xAxis axis").transition().call(z).attr("transform","translate(0,"+(f-.9*h.bottom)+")").attr("fill","black"),G.append("svg:g").attr("class","yAxis axis").transition().call(E).attr("transform","translate("+.9*h.left+",0)").attr("fill","black"),p.selectAll(".yAxis path").attr("fill","none"),p.selectAll(".xAxis path").attr("fill","none"),p.selectAll(".xGrid").attr("stroke","lightgrey"),p.selectAll(".yGrid").attr("stroke","lightgrey"),p.selectAll(".xGrid ").attr("opacity",.5),p.selectAll(".yGrid ").attr("opacity",.5),p.selectAll(".xGrid .tick").attr("stroke-width",0),p.selectAll(".yGrid .tick").attr("stroke-width",0);for(var te=v-h.top,ee=g-h.right,ne=G.append("g").attr("class","legend").attr("transform","translate("+.9*h.left+","+.13*te+")"),re=12,ae=12,ie=Y.getLegendPositionArray(d,ee,te),oe=0;oe<ie.length;oe++)console.log("x "+ie[oe].x+" y "+ie[oe].y+" end "+ie[oe].endPos);ne.selectAll("rect.legendRect").data(d).enter().append("rect").attr("class","legendRect").attr("x",function(t,e){return ie[e].x}).attr("y",function(t,e){return ie[e].y}).attr("width",re).attr("height",ae).style("fill",function(t,e){return"url(#gradient"+e+")"}).attr("opacity",.3),newXCord=0,ne.selectAll("text").data(d).enter().append("text").attr("x",function(t,e){return ie[e].textPos}).attr("y",function(t,e){return ie[e].y+ae}).attr("width",re).attr("height",ae).attr("font-size",12).text(function(t){return t}),u(p),c(p)}};return{drawLine:$.drawLine,drawBarWithMultipleLineAndCircle:$.drawBarWithMultipleLineAndCircle,squareChart:K.squareChart,areaChart:ge.areaChart,circleChart:Q.circleChart,pieChart:te.pieChart,gaugeGraph:he.gaugeGraph,drawYAxis:E.drawYAxis,drawMulitpleLineChartWithSquare:E.drawMulitpleLineChartWithSquare,setYSclae:Z.setYSclae,drawPyramidChart:ee.drawPyramidChart,draw3DPyramidChartWithoutSlice:ee.draw3DPyramidChartWithoutSlice,draw3DPyramidSliceChart:ee.draw3DPyramidSliceChart,drawRadarChart:ne.drawRadarChart,drawDrillDownChart:ae.drawDrillDownChart,drawPieChartWithTransition:oe.drawPieChartWithTransition,dountChartWithLegend:oe.dountChartWithLegend,drawDountWithBarChart:oe.drawDountWithBarChart,newDountChartWithBarAnalysis:oe.newDountChartWithBarAnalysis,multipleDountChartAnalysis:oe.multipleDountChartAnalysis,drawHeatMapChart:le.drawHeatMapChart,groupedBarChart:Z.groupedBarChart,groupedBar2DChart:Z.groupedBar2DChart,bulletBar:Z.bulletBar,cricketAnalysis:Z.cricketAnalysis,barWithLogo:Z.barWithLogo,drawScatterPlotChart:se.drawScatterPlotChart,drawBasicLineChart:ce.drawBasicLineChart,drawThreeDBarChart:ue.drawThreeDBarChart,drawStackedAreaChart:de.drawStackedAreaChart,stackedBarChart:Z.stackedBarChart,drawFunnelChart:fe.drawFunnelChart,areaChart:ge.areaChart,meterChart:ve.meterChart,turnNeedle:ve.turnNeedle,drawCombinationalChart:re.drawCombinationalChart,drawThreeDStackedBarChart:ye.drawThreeDStackedBarChart,variationAnalysis:ie.variationAnalysis,areaChartWithNegativeValueAnalysis:be.areaChartWithNegativeValueAnalysis,areaChartWithVaryColorAnalysis:Ae.areaChartWithVaryColorAnalysis,musicSpikesAnalysis:ke.musicSpikesAnalysis,comparisonAnalysis:Me.comparisonAnalysis,drawThreeDGroupedBarChart:we.drawThreeDGroupedBarChart,globChartAnalysis:me.globChartAnalysis,detailAnalysis:je.detailAnalysis,threeDBubbleChart:He.threeDBubbleChart,treeChart:xe.treeChart,barWithLabelAnalysis:Ce.barWithLabelAnalysis,logoChart:Te.logoChart,multiAxisChartAnalysis:Se.multiAxisChartAnalysis,roundedThreeDBarAnalysis:Re.roundedThreeDBarAnalysis,threeDDountChartAnalysis:Ye.threeDDountChartAnalysis,threeDPieChartAnalysis:Le.threeDPieChartAnalysis,arcWithCylinderChartAnalysis:Oe.arcWithCylinderChartAnalysis,ThreeDComparisionAnalysis:Ue.ThreeDComparisionAnalysis,brushingChartAnalysis:qe.brushingChartAnalysis,angularMeterChartAnalysis:Xe.angularMeterChartAnalysis,comparisionAreaChartAnalysis:Be.comparisionAreaChartAnalysis,threeDPieChartWithLegendAnalysis:De.threeDPieChartWithLegendAnalysis,threeDDountChartWithLegendAnalysis:Ne.threeDDountChartWithLegendAnalysis,dountChartWithMappingAnalysis:Ge.dountChartWithMappingAnalysis,smoothLineChartAnalysis:Ve.smoothLineChartAnalysis,activeAreaChartAnalysis:Ie.activeAreaChartAnalysis,treeMapChartAnalysis:Pe.treeMapChartAnalysis,drillDownDountChartAnalysis:_e.drillDownDountChartAnalysis,LineChartWithReverseYAxisAnalysis:Fe.LineChartWithReverseYAxisAnalysis,performanceChartAnalysis:Ee.performanceChartAnalysis,horizontalStackedBarChartAnalysis:ze.horizontalStackedBarChartAnalysis}}}(jQuery);var meterChart={image:"",needle:"",plot:"",arc:"",prevdata:90,text:"",init:function(t){var e=d3.select("#"+t).style("width"),n=d3.select("#"+t).style("height");e=parseInt(e.replace("px","")),n=parseInt(n.replace("px",""));var r=d3.select("#"+t).append("svg").attr("width",e).attr("height",n).append("g").attr("transform","translate("+(e/2-160)+",0)");this.arc=d3.svg.arc().innerRadius(30).outerRadius(120).startAngle(120*(Math.PI/180)).endAngle(240*(Math.PI/180));r.append("g").attr("class","arc");this.image=r.append("svg:image").attr("x",20).attr("y",0).attr("width",280).attr("height",250).attr("xlink:href","http://stocinn.github.io/stocweb/img/gauge_skin.jpg").attr("id","fillImage"),this.text=r.append("svg:text").attr("transform","translate(165,220)").attr("text-anchor","middle").text(""),this.needle=r.append("g").attr("class","needle").attr("transform","translate( 20 , 70)").append("path").attr("class","tri").attr("d","M152 130 L150 0 L147 130 C147 140 153 140 153 130 Z").attr("transform","rotate(-90, 150,130)")},turnNeedle:function(t){function e(){return d3.interpolateString("rotate("+n+", 150, 130)","rotate("+r+", 150, 130)")}0>t?meterChart.text.transition().attr("fill","red").text(t):meterChart.text.transition().attr("fill","green").text(t),this.needle.transition().duration(1e3).attrTween("transform",e);var n=this.getAngleFromCoordinate(meterChart.getCoordinateFromData(meterChart.prevdata)),r=this.getAngleFromCoordinate(meterChart.getCoordinateFromData(meterChart.getPercentFromAngle(meterChart.getAngleForProfitAndLoss(t))))},getPercentFromAngle:function(t){return 0>t&&t>=-180?-(5*t/9):5*t/9},getAngleFromCoordinate:function(t){var e=0,n=90;return e+=n*t},getCoordinateFromData:function(t){return coordinate=t/100-(1-t/100),coordinate},getRadianFromData:function(t){return coordinate=t/57.2958,coordinate},callTurnNeedle:function(){var t=100*Math.random();meterChart.turnNeedle(t),meterChart.prevdata=t},getAngleForProfitAndLoss:function(t){var e;return e=t>0&&100>=t?90+.9*t:90+.9*t}};StockMarketChartManager={xScaleHistoricChart:"",data:"",cmfConfigurations:"",lineChartConfiguration:"",powerGauageChartConfiguration:"",selectorContainerId:"",chartHeightMap:{},margin:{top:10,left:20,right:20,bottom:10},scalableLimit:2,areaSubsetArray:[],area:"",textLabelDx:50,dateArray:[],chartStyleMap:{hlcChart:"block",cmfChart:"block",powerGaugeChart:"block"},drawStockMarketCharts:function(t,e,n,r,a,i){StockMarketChartManager.selectorContainerId=t,StockMarketChartManager.emptyCharts(),StockMarketChartManager.getHeightOfEachChart(),StockMarketChartManager.cmfConfigurations=n,StockMarketChartManager.lineChartConfiguration=r,StockMarketChartManager.powerGauageChartConfiguration=a,StockMarketChartManager.data=e,StockMarketChartManager.dateArray=i,StockMarketChartManager.drawHLCChart(r),StockMarketChartManager.drawCmfChart(n),StockMarketChartManager.drawPowerGauageChart(a),StockMarketChartManager.drawTimeScale(i),StockMarketChartManager.attachHoveringEffect(),StockMarketChartManager.listenWindowResize(),StockMarketChartManager.appendToolTip()},listenWindowResize:function(){$(window).resize(function(){StockMarketChartManager.updateChartOnResize()})},attachHoveringEffect:function(){var t=StockMarketChartManager.selectorContainerId,e=StockMarketChartManager.margin,n=StockMarketChartManager.dateArray,r=StockMarketChartManager.lineChartConfiguration.data,a=StockMarketChartManager.cmfConfigurations.data,i=StockMarketChartManager.powerGauageChartConfiguration.data,o=StockMarketChartManager.lineChartConfiguration.highFieldName,l=StockMarketChartManager.lineChartConfiguration.closeFieldName,s=StockMarketChartManager.lineChartConfiguration.lowFieldName,u=StockMarketChartManager.cmfConfigurations.fieldName,c=StockMarketChartManager.powerGauageChartConfiguration.pgrFieldName;d3.select("#"+t).on("mousemove",function(){console.log("mousemove ");var d=StockMarketChartManager.xScaleHistoricChart,f=(e.left-.08*e.left,d3.event.pageX-$("#"+t).offset().left),h=Math.round(d.invert(f));if(0>h||h>n.length-1)d3.select("#"+t).selectAll(".drag-line").style("display","none"),StockMarketChartManager.hideToolTip();else{d3.select("#"+t).selectAll(".drag-line").attr("x1",d(h)).attr("x2",d(h));var p=r[h][o],g=r[h][l],v=r[h][s],y=a[h][u],m=i[h][c];console.log(p+" :: ::"+g+" :: "+v+":: "+y+" :: "+m+" :: "+n[h]);var x=[{headingName:l,headingVal:g},{headingName:o,headingVal:p},{headingName:s,headingVal:v},{headingName:u,headingVal:y},{headingName:c,headingVal:m}];StockMarketChartManager.showToolTip(d3.event,"",n[h],!1,x,""),d3.select("#"+t).selectAll(".drag-line").style("display","block")}}).on("mouseleave",function(){StockMarketChartManager.hideToolTip(),d3.select("#"+t).selectAll(".drag-line").style("display","none")})},updateChartOnResize:function(){var t=StockMarketChartManager.cmfConfigurations,e=StockMarketChartManager.lineChartConfiguration,n=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts();var r=StockMarketChartManager.chartStyleMap.hlcChart,a=StockMarketChartManager.chartStyleMap.cmfChart,i=StockMarketChartManager.chartStyleMap.powerGaugeChart;StockMarketChartManager.getHeightOfEachChart(),"block"==r&&StockMarketChartManager.drawHLCChart(e),"block"==a&&StockMarketChartManager.drawCmfChart(t),"block"==i&&StockMarketChartManager.drawPowerGauageChart(n);var o=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(o)},updateChartWithData:function(t){var e=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.cmfConfigurations,r=StockMarketChartManager.lineChartConfiguration,a=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.drawStockMarketCharts(e,t,n,r,a)},hideChart:function(t){var e=(StockMarketChartManager.selectorContainerId,StockMarketChartManager.cmfConfigurations),n=StockMarketChartManager.lineChartConfiguration,r=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts(),StockMarketChartManager.chartStyleMap[t]="none";var a=StockMarketChartManager.chartStyleMap.hlcChart,i=StockMarketChartManager.chartStyleMap.cmfChart,o=StockMarketChartManager.chartStyleMap.powerGaugeChart;StockMarketChartManager.getHeightOfEachChart(),"block"==a&&StockMarketChartManager.drawHLCChart(n),"block"==i&&StockMarketChartManager.drawCmfChart(e),"block"==o&&StockMarketChartManager.drawPowerGauageChart(r);var l=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(l)},showChart:function(t){StockMarketChartManager.selectorContainerId;StockMarketChartManager.chartStyleMap[t]="block";var e=StockMarketChartManager.chartStyleMap.hlcChart,n=StockMarketChartManager.chartStyleMap.cmfChart,r=StockMarketChartManager.chartStyleMap.powerGaugeChart,a=StockMarketChartManager.cmfConfigurations,i=StockMarketChartManager.lineChartConfiguration,o=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts(),StockMarketChartManager.getHeightOfEachChart(),"block"==e&&StockMarketChartManager.drawHLCChart(i),"block"==n&&StockMarketChartManager.drawCmfChart(a),"block"==r&&StockMarketChartManager.drawPowerGauageChart(o);var l=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(l)},attachPanningAndZooming:function(t,e){function n(){var t=r.translate(),e=t[0],n=t[1];
e=Math.min(e,0),e=Math.max(e,i-a*i),r.translate([e,n]);d3.selectAll(".money-flow-area ").data([StockMarketChartManager.areaSubsetArray]).attr("d",function(t){return StockMarketChartManager.area(t)})}var r=d3.behavior.zoom().x(t).scaleExtent([1,8]).on("zoom",n);d3.select("#"+e).call(r);var a=StockMarketChartManager.scalableLimit,i=d3.select("#"+e).style("width").replace("px","")},emptyCharts:function(){var t=StockMarketChartManager.selectorContainerId;document.getElementById(""+t).innerHTML=""},getHeightOfEachChart:function(){var t=StockMarketChartManager.selectorContainerId,e=d3.select("#"+t).style("height");e=parseInt(e.replace("px",""));var n={cmf:"",hlc:"",powergauage:""},r=StockMarketChartManager.chartStyleMap.cmfChart,a=StockMarketChartManager.chartStyleMap.hlcChart,i=StockMarketChartManager.chartStyleMap.powerGaugeChart,o=e/2,l=e;"block"==i&&(l-=o/3),"block"==r&&(l-=o/1.5);var s=e;"block"==i&&(s-=o/3),"block"==a&&(s-=o);var u=o/6;n.cmf=s,n.hlc=l,n.powergauage=u,StockMarketChartManager.chartHeightMap=n},generateXScale:function(){var t=d3.min(dateArray.map(function(t){return parseDate.parse(t)})),e=d3.max(dateArray.map(function(t){return parseDate.parse(t)}));xScaleHistoricChart=d3.time.scale().range([0,historicalChartWidth*scalableLimit]).domain([t,e])},drawCmfChart:function(t){function e(t){return t>x?1:x>t?-1:0}var n=StockMarketChartManager.selectorContainerId,r=StockMarketChartManager.margin,a=(StockMarketChartManager.scalableLimit,t.data),i=t.fieldName,o=StockMarketChartManager.chartHeightMap,l=d3.select("#"+n).style("width"),s=o.cmf;l=parseInt(l.replace("px",""));var u=l-r.left-r.right,c=s-r.top-r.bottom,d=d3.select("#"+n).append("svg:svg").attr("class","cmfChart").attr("id","cmfChart").attr("width",l).attr("height",s),f=(d.append("defs").append("svg:clipPath").attr("id","clip1").append("svg:rect").attr("id","clip-rect").attr("x","0").attr("y","0").attr("width",l).attr("height",s),d.append("g").attr("clip-path","url(#clip1)"));if(void 0!=a&&0!=a.length){for(var h=0;h<a.length;h++){var p=a[h];for(var g in p)(isNaN(p[g])||null==p[g])&&(p[g]="N/A");a[h]=p}for(var v=new Array,h=0;h<a.length;h++)"N/A"!=a[h][i]&&v.push(a[h][i]);v.sort(function(t,e){return t>e?1:e>t?-1:0});var y=v[0],m=v[v.length-1],x=0,b=d3.scale.linear().domain([y,m]).range([c-r.bottom,r.top]),A=d3.scale.linear().domain([d3.min(a.map(function(t){return t.timeIndex})),d3.max(a.map(function(t){return t.timeIndex}))]).range([r.left,u]);StockMarketChartManager.xScaleHistoricChart=A;var M=StockMarketChartManager.textLabelDx;f.append("line").attr("class","divider").attr("x1",A(a[0].timeIndex)).attr("y1",b(x)).attr("x2",A(a[a.length-1].timeIndex)).attr("y2",b(x)),f.append("text").attr("class","yrule").attr("x",u-r.right+M).attr("y",b(x)).attr("dy",0).attr("dx","-1.2em").attr("text-anchor","end").text(parseFloat(x).toFixed(2)).style("color","#FFFFFF").attr("fill","white");var k=[0];$(a).each(function(t,n){t>0&&(isNaN(a[t-1][i])||isNaN(n[i])?k.push(t):e(a[t-1][i])!=e(n[i])&&0!=n[i]&&k.push(t))}),k.push(a.length-1);var w,C=a[0][i]>x;$(k).each(function(t,e){var n;if(t!=k.length-1){var r=k[t+1];n=a.slice(e,r),void 0!=w&&n.unshift({timeIndex:w,MoneyFlow:x}),w=Math.round((a[r-1].timeIndex+a[r].timeIndex)/2);var o;o=r!=e&&r!=a.length-1?x:"N/A"==a[r][i]?x:a[r][i],n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:o}),a[a.length-1][i]>0&&a[a.length-2][i]<0&&r==a.length-1&&r!=e?(n.splice(-1,1),n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:x})):a[a.length-1][i]<0&&a[a.length-2][i]>0&&r==a.length-1&&r!=e?(n.splice(-1,1),n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:x})):r!=e&&r==a.length-1&&n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:x}),C="N/A"==a[e].cmfFieldName?a[r][i]>=x:a[e][i]>=x;var l=d3.svg.area().x(function(t){return A(t.timeIndex)}).y0(b(x)).y1(function(t){return"N/A"!=t[i]?b(void 0!=t[i]?t[i]:x):(console.log("0 "+b(x)),b(x))}).interpolate("basis");$(n).each(function(t,e){void 0===e[i]&&(e[i]="N/A"),StockMarketChartManager.areaSubsetArray.push(e)}),f.append("path").datum(n).attr("class","money-flow-area "+(C?"positive":"negative")).attr("fill",function(){return C?"green":"red"}).attr("d",l(n))}}),d.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",s).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")}},drawHLCChart:function(t){for(var e=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.margin,r=(StockMarketChartManager.scalableLimit,t.data),a=t.highFieldName,i=t.closeFieldName,o=t.lowFieldName,l=t.HighBand,s=t.LowBand,u=t.Band,c=t.Trend,d=StockMarketChartManager.chartHeightMap,f=0;f<r.length;f++){var h=r[f];for(var p in h)(isNaN(h[p])||null==h[p])&&(h[p]="N/A");r[f]=h}var g=d3.select("#"+e).style("width"),v=d.hlc;g=parseInt(g.replace("px",""));var y=g-n.left-n.right,m=v-n.top-n.bottom,x=d3.select("#"+e).append("svg:svg").attr("class","hlcChart").attr("id","hlcChart").attr("width",g).attr("height",v),b=getMinRange(r),A=getMaxRange(r),M=d3.scale.linear().domain([b,A]).range([m-n.bottom,n.top]),k=d3.scale.linear().domain([d3.min(r.map(function(t){return t.timeIndex})),d3.max(r.map(function(t){return t.timeIndex}))]).range([n.left,y]);StockMarketChartManager.xScaleHistoricChart=k;var w=StockMarketChartManager.textLabelDx;x.selectAll("text.yrule").data(M.ticks(10)).enter().append("svg:text").attr("class","yrule").attr("x",y-n.right+w).attr("y",M).attr("dy",0).attr("dx",0).attr("text-anchor","end").style("color","#FFFFFF").style("font-size","12px").attr("fill","#FFFFFF").append("tspan").text(function(t){return new Number(t).toFixed(2)+""}),x.selectAll("line.close").data(r).enter().append("svg:line").attr("class","close").attr("x1",function(t){return k(t.timeIndex)+.25*y/r.length-.5}).attr("y1",function(t){return"N/A"!=t[i]?M(t[i]):($(this).select("line.close").attr("class","NA"),M(0))}).attr("x2",function(t){return k(t.timeIndex)+.25*(y-(n.left+n.right))/r.length+2}).attr("y2",function(t){return"N/A"!=t[i]?M(t[i]):($(this).select("line.close").attr("class","NA"),M(0))}).style("stroke","#15c515").attr("stroke-width","1px"),x.selectAll("line.stem").data(r).enter().append("svg:line").attr("class","stem").attr("x1",function(t){return k(t.timeIndex)+.25*(y-(n.left+n.right))/r.length}).attr("x2",function(t){return k(t.timeIndex)+.25*(y-(n.left+n.right))/r.length}).attr("y1",function(t){return"N/A"!=t[a]?M(t[a]):($(this).select("line.stem").attr("class","NA"),M(0))}).attr("y2",function(t){return"N/A"!=t[o]?M(t[o]):($(this).select("line.stem").attr("class","NA"),M(0))}).attr("stroke","#15c515").attr("stroke-width","1px");var C=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[l])}).interpolate("linear").defined(function(t){return 0!=t[l]}).defined(function(t){return"N/A"!=t[l]&&0!=t[l]}),T=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[s])}).interpolate("linear").defined(function(t){return 0!=t[s]}).defined(function(t){return"N/A"!=t[s]&&0!=t[s]}),S=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[u])}).interpolate("linear").defined(function(t){return 0!=t[u]}).defined(function(t){return"N/A"!=t[u]&&0!=t[u]}),L=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[c])}).interpolate("linear").defined(function(t){return 0!=t[c]&&"N/A"!=t[c]});x.selectAll("path.high-band").data([r]).enter().append("path").attr("class","high-band band").style("stroke-dasharray","1, 4").attr("d",C).attr("stroke-width",2).attr("fill","none").attr("stroke-dasharray","1px, 4px").attr("stroke","#fcfcfc"),x.selectAll("path.low-band").data([r]).enter().append("path").attr("class","low-band band").style("stroke-dasharray","1, 4").attr("d",T).attr("stroke-width",2).attr("fill","none").attr("stroke-dasharray","1px, 4px").attr("stroke","#fcfcfc"),x.selectAll("path.mid-band").data([r]).enter().append("path").attr("class","band mid-band").style("stroke-dasharray","1, 4").attr("d",S).attr("stroke-width",1).attr("fill","none").attr("stroke","#fcfcfc"),x.selectAll("path.trend").data([r]).enter().append("path").attr("class","trend").attr("d",L).attr("fill","none").attr("stroke","#e38502").attr("stroke-width","1px"),x.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",v).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},drawPowerGauageChart:function(t){for(var e=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.margin,r=(StockMarketChartManager.scalableLimit,t.data),a=t.pgrFieldName,i=t.pgrColorMap,o=StockMarketChartManager.chartHeightMap,l=0;l<r.length;l++){var s=r[l];for(var u in s)(isNaN(s[u])||null==s[u])&&(s[u]="N/A");r[l]=s}var c=d3.select("#"+e).style("width"),d=o.powergauage;c=parseInt(c.replace("px",""));var f=c-n.left-n.right,h=d-n.top-n.bottom,p=d3.select("#"+e).append("svg:svg").attr("class","power-gauage").attr("id","power-gauage").attr("width",c).attr("height",d),g=d3.max(r.map(function(t){return t.powerGauageFieldName})),v=d3.min(r.map(function(t){return t.powerGauageFieldName})),y=(d3.scale.linear().domain([v,g]).range([h-n.bottom,n.top]),d3.scale.linear().domain([d3.min(r.map(function(t){return t.timeIndex})),d3.max(r.map(function(t){return t.timeIndex}))]).range([n.left,f]));StockMarketChartManager.xScaleHistoricChart=y;var m=y(r[1].timeIndex)-y(r[0].timeIndex);p.selectAll("rect.rel-strength").data(r).enter().append("svg:rect").attr("class","rel-strength").attr("x",function(t){return y(t.timeIndex)}).attr("y",function(){return 0}).attr("width",m).attr("height",h).attr("fill",function(t){return i[t[a]]}).attr("stroke",function(t){return i[t[a]]}),p.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",d).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},drawTimeScale:function(t){var e=StockMarketChartManager.xScaleHistoricChart,n=StockMarketChartManager.selectorContainerId,r=StockMarketChartManager.margin,a=d3.select("#"+n).style("width"),i=30;a=parseInt(a.replace("px",""));var o=(a-r.left-r.right,{}),l=[],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u={};$(t).each(function(t,e){var n=new Date(e);void 0==o[n.getMonth()+"-"+n.getYear()]&&n.getDate()<15&&(l.push(e),u[e]=t,o[n.getMonth()+"-"+n.getYear()]=!0)});for(var c in u)console.log("keys    "+c+" value "+u[c]);var d=new Date(l[0]),f=d3.select("#"+n).append("svg:svg").attr("class","time-axis").attr("id","time-axis").attr("width",a).attr("height",i),h=f.selectAll("div.tick").data(l).enter().append("g").attr("class","tick").attr("transform",function(t){console.log("xScale  "+e(u[t]));var n=e(u[t]);return"translate("+n+","+r.top+")"});h.append("text").style("color","#FFFFFF").style("font-size","12px").attr("fill","#FFFFFF").text(function(t,e){var n=new Date(t);return 0==e?"'"+(d.getFullYear()+"").substr(2,3):s[n.getMonth()]}),f.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",i).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},appendToolTip:function(){{var t='<div id="tooltipChart-stock-market" style="z-index:99999;float:none;display:none; margin:0px; padding:0px; position:absolute; width:150px;"><div id="textContainer" style="width:150px; background-color:#eeeeee; border:solid 1px #666666; box-shadow:5px 5px 5px #5d5d5d; border-radius:7px; font-family:calibri; float:left; font-size:11px; padding:10px;">	<div class="xVal" style="text-align:center; font-size:13px; background-color:#6699cc; border-top-left-radius:7px; margin-top:-10px; margin-left:-10px;  margin-right:-10px;border-top-right-radius:7px; padding:5px 10px;">14 jan</div><div id="y-label" class="y-label label1" style="width:60%;display:none; float:left; text-align:left; padding:3px 0;">Auto Loans</div><div  class="yVal label1" style="width:40%; float:right;display:none; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label2" style="width:60%; float:left;display:none; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label2" style="width:40%;display:none; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label3" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label3" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label4" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label4" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label5" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label5" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>	</div></div>';StockMarketChartManager.selectorContainerId}$("body").append(t)},showToolTip:function(t,e,n,r,a){var i,o=t.pageX;i=t.pageY;var l;l=e;var s;s=n,$("#tooltipChart-stock-market").find(".xVal").html(""),$("#tooltipChart-stock-market").find(".xVal").html(s),$("#tooltipChart-stock-market").find(".y-label").html(""),$("#tooltipChart-stock-market").find(".yVal").html(""),$("#tooltipChart-stock-market").find(".yVal").hide(),$("#tooltipChart-stock-market").find(".y-label").hide();for(var u=$("#tooltipChart-stock-market"),c=0;c<a.length;c++){var d=a[c],f=c+1,h=".y-label.label"+f,p=".yVal.label"+f;$(u).find(h).html(d.headingName),$(u).find(p).html(d.headingVal),$(u).find(p).show(),$(u).find(h).show()}var g=o;if($(".ps-scrollbar-x-rail"))try{g+=parseInt($(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(v){}var y=$("body").find("#tooltipChart-stock-market"),m=($(y).find("#textContainer"),i-.9*$("body").find("#tooltipChart-stock-market").height());g-=.95*$("body").find("#tooltipChart-stock-market").width(),g-$(y).width()<170&&(g=.5*g+$(y).width()),console.log("page y "+m+"y "+i),$("body").find("#tooltipChart-stock-market").css("left",g);var x=StockMarketChartManager.selectorContainerId,b=parseInt(d3.select("#"+x).style("height").replace("px",""));$("body").find("#tooltipChart-stock-market").css("top",b/2),$("body").find("#tooltipChart-stock-market").show()},hideToolTip:function(){$("#tooltipChart-stock-market").find(".yVal").html(""),d3.select("#tooltipChart-stock-market").style("display","none")}};